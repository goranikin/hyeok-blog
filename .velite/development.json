[
  {
    "title": "Attention is all you need",
    "description": "Deep dive into the Transformer architecture, especially the implementation in each layers.",
    "slug": "attention-is-all-you-need",
    "publishDate": "2025-04-13",
    "thumbnailUrl": "/development/attention-is-all-you-need/thum.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",code:\"code\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",...s.components};return n(l,{children:[n(r.p,{children:[\"In this post, I will explain the \",e(r.a,{href:\"https://arxiv.org/abs/1706.03762\",children:\"transformer\"}),\" architecture and its implementation at the code level. I referred to a \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"scratch\"}),\" implementation for the PyTorch code!\"]}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/attention-is-all-you-need/1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"The authors of the paper all left Google and founded their own companies, except for Lukasz Kaiser, who joined OpenAI. Five out of the 7 companies have become unicorns, with a combined valuation exceeding $17 billion. It's quite impressive.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/attention-is-all-you-need/2.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"This is Figure 1 from the paper. It illustrates the overall architecture of the Transformer.\"}),\"\\n\",e(r.p,{children:\"They designed the operation, called Scaled Dot-Product Attention, which calculates the attention scores between query and key vectors to reflect the context information between the tokens.\"}),\"\\n\",e(r.p,{children:\"They represented the formula like this.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/attention-is-all-you-need/3.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"How can we implement Scaled Dot-Product Attention in PyTorch? Let's start from scratch.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" ScaledDotProductAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" temperature\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" attn_dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"temperature \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" temperature\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn_dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # q = [batch_size, n_head, len_q, d_k]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # k = [batch_size, n_head, len_k, d_k]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # v = [batch_size, n_head, len_k, d_v]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"matmul\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"/\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"temperature\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"is\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" not\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"masked_fill\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" -\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e9\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"F\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"softmax\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=-\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"matmul\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"The original method uses the square root of \",e(r.code,{children:\"d_model\"}),\" for normalization, but this approach uses a learnable temperature parameter during training. A higher temperature value results in a more uniform attention distribution.\"]}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"attn\"}),\" has a shape \",e(r.code,{children:\"[batch_size, n_head, len_q, len_k]\"}),\", which represents the attention scores between query and key vectors. For example, \",e(r.code,{children:\"a[:,:,1,2]\"}),\" is the attention score between the first query vector and the second key vector.\"]}),\"\\n\",e(r.p,{children:\"A mask is applied to ignore padding tokens in the sequence for efficiency and to ensure that self-attention in the decoder does not reference future tokens.\"}),\"\\n\",n(r.p,{children:[\"The output has a shape of \",e(r.code,{children:\"[batch_size, n_head, len_q, d_v]\"})]}),\"\\n\",e(r.p,{children:\"This is just one module used in the Multi-Head attention mechanism.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/attention-is-all-you-need/4.png\",alt:\"\"})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_qs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_ks \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_vs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"fc \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attention \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" ScaledDotProductAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"temperature\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0.5\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"layer_norm \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LayerNorm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" eps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e-6\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # q = [batch_size, len_q, d_model]\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        residual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q \"}),e(r.span,{style:{color:\"#616E88\"},children:\"# enc_input\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Separate different heads: [batch, len, n_head, d] (d_model / n_head = d_k)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_qs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_ks\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_vs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Transpose for attention dot product: [batch, len, n_head, d]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"is\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" not\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"unsqueeze\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"attention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Transpose to move the head dimension back: b x lq x n x dv\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Combine the last two dimensions to concatenate all the heads together: b x lq x (n*dv)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"contiguous\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" -\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"fc\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # LayerNorm(x + Sublayer(x))\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" residual\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"layer_norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"Wait, what is the layer function? And what does \",e(r.code,{children:\"fc\"}),\" mean? I recommend reading \",e(r.a,{href:\"https://thecho7.tistory.com/entry/PyTorch-nnLinear%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A7%88%EB%AC%B8\",children:\"pytorch layer\"}),\" (this is a Korean blog), which provides a concise explanation.\"]}),\"\\n\",n(r.p,{children:[\"The Multi-Head Attention mechanism takes parameters \",e(r.code,{children:\"q\"}),\", \",e(r.code,{children:\"k\"}),\", and \",e(r.code,{children:\"v\"}),\". In practice, all of them are derived from the same input \",e(r.code,{children:\"x\"}),\". This is why the residual connection is applied to \",e(r.code,{children:\"q\"}),\".\"]}),\"\\n\",n(r.p,{children:[\"After performing Scaled Dot-Product attention and applying \",e(r.code,{children:\"transpose(1, 2).contiguous().view(sz_b, len_q, -1)\"}),\", \",e(r.code,{children:\"q\"}),\" has a shape of \",e(r.code,{children:\"[sz_batch, len_q, n_head * d_v]\"}),\". In the original architecture, \",e(r.code,{children:\"d_v = d_k\"}),\", but when \",e(r.code,{children:\"d_v != d_k\"}),\", it ensures that the output and input dimensions of the \",e(r.code,{children:\"fc\"}),\" layer remain consistent.\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_1 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_2 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"layer_norm \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LayerNorm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" eps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e-6\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        residual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"F\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"relu\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")))\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" residual\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"layer_norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]})]})})}),\"\\n\",e(r.p,{children:\"This is Feed Forward Network. It is a simple linear transformation followed by a ReLU activation function and a dropout layer.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" EncoderLayer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"pos_ffn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" slf_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        enc_output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"pos_ffn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_slf_attn\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" DecoderLayer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"enc_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"pos_ffn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" self_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dec_enc_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"self_attn_mask\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        )\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_enc_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"enc_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dec_enc_attn_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"pos_ffn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_enc_attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"In fact, the Encoder and Decoder are straightforward implementations of their respective layers. It's more an algorithmic problem - determining where to provide the input and how to obtain the output. Therefore, I'll skip the following code snippets. If you want to a deeper dive into the Transformer code, please refer to the \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"scratch\"}),\".\"]}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"reference\"}),\"\\n\",n(r.ol,{children:[\"\\n\",n(r.li,{children:[\"Attention is all you need: \",e(r.a,{href:\"https://arxiv.org/abs/1706.03762\",children:\"https://arxiv.org/abs/1706.03762\"})]}),\"\\n\",n(r.li,{children:[\"transformer code: \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\"})]}),\"\\n\"]}),\"\\n\",e(r.hr,{})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/development/attention-is-all-you-need"
  },
  {
    "title": "Next.js  ",
    "description": "Next.js Bun   . Vercel  AWS EC2 , nginx pm2   .",
    "slug": "deploy-nextjs-app-with-bun-ec2-nginx-pm2",
    "publishDate": "2025-03-02",
    "thumbnailUrl": "/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/1.png",
    "content": "const{Fragment:n,jsx:e,jsxs:l}=arguments[0];function _createMdxContent(c){const r={a:\"a\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",...c.components};return l(n,{children:[e(r.p,{children:\"   ! \"}),\"\\n\",e(r.p,{children:\"        (       ),       .   Docker       .\"}),\"\\n\",e(r.p,{children:\"         .    .        .  .\"}),\"\\n\",e(r.p,{children:\"           !\"}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"Next.js   AWS EC2      .\\n         .\\nIAM        ,  yml  nginx config      ...\\n         .\"}),\"\\n\",e(r.h2,{children:\"1. EC2 \"}),\"\\n\",e(r.p,{children:\"React   S3       .\\n    HTML Javascript   ,       .  Client Side Rendering(CSR) .\"}),\"\\n\",e(r.p,{children:\"Next.js CSR    Server Side Rendering(SSR) .\\nSSR       ,      .\\n   API            Node.js   ,\\n    . ( React     API   .\\n       React    .)\"}),\"\\n\",e(r.p,{children:\"   24            .\\n    AWS EC2.        '' .\"}),\"\\n\",e(r.p,{children:\"     .\"}),\"\\n\",e(r.h3,{children:\"1-1)  \"}),\"\\n\",e(r.p,{children:\"AWS  EC2    .\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"          .\\nQuick Start  Ubuntu,       .\"}),\"\\n\",e(r.p,{children:\"Ubuntu     Linux .\\n     Ubuntu   .     .\"}),\"\\n\",l(r.p,{children:[e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/2.png\",alt:\"\"}),\"\\n\",e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/3.png\",alt:\"\"})]}),\"\\n\",e(r.p,{children:\"     .       .\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/4.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"  SSH, HTTPS, HTTP   .\\n  SSH     ,   HTTP               .\\nHTTP HTTPS      IP   , SSH     IP    .     .\"}),\"\\n\",e(r.p,{children:\"      .\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/5.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"   ''  .\"}),\"\\n\",e(r.p,{children:\"  : ssh -i ...      .\\n         .\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/6.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\". ubuntu .\"}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.h3,{children:\"1-2)  \"}),\"\\n\",e(r.p,{children:\"     .  ubuntu   .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" apt\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" update\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" apt\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" upgrade\"})]})]})})}),\"\\n\",e(r.p,{children:\"apt   .      update,    upgrade.\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(r.code,{children:l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" apt\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" install\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" nginx\"})]})})})}),\"\\n\",l(r.p,{children:[\"nginx  .nginx            .\\n       .    \",e(r.a,{href:\"https://www.youtube.com/watch?v=6FAwAXXj5N0\",children:\"nginx  \"}),\" !\"]}),\"\\n\",l(r.p,{children:[\"   Bun .  npm   Bun    .\\nnpm    \",e(r.a,{href:\"https://sollogging.tistory.com/91\",children:\" \"}),\" !\"]}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" apt\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" install\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" unzip\"}),e(r.span,{style:{color:\"#616E88\"},children:\" # unzip \"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"curl\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" -fsSL\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" https://bun.sh/install\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" |\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" bash\"}),e(r.span,{style:{color:\"#616E88\"},children:\" # bun \"})]})]})})}),\"\\n\",e(r.p,{children:\"Bun   unzip  ,   Bun .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"echo\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'export PATH=\"$HOME/.bun/bin:$PATH\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" >>\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" ~/.bashrc\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"source\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" ~/.bashrc\"})]})]})})}),\"\\n\",e(r.p,{children:\"   Bun      (          ).\\n bun -v    .\"}),\"\\n\",e(r.p,{children:\" GitHub    ,    .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"bun\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" install\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"bun\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" run\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" build\"})]})]})})}),\"\\n\",e(r.p,{children:\"bun     .\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/7.png\",alt:\"\"})}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.h3,{children:\"1-3) nginx \"}),\"\\n\",e(r.p,{children:\"   /home/ubuntu/   .\\n    ,    .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(r.code,{children:l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"cd\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" /etc/nginx/sites-available\"})]})})})}),\"\\n\",e(r.p,{children:\"  nginx        .\\n   , /etc/nginx/sites-enabled   (  )  .\"}),\"\\n\",e(r.p,{children:\"  default        .\\n       .\\n        waffle_rookie_review.conf  .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" touch\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" waffle_rookie_review.conf\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" vim\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" waffle_rookie_review.conf\"})]})]})})}),\"\\n\",e(r.p,{children:\"waffle_rookie_review.conf\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"server\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    listen\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 80\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    server_name\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" IPv4\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    location\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" /\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" {\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        proxy_pass\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" http://localhost:3000\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        proxy_http_version\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 1.1\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        proxy_set_header\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" Upgrade\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" $http_upgrade\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        proxy_set_header\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" Connection\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"upgrade\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        proxy_set_header\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" Host\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" $host\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        proxy_cache_bypass\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" $http_upgrade\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\";\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    }\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"}\"})})]})})}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(r.code,{children:l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" ln\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" -s\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" /etc/nginx/sites-available/waffle_rookie_review.conf\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" /etc/nginx/sites-enabled/\"})]})})})}),\"\\n\",e(r.p,{children:\"     .\"}),\"\\n\",e(r.p,{children:\"   .\"}),\"\\n\",l(r.p,{children:[e(r.code,{children:\"listen 80\"}),\" ->   80   .\"]}),\"\\n\",l(r.p,{children:[e(r.code,{children:\"server_name\"}),\" ->  IP \"]}),\"\\n\",l(r.p,{children:[\"  80 HTTP  .  \",e(r.code,{children:\"http://<IPv4 >\"}),\"       .\"]}),\"\\n\",l(r.p,{children:[e(r.code,{children:\"location /\"}),\" -> '/' ( )   .\"]}),\"\\n\",l(r.p,{children:[e(r.code,{children:\"proxy_pass http://localhost:3000\"}),\" -> \",e(r.code,{children:\"http://<IPv4 >/\"}),\"  Next.js  .\"]}),\"\\n\",e(r.p,{children:\"       .\"}),\"\\n\",e(r.p,{children:\"    .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(r.code,{children:l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" nginx\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" -t\"})]})})})}),\"\\n\",e(r.p,{children:\"   .\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/8.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"   nginx .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(r.code,{children:l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" systemctl\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" restart\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" nginx\"})]})})})}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.h3,{children:\"1-4) pm2 \"}),\"\\n\",e(r.p,{children:\"pm2(Process Manager 2)     .\\n     .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"bun\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" install\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" pm2\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" -g\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"pm2\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" start\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" bun\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" --name\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"waffle_rookie_review\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" --\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" start\"})]})]})})}),\"\\n\",e(r.p,{children:\" ... node.js      .\\n bun  pm2  node.js   .\\nnode.js .\"}),\"\\n\",e(n,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:l(r.code,{children:[l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"curl\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" -o-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" |\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" bash\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"source\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" ~/.bashrc\"})]}),\"\\n\",l(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"nvm\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" install\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" --lts\"})]})]})})}),\"\\n\",e(r.p,{children:\"  pm2 start bun ~~  ...\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/9.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\" !\"}),\"\\n\",l(r.p,{children:[\" \",e(r.code,{children:\"http://<Public IPv4 >\"}),\"  ...\"]}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/deployment-of-nextjs-with-bun-using-ec2-nginx-pm2/10.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"  !\"}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"\"}),\"\\n\",l(r.ol,{children:[\"\\n\",l(r.li,{children:[\"\\n\",e(r.p,{children:\"EC2    IPv4     .\\n  IPv4   Elastic IP  .\"}),\"\\n\"]}),\"\\n\",l(r.li,{children:[\"\\n\",l(r.p,{children:[\"Bun   ,   Bun       ?\\n  \",e(r.code,{children:\"pm2 describe <app-name>\"}),\"  \",e(r.code,{children:\"script path: /home/ubuntu/.bun/bin/bun\"}),\"      .\\n  node.js version N/A    node.js     !\"]}),\"\\n\"]}),\"\\n\",l(r.li,{children:[\"\\n\",e(r.p,{children:\"vim editor     .\\n       ...  CLI      .\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",e(r.hr,{})]})}return{default:function(n={}){const{wrapper:l}=n.components||{};return l?e(l,{...n,children:e(_createMdxContent,{...n})}):_createMdxContent(n)}};",
    "permalink": "/development/deploy-nextjs-app-with-bun-ec2-nginx-pm2"
  },
  {
    "title": "Huggingface LLM Course - Chapter1",
    "description": "Read huggingface docs and note down important points",
    "slug": "huggingface-1",
    "publishDate": "2025-04-14",
    "thumbnailUrl": "/development/huggingface-1/thum1.jpeg",
    "content": "const{Fragment:e,jsx:l,jsxs:n}=arguments[0];function _createMdxContent(r){const s={a:\"a\",blockquote:\"blockquote\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...r.components};return n(e,{children:[l(s.p,{children:l(s.img,{src:\"/development/huggingface-1/1.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"I've been immersing myself in development literature, especially focused on ML. Here are the books I've read (I'm listing them in Korean since that's my native language :D):\"}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"  :       !\"}),\"\\n\",l(s.li,{children:\"    \"}),\"\\n\",l(s.li,{children:\"    + \"}),\"\\n\",l(s.li,{children:\"     :      BERT \"}),\"\\n\",l(s.li,{children:\"   AI   \"}),\"\\n\"]}),\"\\n\",l(s.p,{children:\"These books cover a wide range of topics, including fundamental CS knowldege, development conventions, traditional machine learning methods, and practical applications of deep learning models using PyTorch.\"}),\"\\n\",l(s.p,{children:\"I'm currently working to understand deep learning and its development process, though I recognize this is likely a lifelong journey. After going through the materials mentioned above, I've now moved on to the Hugging Face documentation.\"}),\"\\n\",l(s.p,{children:\"I'm genuinely impressed by the documentation's content. It's incredibly user-friendly and helpful for beginners like me who need to start with the basics such as how to use libraries and understanding the numerous methods available. Thanks to the authors' thoughtful approach, I plan to write down the key points in this post.\"}),\"\\n\",l(s.p,{children:\"Huggingface gives us a high-level operation of the model so that we can easily use them. However, There is no an exact details about 'real' implementation at the code level. So, after finishing the huggingface docs I'm going to read pytorch tutorial and '  ' series.\"}),\"\\n\",l(s.hr,{}),\"\\n\",l(s.h3,{children:\"What is NLP?\"}),\"\\n\",n(s.blockquote,{children:[\"\\n\",l(s.p,{children:\"NLP is a field of linguistics and machine learning focused on understanding everything related to human language. The aim of NLP tasks is not only to understand single words individually, but to be able to understand the context of those words.\"}),\"\\n\"]}),\"\\n\",l(s.h3,{children:\"pipeline\"}),\"\\n\",l(s.p,{children:\"The pipeline() function executes high-level API tasks for NLP.\"}),\"\\n\",l(e,{children:l(s.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(s.code,{children:[n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#81A1C1\"},children:\"from\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"import\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" pipeline\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"classifier \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\" pipeline\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"sentiment-analysis\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"classifier\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"I've been waiting for a HuggingFace course my whole life.\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" [{\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"label\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"POSITIVE\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"score\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(s.span,{style:{color:\"#B48EAD\"},children:\" 0.9598047137260437\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"}]\"})]})]})})}),\"\\n\",l(e,{children:l(s.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(s.code,{children:[n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#81A1C1\"},children:\"from\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"import\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" pipeline\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"generator \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\" pipeline\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"text-generation\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"generator\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"In this course, we will teach you how to\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"[{\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"generated_text\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"In this course, we will teach you how to understand and use \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#ECEFF4\"},children:\"                    '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"data flow and data interchange when handling user data. We \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#ECEFF4\"},children:\"                    '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"will be working with one or more of the most commonly used \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#ECEFF4\"},children:\"                    '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"data flows  data flows of various types, as seen by the \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#ECEFF4\"},children:\"                    '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"HTTP\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"}]\"})]})]})})}),\"\\n\",l(s.p,{children:\"For my learning purposes, the pipeline approach isn't quite suitable. I'm just familiarizing myself with low-level libraries rather than using it for my actual task.\"}),\"\\n\",l(s.h3,{children:\"Bias and Limitations\"}),\"\\n\",l(s.p,{children:\"One thing that's particularly impressive about this...\"}),\"\\n\",l(e,{children:l(s.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(s.code,{children:[n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#81A1C1\"},children:\"from\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"import\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" pipeline\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"unmasker \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\" pipeline\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"fill-mask\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#D8DEE9\"},children:\" model\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"bert-base-uncased\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"result \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\" unmasker\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"This man works as a [MASK].\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"print\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"r\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"token_str\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" for\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" r \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"in\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" result\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"])\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"result \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\" unmasker\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"This woman works as a [MASK].\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"print\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"r\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"token_str\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:'\"'}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" for\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" r \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"in\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" result\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"])\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"lawyer\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"carpenter\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"doctor\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"waiter\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"mechanic\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#ECEFF4\"},children:\"   [\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"nurse\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"waitress\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"teacher\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"maid\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"prostitute\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]})]})})}),\"\\n\",l(s.p,{children:\"Oh... this is a serious problem. as huggingface tells us:\"}),\"\\n\",n(s.blockquote,{children:[\"\\n\",l(s.p,{children:\"When you use these tools, you therefore need to keep in the back of your mind that the original model you are using could very easily generate sexist, racist, or homophobic content. Fine-tuning the model on your data wont make this intrinsic bias disappear.\"}),\"\\n\"]}),\"\\n\",l(s.h3,{children:\"Brief Summary of Models\"}),\"\\n\",n(s.table,{children:[l(s.thead,{children:n(s.tr,{children:[l(s.th,{children:\"Models\"}),l(s.th,{children:\"Examples\"}),l(s.th,{children:\"Tasks\"})]})}),n(s.tbody,{children:[n(s.tr,{children:[l(s.td,{children:\"Encoder\"}),l(s.td,{children:\"ALBERT, BERT, DistilBERT, ELECTRA, RoBERTa\"}),l(s.td,{children:\"Sentence classification, named entity recognition, extractive question answering\"})]}),n(s.tr,{children:[l(s.td,{children:\"Decoder\"}),l(s.td,{children:\"CTRL, GPT, GPT-2, Transformer XL\"}),l(s.td,{children:\"Text generation\"})]}),n(s.tr,{children:[l(s.td,{children:\"Encoder-Decoder\"}),l(s.td,{children:\"BART, T5, Marian, mBART\"}),l(s.td,{children:\"Summarization, translation, generative question answering\"})]})]})]}),\"\\n\",l(s.p,{children:\"Chapter 1 is complete! \"}),\"\\n\",l(s.hr,{}),\"\\n\",l(s.h2,{children:\"Reference\"}),\"\\n\",n(s.p,{children:[\"Huggingface LLM Course: \",l(s.a,{href:\"https://huggingface.co/learn/llm-course/chapter1/1\",children:\"https://huggingface.co/learn/llm-course/chapter1/1\"})]})]})}return{default:function(e={}){const{wrapper:n}=e.components||{};return n?l(n,{...e,children:l(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/development/huggingface-1"
  },
  {
    "title": "Huggingface LLM Course - Chapter2 & Chapter3",
    "description": "Read huggingface docs. What is a tokenizer and fine-tuning? Train a model!",
    "slug": "huggingface-2",
    "publishDate": "2025-04-15",
    "thumbnailUrl": "/development/huggingface-2/thum2.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",blockquote:\"blockquote\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...s.components};return n(l,{children:[e(r.h3,{children:\"Behind the pipeline:\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/huggingface-2/2.png\",alt:\"\"})}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"The vector output by the Transformer module is usually large. It generally has three dimensions:\"}),\"\\n\"]}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"Batch size: The number of sequences processed at a time.\"}),\"\\n\",e(r.li,{children:\"Sequence length: The length of the numerical representation of the sequence.\"}),\"\\n\",e(r.li,{children:\"Hidden size: The vector dimension of each model input.\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"The hidden size can be very large. 768 is common for smaller models, and in larger models this can reach 3072 or more.\"}),\"\\n\",e(r.h3,{children:\"Model heads\"}),\"\\n\",e(r.p,{children:\"The model heads take the high-dimensional vector of hidden states as input and project them onto a different dimension. They are usually composed of one or a few linear layers.\"}),\"\\n\",e(r.h3,{children:\"Model\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" BertConfig\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" BertModel\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"config \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" BertConfig\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" BertModel\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"config\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.p,{children:\"This is to load the BERT's architecture with random values of weights. If I use it, it will output gibberish. It needs to be trained first but it takes a lot of time and resources. For preventing this, we can use a pre-trained model:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" BertModel\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" BertModel\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"bert-base-cased\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.h3,{children:\"Tokenization\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenizer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"bert-base-cased\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sequence \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Using a Transformer network is simple\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokens \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"tokenize\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sequence\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Using\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"transform\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"##er\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"network\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"is\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"simple\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]})]})})}),\"\\n\",e(r.p,{children:\"From tokens to input IDs\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"ids \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"convert_tokens_to_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"7993\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 170\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 11303\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 1200\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2443\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 1110\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3014\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]})]})})}),\"\\n\",e(r.p,{children:\"Decoding\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"decoded_string \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"decode\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"7993\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 170\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 11303\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 1200\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2443\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 1110\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3014\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"])\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"decoded_string\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Using a Transformer network is simple\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]})]})})}),\"\\n\",e(r.p,{children:\"Send to Model\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoModelForSequenceClassification\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"checkpoint \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"distilbert-base-uncased-finetuned-sst-2-english\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenizer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"checkpoint\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoModelForSequenceClassification\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"checkpoint\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sequence \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"I've been waiting for a HuggingFace course my whole life.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokens \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"tokenize\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sequence\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"ids \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"convert_tokens_to_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"input_ids \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"tensor\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"# This line will fail.\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"input_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" IndexError\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" Dimension out of \"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"range\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"expected to be \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" range\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" of \"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"-\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" but got \"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.p,{children:\"Why did this fail?\"}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"Transformers models expect multiple sentences by default.\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"So, this is the right way to send it to the model:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"input_ids \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"tensor\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"])\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"input_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.p,{children:\"I will handle Datasets library later. Therefore, this post doesn't cover it detailedly.\"}),\"\\n\",e(r.h3,{children:\"Fine-tuning a model with the Trainer API:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" Trainer\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"trainer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Trainer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    training_args\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"    train_dataset\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"    eval_dataset\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"validation\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"    data_collator\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"data_collator\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"    tokenizer\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"trainer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]})]})})}),\"\\n\",e(r.p,{children:\"Then Trainer will start the fine-tuning and report the training loss every 500 steps.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"predictions \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trainer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"predict\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"validation\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"])\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"predictions\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"predictions\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" predictions\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"label_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"408\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"408\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",)\"})]})]})})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" numpy \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"as\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" np\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" evaluate\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"preds \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" np\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"argmax\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"predictions\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"predictions\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" axis\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=-\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"metric \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" evaluate\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"load\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"glue\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"mrpc\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"metric\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"compute\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"predictions\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"preds\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" references\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"predictions\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"label_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"accuracy\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0.8578431372549019\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"f1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0.8996539792387542\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"}\"})]})]})})}),\"\\n\",e(r.p,{children:\"But same reason as pipeline, I won't use this high-level APIs.\"}),\"\\n\",e(r.h3,{children:\"A full training\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" load_dataset\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" DataCollatorWithPadding\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"raw_datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" load_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"glue\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"mrpc\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"checkpoint \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"bert-base-uncased\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenizer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"checkpoint\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" tokenize_function\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"example\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    return\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"example\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"sentence1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" example\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"sentence2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" truncation\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" raw_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"map\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenize_function\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" batched\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"data_collator \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" DataCollatorWithPadding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"tokenizer\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"remove_columns\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"sentence1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"sentence2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"idx\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"])\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"rename_column\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"label\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"labels\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#616E88\"},children:\" # model expects the argument to be named 'labels'\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"set_format\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#616E88\"},children:\" # therefore, they return PyTorch tensors instead of lists\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"].\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"column_names\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"attention_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"input_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"labels\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"token_type_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]})]})})}),\"\\n\",e(r.p,{children:\"define a dataloaders:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"utils\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"data \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" DataLoader\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"train_dataloader \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" DataLoader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" shuffle\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" batch_size\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" collate_fn\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"data_collator\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"eval_dataloader \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" DataLoader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    tokenized_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"validation\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" batch_size\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" collate_fn\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"data_collator\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})})]})})}),\"\\n\",e(r.p,{children:\"To quickly check there is no mistake in the data processing:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" batch \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" train_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#81A1C1\"},children:\"    break\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"{\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" batch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"items\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()}\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"{\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"attention_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 65\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]),\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"input_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 65\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]),\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"labels\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]),\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"token_type_ids\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 65\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"])}\"})]})]})})}),\"\\n\",e(r.p,{children:\"After loading a pre-trained model:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"outputs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"batch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"loss\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" outputs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"logits\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" tensor\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.5441\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" grad_fn\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=<\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"NllLossBackward\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\">\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"])\"})]})]})})}),\"\\n\",e(r.p,{children:\"Optimizer:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AdamW\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"optimizer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" AdamW\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"parameters\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(),\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" lr\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"5e-5\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.p,{children:\"Learning rate scheduler:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" get_scheduler\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"num_epochs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"num_training_steps \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" num_epochs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" len\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"train_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"lr_scheduler \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" get_scheduler\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:'    \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"    optimizer\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"optimizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"    num_warmup_steps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"    num_training_steps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"num_training_steps\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})})]})})}),\"\\n\",e(r.p,{children:\"Training roop:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"cuda\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"cuda\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"is_available\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" else\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"cpu\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"to\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"progress_bar \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" tqdm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"range\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"num_training_steps\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" epoch \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" range\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"num_epochs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" batch \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" train_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        batch \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"to\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" batch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"items\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()}\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"batch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        loss \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" outputs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"loss\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        loss\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"backward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        optimizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"step\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        lr_scheduler\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"step\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        optimizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"zero_grad\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        progress_bar\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"update\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.p,{children:\"The training flow is as follows:\"}),\"\\n\",n(r.ol,{children:[\"\\n\",e(r.li,{children:\"Calculate the loss\"}),\"\\n\",e(r.li,{children:\"Calculate the gradients during backpropagation\"}),\"\\n\",e(r.li,{children:\"Update the model parameters using the optimizer\"}),\"\\n\",e(r.li,{children:\"Tune the learning rate\"}),\"\\n\",e(r.li,{children:\"Initialize gradients to zero\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"With the Accelerate library, which enables more efficient and faster training performance, we need to make some minor revisions to the code.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"accelerate \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Accelerator\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"...\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"train_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" eval_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" optimizer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" accelerator\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"prepare\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    train_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" eval_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" optimizer\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"...\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" epoch \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" range\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"num_epochs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" batch \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" train_dataloader\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"batch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        loss \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" outputs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"loss\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        accelerator\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"backward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"loss\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        optimizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"step\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        lr_scheduler\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"step\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        optimizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"zero_grad\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        progress_bar\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"update\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"accelerate.prepare()\"}),\" wraps these objects in the appropriate container to ensure your distributed training functions properly as intended.\"]}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.h2,{children:\"Reference\"}),\"\\n\",n(r.p,{children:[e(r.a,{href:\"https://huggingface.co/learn/llm-course/chapter2/1?fw=pt\",children:\"https://huggingface.co/learn/llm-course/chapter2/1?fw=pt\"}),\"\\n\",e(r.a,{href:\"https://huggingface.co/learn/llm-course/chapter3/1?fw=pt\",children:\"https://huggingface.co/learn/llm-course/chapter3/1?fw=pt\"})]})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/development/huggingface-2"
  },
  {
    "title": "Huggingface LLM Course - Chapter5 (Datasets Library)",
    "description": "Read huggingface docs. Deep dive into datasets library!",
    "slug": "huggingface-3",
    "publishDate": "2025-04-16",
    "thumbnailUrl": "/development/huggingface-3/thum3.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",blockquote:\"blockquote\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...s.components};return n(l,{children:[e(r.p,{children:\"In chapter 5, docs handles datasets library. Key questions is following:\"}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"What do you do when your dataset is not on the Hub?\"}),\"\\n\",e(r.li,{children:\"How can you slice and dice a dataset? (And what if you really need to use Pandas?)\"}),\"\\n\",e(r.li,{children:\"What do you do when your dataset is huge and will melt your laptops RAM?\"}),\"\\n\",e(r.li,{children:\"What the heck are memory mapping and Apache Arrow?\"}),\"\\n\",e(r.li,{children:\"How can you create your own dataset and push it to the Hub?\"}),\"\\n\"]}),\"\\n\",e(r.h3,{children:\"Common data formats:\"}),\"\\n\",n(r.table,{children:[e(r.thead,{children:n(r.tr,{children:[e(r.th,{children:\"Data format\"}),e(r.th,{children:\"Loading script\"}),e(r.th,{children:\"Example\"})]})}),n(r.tbody,{children:[n(r.tr,{children:[e(r.td,{children:\"CSV & TSV\"}),e(r.td,{children:\"csv\"}),e(r.td,{children:'load_dataset(\"csv\", data_files=\"my_file.csv\")'})]}),n(r.tr,{children:[e(r.td,{children:\"Text files\"}),e(r.td,{children:\"text\"}),e(r.td,{children:'load_dataset(\"text\", data_files=\"my_file.txt\")'})]}),n(r.tr,{children:[e(r.td,{children:\"JSON & JSON Lines\"}),e(r.td,{children:\"json\"}),e(r.td,{children:'load_dataset(\"json\", data_files=\"my_file.jsonl\")'})]}),n(r.tr,{children:[e(r.td,{children:\"Pickled DataFrames\"}),e(r.td,{children:\"pandas\"}),e(r.td,{children:'load_dataset(\"pandas\", data_files=\"my_dataframe.pkl\")'})]})]})]}),\"\\n\",e(r.h3,{children:\"Load Datasets\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" load_dataset\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"data_files \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"SQuAD_it-train.json\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"test\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"SQuAD_it-test.json\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"}\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"squad_it_dataset \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" load_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"json\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" data_files\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"data_files\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" field\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"data\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.p,{children:\"Or it is possible to put a raw string to data_files parameter.\"}),\"\\n\",e(r.h3,{children:\"Slice and dice\"}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"A good practice when doing any sort of data analysis is to grab a small random sample to get a quick feel for the type of data youre working with. In  Datasets, we can create a random sample by chaining the Dataset.shuffle() and Dataset.select() functions together:\"}),\"\\n\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_sample \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"].\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"shuffle\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"seed\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"42\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"select\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"range\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1000\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"# Peek at the first few examples\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_sample\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[:\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"3\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]})]})})}),\"\\n\",e(r.p,{children:\"Shuffling and selecting small samples is quite a good practice!\"}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"drug_dataset.unique('drugName')\"}),\" is a function to find the number of unique drug names. We can pass any column names as a parameter.\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" lowercase_condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"example\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    return\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" example\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"].\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"lower\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()}\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"map\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"lowercase_condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" AttributeError\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"NoneType\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" object\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" has no attribute \"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"lower\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]})]})})}),\"\\n\",n(r.blockquote,{children:[\"\\n\",n(r.p,{children:[\"We can infer that some of the entires in the \",e(r.code,{children:\"condition\"}),\" column are \",e(r.code,{children:\"None\"}),\", which cannot be lowercased as they're not strings. Let's drop these rows using Dataset.filter(), which works in a similar way to \",e(r.code,{children:\"Dataset.map()\"}),\" and expects a function that receives a single example of the dataset.\"]}),\"\\n\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(r.code,{children:n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"filter\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"lambda\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" is\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" not\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})})})}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"filter\"}),\" and \",e(r.code,{children:\"map\"}),\" method are similar to Javascript's. Filter removes falsey elements and only keeps truthy elements.\\nBut what exactly is an element to which a method is applied?\"]}),\"\\n\",e(r.p,{children:\"For a single dataset, the method executes a task on each row. For a dataset dictionary, the method iterates through each split and performs a task on each row within that split.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" compute_review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"example\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    return\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" len\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"example\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"].\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"split\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"())}\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"map\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"compute_review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"# Inspect the first training example\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"patient_id\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 206461\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"     '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"drugName\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Valsartan\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"     '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"left ventricular dysfunction\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"     '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"It has no side effect, I take it in combination of Bystolic 5 Mg and Fish Oil\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"     '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"rating\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 9.0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"     '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"date\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"May 20, 2012\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"     '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"usefulCount\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 27\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"     '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 17\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"}\"})]})]})})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"filter\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"lambda\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" >\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 30\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"num_rows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"{\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 138514\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"test\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 46108\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"}\"})]})]})})}),\"\\n\",e(r.h3,{children:\"The map() methods superpowers\"}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"The Dataset.map() method takes a batched argument that, if set to True, causes it to send a batch of examples to the map function at once (the batch size is configurable but defaults to 1,000).\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/development/huggingface-3/1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"Wow, a false batch takes 5 times longer.\"}),\"\\n\",e(r.p,{children:\"Tokenizer also can process a batch.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenizer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"bert-base-cased\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" tokenize_function\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"examples\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    return\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"examples\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" truncation\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.h3,{children:\"Pandas\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(r.code,{children:n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"set_format\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"pandas\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})})})}),\"\\n\",e(r.h3,{children:\"Creating a validation set\"}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\" Datasets provides a Dataset.train_test_split() function that is based on the famous functionality from scikit-learn. Lets use it to split our training set into train and validation splits (we set the seed argument for reproducibility):\"}),\"\\n\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset_clean \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"].\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"train_test_split\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"train_size\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.8\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" seed\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"42\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:'# Rename the default \"test\" split to \"validation\"'})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset_clean\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"validation\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" drug_dataset_clean\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"pop\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"test\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:'# Add the \"test\" set to our `DatasetDict`'})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset_clean\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"test\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" drug_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"test\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"drug_dataset_clean\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" DatasetDict\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"patient_id\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"drugName\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"rating\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"date\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"usefulCount\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_clean\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            num_rows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 110811\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        })\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        validation\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"patient_id\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"drugName\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"rating\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"date\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"usefulCount\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_clean\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            num_rows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 27703\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        })\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        test\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"patient_id\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"drugName\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"condition\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"rating\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"date\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"usefulCount\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"review_clean\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            num_rows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 46108\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        })\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"    })\"})})]})})}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"pop('key')\"}),\" removes and returns the value associated with the specified key from the dictionary.\"]}),\"\\n\",e(r.h3,{children:\"Saving a dataset\"}),\"\\n\",n(r.table,{children:[e(r.thead,{children:n(r.tr,{children:[e(r.th,{children:\"Data format\"}),e(r.th,{children:\"Function\"})]})}),n(r.tbody,{children:[n(r.tr,{children:[e(r.td,{children:\"Arrow\"}),e(r.td,{children:\"Dataset.save_to_disk()\"})]}),n(r.tr,{children:[e(r.td,{children:\"CSV\"}),e(r.td,{children:\"Dataset.to_csv()\"})]}),n(r.tr,{children:[e(r.td,{children:\"JSON\"}),e(r.td,{children:\"Dataset.to_json()\"})]})]})]}),\"\\n\",e(r.h3,{children:\"Dealing with huge data\"}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"the WebText corpus used to pretrain GPT-2 consists of over 8 million documents and 40 GB of text  loading this into your laptops RAM is likely to give it a heart attack!\\nFortunately,  Datasets has been designed to overcome these limitations. It frees you from memory management problems by treating datasets as memory-mapped files, and from hard drive limits by streaming the entries in a corpus.\"}),\"\\n\"]}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"So how does  Datasets solve this memory management problem?  Datasets treats each dataset as a memory-mapped file, which provides a mapping between RAM and filesystem storage that allows the library to access and operate on elements of the dataset without needing to fully load it into memory.\"}),\"\\n\"]}),\"\\n\",e(r.h3,{children:\"Semantic search with FAISS\"}),\"\\n\",e(r.p,{children:\"There's a library called senetence-transformers that is dedicated to creating embeddings.\"}),\"\\n\",e(r.p,{children:\"Following an example from the documentation, we're going to implement asymmetric semantic search, which is characterized by typically short queries (like a questions or keywords), while the target documents are longer paragraphs or passages containing the answer.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" transformers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoModel\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model_ckpt \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"sentence-transformers/multi-qa-mpnet-base-dot-v1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"tokenizer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoTokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model_ckpt\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" AutoModel\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_pretrained\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model_ckpt\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"cuda\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"to\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" cls_pooling\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"model_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" model_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"last_hidden_state\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[:,\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" get_embeddings\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"text_list\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    encoded_input \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" tokenizer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        text_list\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" padding\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" truncation\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" return_tensors\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"pt\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"    )\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    encoded_input \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"to\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" encoded_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"items\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()}\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    model_output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"encoded_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    return\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" cls_pooling\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"model_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embeddings_dataset \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" comments_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"map\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    lambda\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" {\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"embeddings\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" get_embeddings\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]).\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"detach\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"cpu\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"numpy\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]}\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})})]})})}),\"\\n\",e(r.p,{children:\"After embedding, let's use FAISS (short for Facebook AI Similarity Search). FAISS is a library that provides efficient algorithms to quickly search and cluster embedding vectors.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embeddings_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"add_faiss_index\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"column\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"embeddings\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"question \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"How can I load a dataset offline?\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"question_embedding \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" get_embeddings\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"([\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"question\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]).\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"cpu\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"detach\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"numpy\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"question_embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"scores\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" samples \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" embeddings_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"get_nearest_examples\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:'    \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"embeddings\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" question_embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" k\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"5\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})})]})})}),\"\\n\",e(r.p,{children:\"sorting by score:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" pandas \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"as\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" pd\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"samples_df \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" pd\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"DataFrame\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"from_dict\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"samples\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"samples_df\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"scores\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" scores\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"samples_df\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"sort_values\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"scores\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" ascending\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" inplace\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" _\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" row \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" samples_df\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"iterrows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"():\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"f\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"COMMENT: '}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"{\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"row\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"comments\"}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"}\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"f\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"SCORE: '}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"{\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"row\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"scores\"}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"}\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"f\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"TITLE: '}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"{\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"row\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"title\"}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"}\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"f\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"URL: '}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"{\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"row\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"html_url\"}),e(r.span,{style:{color:\"#EBCB8B\"},children:\"}\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#81A1C1\"},children:\" *\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 50\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"    print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]})]})})}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.h2,{children:\"Reference\"}),\"\\n\",e(r.p,{children:e(r.a,{href:\"https://huggingface.co/learn/llm-course/chapter5/1?fw=pt\",children:\"https://huggingface.co/learn/llm-course/chapter5/1?fw=pt\"})})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/development/huggingface-3"
  },
  {
    "title": "Huggingface LLM Course - Chapter7 (Classical NLP tasks)",
    "description": "Read huggingface docs. This time, let's cover to know classical NLP tasks.",
    "slug": "huggingface-4",
    "publishDate": "2025-04-24",
    "thumbnailUrl": "/development/huggingface-1/thum4.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",blockquote:\"blockquote\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...s.components};return n(l,{children:[e(r.p,{children:\"Each section of this chapter is independent. The sections are following:\"}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"Token classification\"}),\"\\n\",e(r.li,{children:\"Masked language modeling (like BERT)\"}),\"\\n\",e(r.li,{children:\"Summarization\"}),\"\\n\",e(r.li,{children:\"Translation\"}),\"\\n\",e(r.li,{children:\"Causal language modeling pretraining (like GPT-2)\"}),\"\\n\",e(r.li,{children:\"Question answering\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"it is good chance to know an information about each task!\"}),\"\\n\",e(r.p,{children:\"In the introduction, there is short sentence about Trainer API:\"}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"the Trainer API is great for fine-tuning or training your model without worrying about whats going on behind the scenes, while the training loop with Accelerate will let you customize any part you want more easily.\"}),\"\\n\"]}),\"\\n\",e(r.h3,{children:\"Token classification\"}),\"\\n\",e(r.p,{children:'Token classification encompasses any problem that can be formulated as \"attributing a label to each token in a sentence\", such as:'}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"Named entity recognition (NER): Find the entities (such as persons, locations or organizations) in a sentence.\"}),\"\\n\",e(r.li,{children:\"Part-of-speech tagging (POS): Mark each word in a sentence as corresponding to a particular part of speech (such as noun, verb, adjective, etc.)\"}),\"\\n\",e(r.li,{children:\"Chunking\"}),\"\\n\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"from\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"import\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" load_dataset\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"raw_datasets \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" load_dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"conll2003\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"raw_datasets\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" DatasetDict\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"chunk_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"id\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"ner_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"pos_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            num_rows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 14041\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        })\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        validation\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"chunk_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"id\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"ner_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"pos_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            num_rows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3250\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        })\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        test\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Dataset\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"({\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"chunk_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"id\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"ner_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"pos_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            num_rows\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3453\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        })\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"    })\"})})]})})}),\"\\n\",e(r.p,{children:\"Let's have a look at the first element of the training set:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"raw_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"EU\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"rejects\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"German\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"call\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"to\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"boycott\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"British\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"lamb\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\".\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]})]})})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"raw_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"ner_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"3\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 7\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 7\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]})]})})}),\"\\n\",e(r.p,{children:\"what are these numbers?\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"ner_feature \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" raw_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"].\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"ner_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"ner_feature\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Sequence\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"feature\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"ClassLabel\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"num_classes\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"9\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" names\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"O\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"B-PER\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"I-PER\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"B-ORG\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"I-ORG\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"B-LOC\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"I-LOC\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"B-MISC\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"I-MISC\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" names_file\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" id\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" length\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=-\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" id\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]})]})})}),\"\\n\",e(r.p,{children:\"They are classes.\"}),\"\\n\",n(r.blockquote,{children:[\"\\n\",e(r.p,{children:\"We already saw these labels when digging into the token-classification pipeline in Chapter 6, but for a quick refresher:\"}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"O means the word doesnt correspond to any entity.\"}),\"\\n\",e(r.li,{children:\"B-PER/I-PER means the word corresponds to the beginning of/is inside a person entity.\"}),\"\\n\",e(r.li,{children:\"B-ORG/I-ORG means the word corresponds to the beginning of/is inside an organization entity.\"}),\"\\n\",e(r.li,{children:\"B-LOC/I-LOC means the word corresponds to the beginning of/is inside a location entity.\"}),\"\\n\",e(r.li,{children:\"B-MISC/I-MISC means the word corresponds to the beginning of/is inside a miscellaneous entity.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"Check them more visible output:\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"words \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" raw_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"tokens\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"labels \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" raw_datasets\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"train\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"][\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"ner_tags\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"line1 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"line2 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" word\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" label \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" zip\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"words\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" labels\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    full_label \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" label_names\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"label\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    max_length \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" max\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"len\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"word\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" len\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"full_label\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    line1 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" word \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#81A1C1\"},children:\" *\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"max_length \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"-\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" len\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"word\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" +\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"    line2 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" full_label \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#81A1C1\"},children:\" *\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"max_length \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"-\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" len\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"full_label\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" +\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"line1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"print\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"line2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\">>>\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"EU    rejects German call to boycott British lamb .\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"B-ORG O       B-MISC O    O  O       B-MISC  O    O\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]})]})})}),\"\\n\",e(r.p,{children:\"The following content is all related to the training and evaluation of Tokenizers, and since it's more of a guide on how to use the Huggingface library, it will be omitted.\"}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.h2,{children:\"Reference\"}),\"\\n\",e(r.p,{children:e(r.a,{href:\"https://huggingface.co/learn/llm-course/chapter6/1?fw=pt\",children:\"https://huggingface.co/learn/llm-course/chapter6/1?fw=pt\"})})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/development/huggingface-4"
  },
  {
    "title": "Reading papers - MT-DNN, MASS, UNILM, XLNet, RoBERTa, ALBERT,",
    "description": "reading reading~",
    "slug": "reading-papers",
    "publishDate": "2025-04-27",
    "thumbnailUrl": "/development/reading-papers-1/thum.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:t}=arguments[0];function _createMdxContent(r){const i={a:\"a\",blockquote:\"blockquote\",hr:\"hr\",img:\"img\",p:\"p\",...r.components};return t(e,{children:[n(i.p,{children:\"During my previous studies, I examined research papers on various language models, including seq2seq, Transformer, and BERT (though I didn't write about BERT). My objective is gaining knowledge in the LLM field and also have an assignment requiring me to create a video presentation explaining the concepts I've learned in class to my peers. Previous posts are the result of the assignment. Therefore, this post will be too. :D\"}),\"\\n\",n(i.p,{children:\"This post covers MT-DNN, MASS, UNILM, XLNet, RoBERTa and ALBERT. I won't describe the details of each model, but rather focus on the fundamental concepts (due to my schedule :p).\"}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1901.11504\",children:\"MT-DNN\"}),\" (Multi-Task Deep Neural Networks for natural language understanding)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/1.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract, there is a key purpose of MT-DNN.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"MT-DNN not only leverages large amounts of cross-task data, but also benefits from a regularization effect that leads to more general representations to help adapt to new tasks and domains.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"And in the introduction, they explain the motivation behind MT-DNN, which is the basic principle of transfer learning.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Multi-Task Learning (MTL) is inspired by human learning activities where people often apply the knowledge learned from previous tasks to help learn a new task (Caruana, 1997; Zhang and Yang, 2017). For example, it is easier for a person who knows how to ski to learn skating than the one who does not.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They propose a diverse range of tasks to train the model:\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/2.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"However, I think the intricate details of these tasks are not essential for my current understanding. At this point, I'm focused on grasping the fundamental concepts rather than delving too deeply into the specifics.\"}),\"\\n\",t(i.p,{children:[\"The benchmark is following:\\n\",n(i.img,{src:\"/development/reading-papers-1/3.png\",alt:\"\"})]}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1905.02450\",children:\"MASS\"}),\" (MAsked Sequence to Sequence learning)\"]}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"its encoder takes a sentence with randomly masked fragment (several consecutive tokens) as input, and its decoder tries to predict this masked fragment. In this way, MASS can jointly train the encoder and decoder to develop the capability of representation extraction and language modeling. In this paper, inspired by BERT, we propose a novel objective for pre-training: MAsked Sequence to Sequence learning (MASS) for language generation.\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"What does that mean? See the figure below:\\n\",n(i.img,{src:\"/development/reading-papers-1/4.png\",alt:\"\"})]}),\"\\n\",n(i.p,{children:\"MASS masks continuous sequences of tokens within the source sentence. Subsequently, the decoder predicts these masked tokens, generating the output seqeuntially, one token at a time.\"}),\"\\n\",t(i.p,{children:[\"This provides a detailed mathematical formulation representing the loss function derived from the log-likelihood function:\\n\",n(i.img,{src:\"/development/reading-papers-1/5.png\",alt:\"\"})]}),\"\\n\",t(i.p,{children:[\"Researchers assert that, under specific constraint condtions, MASS can effectively function as both BERT and GPT architectures.\\n\",n(i.img,{src:\"/development/reading-papers-1/6.png\",alt:\"\"})]}),\"\\n\",n(i.p,{children:\"However, MASS is the encoder-decoder framework to generate tokens and there is a cross-attention between the encoder and decoder. It is the fundamental difference from BERT (which is a single encoder architecture) and GPT (which is a single decoder architecture).\"}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1905.03197\",children:\"UNILM\"}),\" (UNIfied Language Model pre-training for natural language understanding and generation)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/7.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"The authors describe UNILM's foundational architecture as a 'multi-layer Transformer network'.\"}),\"\\n\",n(i.p,{children:\"However, upon examination of Figure 1, it appears identical to the encoder layer of a standard Transformer. (In fact, its architecture is precisely that of BERT Large.)\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/8.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"They implement a strategy that emulates language modeling techniques through the strategic manipulation of self-attention masks.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Specifically, within one training batch, 1/3 of the time we use the bidirectional LM objective, 1/3 of the time we employ the sequence-to-sequence LM objective, and both left-to-right and right-to-left LM objectives are sampled with rate of 1/6.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1906.08237\",children:\"XLNet\"}),\" (XLNet: Generalized Autoregressive Pretraining for Language Understanding)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/9.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"The name 'XLNet does not appear explicitly in the paper's title. However, the authors clarify the origin of this designation in the abstract.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"XLNet integrates ideas from Transformer-XL, the state-of-the-art autoregressive model, into pretraining.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"The nomenclature derives from their inspiration by Transformer-XL\"}),\"\\n\",n(i.p,{children:\"What are the distinctive characteristics of this approach?\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"we propose XLNet, a generalized autoregressive pretraining method that (1) enables learning bidirectional contexts by maximizing the expected likelihood over all permutations of the factorization order and (2) overcomes the limitations of BERT thanks to its autoregressive formulation.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They propose an enhanced pre-training methodology that leverages permutations of token order. How exactly does this mechanism function?\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/10.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"(a) shows the normal self-attention mechanism, and (b) shows the permutation self-attention what the researchers claim.\"}),\"\\n\",n(i.p,{children:\"For instance, consider the sentence 'New York is a city' which would be masked as '[Mask] [Mask] is a city' in traditional pre-training. BERT's approach involves predicting 'New' and 'York' independently, calculating p(New | is a city) and p(York | is a city) separately. In contrast, XLNet employs a sequential prediction method: first calculating p(New | is a city), then p(York | New, is a city), thereby effectively capturing the relationship between 'New' and 'York'.\\\"\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/12.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"For those familiar with the inherent limitations of transformer architectures, particularly their substantial computational overhead, it comes as no surprise that XLNet inherits these same challenges. The authors were acutely aware of this computational burden.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"While the permutation language modeling objective (3) has several benefits, it is a much more challenging optimization problem due to the permutation and causes slow convergence in preliminary experiments. To reduce the optimization difficulty, we choose to only predict the last tokens in a factorization order.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/11.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"To mitigate this issue, they strategically implemented the permutation method on only a subset of the sequence, rather than applying it exhaustively.\"}),\"\\n\",n(i.hr,{}),\"\\n\",n(i.p,{children:n(i.a,{href:\"https://arxiv.org/abs/1907.11692\",children:\"RoBERTa\"})}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/13.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"hyperparameter choices have significant impact on the final results. We present a replication study of BERT pretraining (Devlin et al., 2019) that carefully measures the impact of many key hyperparameters and training data size.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"So... the RoBERTa paper represents the better hyperparameter optimization. Our professor emphasized that despite its seemingly straightforward tuning methodology, this research emerged during a period saturated with numerous approaches and architectural innovations aimed at enhancing LLM performance. I concur with this assessment, as my review of several related papers reveals a predominant focus on architectural innovations.\"}),\"\\n\",n(i.p,{children:\"From this perspective, the authors assert the following:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We find that BERT was significantly undertrained, and can match or exceed the performance of every model published after it.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They also implement an masking strategy called dynamic masking, which randomly masks tokens throughout the training process rather than consistently masking identical token positions.\"}),\"\\n\",n(i.p,{children:\"Intuitively, as most would likely concur, dynamic masking appears inherently more effective than static masking approaches. However, the empirical results indicate:\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/14.png\",alt:\"\"})}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We find that our reimplementation with static masking performs similar to the original BERT model, and dynamic masking is comparable or slightly better than static masking.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\":D\"}),\"\\n\",n(i.p,{children:\"The followings are all approaches:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Specifically, RoBERTa is trained with\\ndynamic masking (Section 4.1)\\nFULL-SENTENCES without NSP loss (Section 4.2)\\nlarge mini-batches (Section 4.3)\\na larger byte-level BPE (Section 4.4)\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/15.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"And they assert that BPE has advantages although it doesn't show a better performance.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Early experiments revealed only slight differences between these encodings, with the Radford et al. (2019) BPE achieving slightly worse end-task performance on some tasks. Nevertheless, we believe the advantages of a universal encoding scheme outweighs the minor degredation in performance and use this encoding in the remainder of our experiments. A more detailed comparison of these encodings is left to future work.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{}),\"\\n\",n(i.p,{children:n(i.a,{href:\"https://arxiv.org/abs/1909.11942\",children:\"ALBERT\"})}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/development/reading-papers-1/16.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"we present two parameter reduction techniques to lower memory consumption and increase the training speed of BERT (Devlin et al., 2019). Comprehensive empirical evidence shows that our proposed methods lead to models that scale much better compared to the original BERT.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"I'll just introduce the methodologies of ALBERT brifely.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"The first one is a factorized embedding parameterization. By decomposing the large vocabulary embedding matrix into two small matrices, we separate the size of the hidden layers from the size of vocabulary embedding.\"}),\"\\n\"]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"The second technique is cross-layer parameter sharing. This technique prevents the parameter from growing with the depth of the network.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"These approaches yield efficiency gains:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"An ALBERT configuration similar to BERT-large has 18x fewer parameters and can be trained about 1.7x faster.\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"The first one:\\n\",n(i.img,{src:\"/development/reading-papers-1/18.png\",alt:\"\"})]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Therefore, for ALBERT we use a factorization of the embedding parameters, decomposing them into two smaller matrices. Instead of projecting the one-hot vectors directly into the hidden space of size H, we first project them into a lower dimensional embedding space of size E, and then project it to the hidden space. By using this decomposition, we reduce the embedding parameters from O(V  H) to O(V  E + E  H).\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"The second:\\n\",n(i.img,{src:\"/development/reading-papers-1/17.png\",alt:\"\"})]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We observe that the transitions from layer to layer are much smoother for ALBERT than for BERT. These results show that weight-sharing has an effect on stabilizing network parameters. Although there is a drop for both metrics compared to BERT, they nevertheless do not converge to 0 even after 24 layers. This shows that the solution space for ALBERT parameters is very different from the one found by DQE. Although there is a drop for both metrics compared to BERT, they nevertheless do not converge to 0 even after 24 layers. This shows that the solution space for ALBERT parameters is very different from the one found by DQE.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?n(t,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/development/reading-papers"
  },
  {
    "title": "Next.js  CI/CD ",
    "description": "Github Actions AWS CodeDeploy  CI/CD .",
    "slug": "setup-ci-cd-with-codedeploy-github-actions",
    "publishDate": "2025-03-03",
    "thumbnailUrl": "/development/setup-ci-cd-with-codedeploy-github-actions/1.png",
    "content": "const{Fragment:l,jsx:n,jsxs:e}=arguments[0];function _createMdxContent(s){const c={a:\"a\",code:\"code\",h3:\"h3\",h5:\"h5\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...s.components};return e(l,{children:[n(c.p,{children:\"     EC2        .          .  CI/CD     .\"}),\"\\n\",n(c.p,{children:\"Continuous Integration\"}),\"\\n\",e(c.ul,{children:[\"\\n\",n(c.li,{children:\"      .     CI  .\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"Continuous Delivery & Deployment\"}),\"\\n\",e(c.ul,{children:[\"\\n\",n(c.li,{children:\"CI     .     Delivery,   Deployment .\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"CI/CD    .\"}),\"\\n\",e(c.ol,{children:[\"\\n\",n(c.li,{children:\" \"}),\"\\n\",n(c.li,{children:\"\"}),\"\\n\",n(c.li,{children:\"\"}),\"\\n\",n(c.li,{children:\" \"}),\"\\n\",n(c.li,{children:\"\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"      .   Bun   npm yarn      node.js    !\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"YAML\"}),\"\\n\",n(c.p,{children:\"YAML JSON     configuration   .         YAML  .  YAML   ...\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#  !\"})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"# '', \\\"\\\"  . \\\\n   : yaml      quote  .\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#    .\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"example:\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"with quotes\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"example:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" without\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" quotes\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"# >, |       . > space, | \\\\n .\"})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" \"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"# null  , ~     .\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"null\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" value:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" null\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"null\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" shorthand:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ~\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#  -  .\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#88C0D0\"},children:\"array:\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" apple\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" banana\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    -\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 12345\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" a:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" b\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"# json  .  json     yaml   .\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#      yaml    .\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"json\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" style\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" array:\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" [\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#88C0D0\"},children:\"    apple,\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    'banana'\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\",\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#88C0D0\"},children:\"    12345,\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    a:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" b,\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"]\"})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#   : \"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#88C0D0\"},children:\"object:\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    name:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" namu\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" wiki\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    type\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" dictionary\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    primary\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" color:\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#88C0D0\"},children:\"        gradient:\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"            start:\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 0x00A495\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"            end: 0x13AD65\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"        header:\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 0x008275\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#   ,     yaml    .\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"json\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" style\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" object:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" {\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    name:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" namu\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" wiki,\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:'    \"type\"'}),n(c.span,{style:{color:\"#88C0D0\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"dictionary\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\",\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"}\"})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"implicit\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" null:\"}),n(c.span,{style:{color:\"#616E88\"},children:\" #   null .\"})]})]})})}),\"\\n\",n(c.p,{children:\"    !      ...\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"GitHub Actions\"}),\"\\n\",e(c.p,{children:[\"GitHub Actions CI/CD  .    \",n(c.a,{href:\"https://docs.github.com/ko/actions/writing-workflows/quickstart\",children:\"https://docs.github.com/ko/actions/writing-workflows/quickstart\"}),\"      !\"]}),\"\\n\",e(c.p,{children:[\"GitHub Actions YAML      ~ (\",n(c.a,{href:\"https://hyeokrani.tistory.com/117\",children:\"https://hyeokrani.tistory.com/117\"}),\")\"]}),\"\\n\",n(c.p,{children:\"  CI     push .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ci\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#81A1C1\"},children:\"on\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  pull_request\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    branches\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" main\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  push\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    branches\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" main\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"jobs\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  ci\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    runs-on\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ubuntu-latest\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    steps\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" uses\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" actions/checkout@v4\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Setup Bun\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:\"          curl -fsSL https://bun.sh/install | bash\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:'          echo \"BUN_INSTALL=$HOME/.bun\" >> $GITHUB_ENV'})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:'          echo \"PATH=$HOME/.bun/bin:$PATH\" >> $GITHUB_ENV'})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Install dependencies\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" bun install\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Check\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" bun check\"})]})]})})}),\"\\n\",n(c.p,{children:\" workflow main  push PR .    ,\"}),\"\\n\",e(c.ol,{children:[\"\\n\",n(c.li,{children:\"  .\"}),\"\\n\",n(c.li,{children:\"Bun .\"}),\"\\n\",n(c.li,{children:\"Bun  .\"}),\"\\n\",n(c.li,{children:\" .\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"      PR .\"}),\"\\n\",e(c.p,{children:[n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/1.png\",alt:\"\"}),\"\\n\",n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/2.png\",alt:\"\"})]}),\"\\n\",n(c.p,{children:\"workflow  ,         .\\n  main  PR  CI      .\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.p,{children:\"      ,         .\"}),\"\\n\",n(c.p,{children:\"    ?\"}),\"\\n\",e(c.p,{children:[n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/3.png\",alt:\"\"}),\"\\n  GitHub repository main    GitHub Actions  .\"]}),\"\\n\",n(c.p,{children:\" GitHub Actions\"}),\"\\n\",e(c.ol,{children:[\"\\n\",n(c.li,{children:\"  \"}),\"\\n\",n(c.li,{children:\"    S3 Bucket  \"}),\"\\n\",n(c.li,{children:\"CodeDeploy    .\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"CodeDeploy EC2 instance  Code Deploy Agent  \"}),\"\\n\",e(c.ol,{children:[\"\\n\",n(c.li,{children:\"S3   \"}),\"\\n\",n(c.li,{children:\"      \"}),\"\\n\",n(c.li,{children:\"  .\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"        !\"}),\"\\n\",n(c.p,{children:\"     .\"}),\"\\n\",n(c.p,{children:\"Q1.      EC2    , GitHub Actions   ?\\nQ2.      EC2   , S3   ?\"}),\"\\n\",n(c.p,{children:\"Q1  AI   . (    !)\"}),\"\\n\",n(c.p,{children:\"A1-1)      GitHub Actions runner     .       ! (      )\\nA1-2)    !              .         ,      . (   !   CPU     .)\"}),\"\\n\",n(c.p,{children:\"Q2            ,     .             !\"}),\"\\n\",n(c.p,{children:\"A2-1)   (Artifact)    ,   S3 Bucket    .  ,         . (    !)\\nA2-2)    .  S3       ,   EC2        .\"}),\"\\n\",n(c.p,{children:\"    !\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"1. Bucket   GitHub Actions  IAM  \"}),\"\\n\",n(c.p,{children:\"     bucket .\"}),\"\\n\",n(c.p,{children:n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/4.png\",alt:\"\"})}),\"\\n\",n(c.p,{children:\"rookie-review-ci-cd  .\"}),\"\\n\",n(c.p,{children:\" GitHub Actions  IAM   .   S3 CodeDeploy      .\"}),\"\\n\",n(c.p,{children:n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/5.png\",alt:\"\"})}),\"\\n\",n(c.p,{children:\"AmazonS3FullAccess, AWSCodeDeployFullAccess    , GitHub Actions      Access key .\"}),\"\\n\",n(c.p,{children:\"  EC2     , GitHub Actions  EC2  . EC2 CodeDeploy    CodeDeploy     .\"}),\"\\n\",n(c.p,{children:\" GitHub  Setting > Secrets and variables > Actions  Access key Repository Secrets .\"}),\"\\n\",n(c.p,{children:n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/6.png\",alt:\"\"})}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"2. EC2 CodeDeploy   \"}),\"\\n\",n(c.p,{children:\"EC2 CodeDeploy AWS      .       .\"}),\"\\n\",n(c.p,{children:\"EC2   ?\"}),\"\\n\",e(c.ol,{children:[\"\\n\",n(c.li,{children:\"S3     . -> AmazonS3ReadOnlyAccess\"}),\"\\n\",n(c.li,{children:\"EC2  CodeDeploy Agent      . -> AmazonEC2RoleforAWSCodeDeploy\"}),\"\\n\"]}),\"\\n\",e(c.p,{children:[n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/7.png\",alt:\"\"}),\"\\n\",n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/8.png\",alt:\"\"})]}),\"\\n\",n(c.p,{children:\" CodeDeploy   .\"}),\"\\n\",n(c.p,{children:n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/9.png\",alt:\"\"})}),\"\\n\",n(c.p,{children:\"    .\"}),\"\\n\",n(c.hr,{}),\"\\n\",e(c.ol,{start:\"3\",children:[\"\\n\",n(c.li,{children:\"CodeDeploy     \"}),\"\\n\"]}),\"\\n\",e(c.p,{children:[\"CodeDeploy   .\\n\",n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/10.png\",alt:\"\"})]}),\"\\n\",n(c.p,{children:\"CodeDeplooy  EC2   EC2/On-premises  .\"}),\"\\n\",n(c.p,{children:\"  .\"}),\"\\n\",e(c.p,{children:[n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/11.png\",alt:\"\"}),\"\\n\",n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/12.png\",alt:\"\"}),\"\\n\",n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/13.png\",alt:\"\"})]}),\"\\n\",n(c.p,{children:\"     ,   .      ! ( )\"}),\"\\n\",n(c.p,{children:\" GitHub Actions   secrets  .\"}),\"\\n\",n(c.p,{children:n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/14.png\",alt:\"\"})}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"4. EC2  CodeDeploy Agent \"}),\"\\n\",n(c.p,{children:\"     .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" apt\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" update\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" apt\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" install\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ruby-full\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" apt\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" install\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" wget\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"cd\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"wget\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" https://aws-codedeploy-ap-northeast-2.s3.ap-northeast-2.amazonaws.com/latest/install\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"chmod\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" +x\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ./install\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ./install\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" auto\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" >\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /tmp/logfile\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (20.04 \"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\")\"})]})]})})}),\"\\n\",n(c.p,{children:\"CodeDeploy     ruby-full, wget  .       .\"}),\"\\n\",n(c.p,{children:\"  ubuntu 20.04        > /tmp/logfile     .\"}),\"\\n\",n(c.p,{children:\"       .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" service\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" codedeploy-agent\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" status\"})]})})})}),\"\\n\",n(c.p,{children:\"Active: active (running) ->  CodeDeploy Agent   !\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"5. GitHub Actions CodeDeploy \"}),\"\\n\",n(c.p,{children:\" GitHub Actions    .\"}),\"\\n\",n(c.p,{children:\".github/workflows/deploy.yml\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" deploy to S3\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"# main  push   workflow \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#81A1C1\"},children:\"on\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  push\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    branches\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" main\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  workflow_dispatch\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#   \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"env\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  S3_BUCKET_NAME\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ${{ secrets.S3_BUCKET_NAME }}\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  CODE_DEPLOY_APPLICATION_NAME\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ${{ secrets.CODE_DEPLOY_APPLICATION_NAME }}\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  CODE_DEPLOY_DEPLOYMENT_GROUP_NAME\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ${{ secrets.CODE_DEPLOY_DEPLOYMENT_GROUP_NAME }}\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"jobs\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  build\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    runs-on\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ubuntu-latest\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    steps\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      #  clone\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Checkout\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        uses\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" actions/checkout@v4\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      # Bun      \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Setup Bun\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:\"          curl -fsSL https://bun.sh/install | bash\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:'          echo \"BUN_INSTALL=$HOME/.bun\" >> $GITHUB_ENV'})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:'          echo \"PATH=$HOME/.bun/bin:$PATH\" >> $GITHUB_ENV'})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      #   \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Install dependencies\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" bun install\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      # Next.js  \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Build next app\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" bun run build\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      #      .zip  \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Make zip file\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:' zip -qq -r ./rookie_review.zip . -x \".git/*\"'})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"        # -qq: quit   (   )\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"        # -r:     (    )\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"        # -x:     \"})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      # Github Action AWS    \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Configure AWS credentials\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        uses\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" aws-actions/configure-aws-credentials@v2\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        with\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"          aws-access-key-id\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ${{ secrets.AWS_ACCESS_KEY_ID }}\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"          aws-secret-access-key\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ${{ secrets.AWS_SECRET_ACCESS_KEY }}\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"          aws-region\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ${{ secrets.AWS_REGION }}\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      #   S3 \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Upload to S3\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" aws s3 cp --region ap-northeast-2 ./rookie_review.zip s3://${{ env.S3_BUCKET_NAME }}/rookie_review.zip\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"        # aws s3 cp: AWS CLI   \"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"        # --region ap-northeast-2:    \"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"        #  S3    .\"})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"      # S3      CodeDeploy    \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"      -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Code Deploy\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"        run\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:\"          aws deploy create-deployment \\\\\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:\"          --application-name ${{ env.CODE_DEPLOY_APPLICATION_NAME }} \\\\\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:\"          --deployment-config-name CodeDeployDefault.AllAtOnce \\\\\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:\"          --deployment-group-name ${{ env.CODE_DEPLOY_DEPLOYMENT_GROUP_NAME }} \\\\\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#A3BE8C\"},children:\"          --s3-location bucket=$S3_BUCKET_NAME,bundleType=zip,key=rookie_review.zip\"})})]})})}),\"\\n\",n(c.p,{children:\"appspec.yml CodeDeploy    .\"}),\"\\n\",n(c.p,{children:\"appspec.yml\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"version\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 0.0\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"os\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" linux\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"files\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"  -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" source\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    destination\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/waffle_rookie_review\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    overwrite\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" yes\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"permissions\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"  -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" object\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/waffle_rookie_review\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    owner\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ubuntu\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    group\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ubuntu\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"    mode\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 755\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"hooks\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  BeforeInstall\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"    -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" location\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" scripts/before-install.sh\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"      timeout\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 300\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"      runas\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ubuntu\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"  AfterInstall\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"    -\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\" location\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" scripts/after-install.sh\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"      timeout\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 300\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"      runas\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ubuntu\"})]})]})})}),\"\\n\",n(c.p,{children:\"  before-install.sh   ,       .\"}),\"\\n\",n(c.p,{children:\"scripts/before-install.sh\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#D8DEE9\"},children:\"REPOSITORY\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"/home/ubuntu/waffle_rookie_review\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#616E88\"},children:\"#     \"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"find\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\" $REPOSITORY\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -mindepth\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 1\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -delete\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"echo\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"Cleanup completed.\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]})]})})}),\"\\n\",n(c.p,{children:\"    ,\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#88C0D0\"},children:\"Message\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"The\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" deployment\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" failed\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" because\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" a\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" specified\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" file\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" already\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" exists\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" this\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" location:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/waffle_rookie_review/.gitignore\"})]})]})})}),\"\\n\",n(c.p,{children:\"  CodeDeploy      . overwrite: yes  .gitignore      .   .              .\"}),\"\\n\",n(c.p,{children:\" after-install.sh     pm2   .\"}),\"\\n\",n(c.p,{children:\"scripts/after-install.sh\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#D8DEE9\"},children:\"REPOSITORY\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"/home/ubuntu/waffle_rookie_review\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#D8DEE9\"},children:\"BUN_PATH\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"/home/ubuntu/.bun/bin/bun\"})]}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"cd\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\" $REPOSITORY\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" ||\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" {\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"  echo\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"Error: Failed to navigate to project directory.\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"  exit\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 1\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#ECEFF4\"},children:\"}\"})}),\"\\n\",n(c.span,{className:\"line\"}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#D8DEE9\"},children:\"$BUN_PATH\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" run deploy\"})]})]})})}),\"\\n\",n(c.p,{children:\" bun run deploy  package.json  .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:'\"deploy\"'}),n(c.span,{style:{color:\"#88C0D0\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"pm2 start ecosystem.config.js --env production\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]})})})}),\"\\n\",n(c.p,{children:\" CodeDeploy   pm2      .\"}),\"\\n\",n(c.p,{children:\"ecosystem.config.js\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#8FBCBB\"},children:\"module\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),n(c.span,{style:{color:\"#8FBCBB\"},children:\"exports\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" =\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" {\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"  apps\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" [\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#ECEFF4\"},children:\"    {\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      name\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"waffle_rookie_review\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" //  \"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      script\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"./node_modules/next/dist/bin/next\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" // Next.js  \"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      args\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"start\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" // Next.js     \"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      exec_mode\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"fork\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" //  : cluster  fork  \"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      instances\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"1\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" //      (CPU  )\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      autorestart\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" true\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" //    \"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      watch\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" true\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" //     (  )\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      max_memory_restart\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"1G\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" // 1GB     \"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      interpreter\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"/home/ubuntu/.bun/bin/bun\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"      env\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" {\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"        NODE_ENV\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"production\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(c.span,{style:{color:\"#616E88\"},children:\" // Node.js  \"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"        PATH\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\":\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" `\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"${\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\"process\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\"env\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\"HOME\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"}\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"/.bun/bin:\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"${\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\"process\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\"env\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),n(c.span,{style:{color:\"#D8DEE9\"},children:\"PATH\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"}\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"`\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#ECEFF4\"},children:\"      },\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#ECEFF4\"},children:\"    },\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"  ]\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"}\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\";\"})]})]})})}),\"\\n\",n(c.p,{children:\" !....   CodeDeploy  .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"LifecycleEvent\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" AfterInstall\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"Script\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" scripts/after-install.sh\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"stderr\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"$ pm2 start ecosystem.config.js --env production\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"stderr\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"/usr/bin/bash: line 1: pm2: command not found\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"stderr\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"error: script \"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"deploy\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" exited with code 127\"})]})]})})}),\"\\n\",n(c.p,{children:\"scripts  pm2   pm2    .\"}),\"\\n\",n(c.p,{children:\"       PATH     .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ln\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -s\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/.bun/bin/pm2\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /usr/bin/pm2\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ln\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -s\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/.bun/bin/pm2\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /usr/local/bin/pm2\"})]})]})})}),\"\\n\",n(c.p,{children:\"pm2      which pm2   .\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"6.  \"}),\"\\n\",n(c.h5,{children:\"1)  \"}),\"\\n\",n(c.p,{children:\"  .env    .gitignore  .       EC2     .       Secure Copy Protocol(SCP)   .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"scp\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -i\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" <\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"key.pe\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"m\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\">\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" .env\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" <\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"ec2-use\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\">\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"@\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"<\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"EC2_PUBLIC_I\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"P\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\">\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\":/\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"<\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"target_director\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"y\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\">\"})]})})})}),\"\\n\",n(c.p,{children:\"key.pem      ,\"}),\"\\n\",n(c.p,{children:\"ec2-user ubuntu, target_directory   /home/ubuntu/waffle_rookie_review .\"}),\"\\n\",n(c.p,{children:\"..!    \"}),\"\\n\",n(c.p,{children:\" CodeDeploy before-install.sh     !  .env       .\"}),\"\\n\",n(c.p,{children:\"/home/ubuntu/env_backups    .env  .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"mv\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/waffle_rookie_review/.env.local\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/env_backups\"})]})})})}),\"\\n\",n(c.p,{children:\" after-install.sh      .env    .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#81A1C1\"},children:\"if\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" [\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" -f\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"/home/ubuntu/env-backups/.env.local\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" ]\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\";\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" then\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"  echo\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"> Restoring .env.local file...\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"  cp\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/env-backups/.env.local\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /home/ubuntu/waffle_rookie_review/.env.local\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" ||\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" {\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    echo\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"Error: Failed to restore .env.local file.\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"    exit\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 1\"})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#ECEFF4\"},children:\"  }\"})}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#81A1C1\"},children:\"else\"})}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"  echo\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"Warning: No backup .env.local file found. Skipping restoration.\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(c.span,{className:\"line\",children:n(c.span,{style:{color:\"#81A1C1\"},children:\"fi\"})})]})})}),\"\\n\",n(c.h5,{children:\"2)  \"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"No\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" space\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" left\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" on\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" device\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" @\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" io_write\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" -\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /opt/codedeploy-agent/deployment-root/a9949aba-cefa-4167-bc1b-0b0498d28232/d-1KKQEAKKA/bundle.tar\"})]})})})}),\"\\n\",n(c.p,{children:\" ... df -h         .    ...   .\"}),\"\\n\",n(c.p,{children:\"  volume       volume  .\"}),\"\\n\",n(c.p,{children:n(c.img,{src:\"/development/setup-ci-cd-with-codedeploy-github-actions/15.png\",alt:\"\"})}),\"\\n\",n(c.p,{children:\"       .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" growpart\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" /dev/xvda\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 1\"})]})})})}),\"\\n\",n(c.p,{children:\" df -h        . \"}),\"\\n\",n(c.h5,{children:\"3) CodeDeploy  \"}),\"\\n\",n(c.p,{children:\" CodeDeploy    3  pending .         .    ?   .\"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" systemctl\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" stop\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" codedeploy-agent\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"sudo\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" systemctl\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" start\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" codedeploy-agent\"})]})]})})}),\"\\n\",n(c.p,{children:\".  .\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.h3,{children:\"7. \"}),\"\\n\",n(c.p,{children:\"  WebStorm  , main branch PR   ci    .      prettier   , GitHub Actions       ...    .   .\"}),\"\\n\",e(c.ol,{children:[\"\\n\",n(c.li,{children:\"CodeDeploy   appspec.yml appsepc.yml  \"}),\"\\n\",n(c.li,{children:\"   waffle_rookie_review  rookie_review  \"}),\"\\n\",n(c.li,{children:\"Region ap-northeast-2 ap-northeas-2 \"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"       . ...\"}),\"\\n\",n(c.p,{children:\"      Bun   .   npm      npm .\"}),\"\\n\",n(c.p,{children:\"             pm2   ecosystem.config.js .    node.js       CI/CD    .  \"}),\"\\n\",n(l,{children:n(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:e(c.code,{children:[e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" TracingChannel.traceSync\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (node:diagnostics_channel:322:14)\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" wrapModuleLoad\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (node:internal/modules/cjs/loader:220:24)\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Module.require\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (node:internal/modules/cjs/loader:1311:12)\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" require\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (node:internal/modules/helpers:136:16)\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Object.\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"<\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"anonymou\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\"s\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\">\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (/home/ubuntu/waffle_rookie_review/node_modules/.bin/next:6:1)\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Module._compile\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (node:internal/modules/cjs/loader:1554:14)\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Object..js\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (node:internal/modules/cjs/loader:1706:10)\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"     at\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" Module.load\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" (node:internal/modules/cjs/loader:1289:32) \"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"{\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"   code:\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" '\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"MODULE_NOT_FOUND\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\",\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"   requireStack:\"}),n(c.span,{style:{color:\"#D8DEE9FF\"},children:\" [ \"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"/home/ubuntu/waffle_rookie_review/node_modules/.bin/next\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" ]\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:\" }\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\" Node.js\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" v22.14.0\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\" error:\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" script\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\"start\"}),n(c.span,{style:{color:\"#ECEFF4\"},children:'\"'}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" exited\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" with\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" code\"}),n(c.span,{style:{color:\"#B48EAD\"},children:\" 1\"})]}),\"\\n\",e(c.span,{className:\"line\",children:[n(c.span,{style:{color:\"#88C0D0\"},children:\"0\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\"|\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\"waffle_r\"}),n(c.span,{style:{color:\"#81A1C1\"},children:\" |\"}),n(c.span,{style:{color:\"#88C0D0\"},children:\" $\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" next\"}),n(c.span,{style:{color:\"#A3BE8C\"},children:\" start\"})]})]})})}),\"\\n\",n(c.p,{children:\"  node.js     . \\n', pm2 node.js   .   22.14. ! deploy.yml 20.11.1  .'\\n   node.js  20.11.1 .\"}),\"\\n\",n(c.p,{children:\"   .\"}),\"\\n\",n(c.p,{children:\"   bun install   pm2 restart 0     .   ?  node.js  ...    .    Bun!! interpreter bun      .\"}),\"\\n\",n(c.p,{children:\"     ...    .       .          !             .            .\"}),\"\\n\",n(c.p,{children:\"  Bun       .           !\"}),\"\\n\",n(c.hr,{}),\"\\n\",n(c.p,{children:\"    https  ...    Docker    ,         .       .\"})]})}return{default:function(l={}){const{wrapper:e}=l.components||{};return e?n(e,{...l,children:n(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/development/setup-ci-cd-with-codedeploy-github-actions"
  },
  {
    "title": "Let's learn seq2seq!",
    "description": "Learn how to use seq2seq models using PyTorch",
    "slug": "tutorial-seq2seq",
    "publishDate": "2025-04-12",
    "thumbnailUrl": "/development/tutorial-seq2seq/thum.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const c={a:\"a\",code:\"code\",hr:\"hr\",img:\"img\",p:\"p\",pre:\"pre\",span:\"span\",...s.components};return n(l,{children:[e(c.p,{children:\"Recently, I've been studying large language models(LLMs). I understand the algorithms behind what they are and how they work, but I don't have a precise understanding of their implementation.\"}),\"\\n\",e(c.p,{children:\"I'm still pondering the necessity of understanding the basics of LLMs, such as implementation details, architecture, and so on. Since there is so much to learn in the field of LLMs, It's impossible to study everything in depth. However, as an undergraduate student without any immediate obligation to apply them for quick results, I plan to take my time and study step by step - starting with seq2seq, transformer, and other language models.\"}),\"\\n\",n(c.p,{children:[\"This post focuses on the seq2seq model. For learning purposes, I referred to \",e(c.a,{href:\"https://github.com/bentrevett/pytorch-seq2seq\",children:\"seq2seq tutorial link\"}),\".\"]}),\"\\n\",e(c.hr,{}),\"\\n\",e(c.p,{children:\"LSTM is more advanced type of RNN that can retain long-term information better than the original RNN. Unlike RNNs, which only have a hidden state, LSTMs include a cell state - a vector that stores information about the previous state of the LSTM cell.\"}),\"\\n\",e(c.p,{children:\"Leveraging LSTMs, many researchers have developed various techniques for translating one language to another.\"}),\"\\n\",e(c.p,{children:e(c.img,{src:\"/development/tutorial-seq2seq/rnn1.png\",alt:\"\"})}),\"\\n\",e(c.p,{children:\"This is the original RNN architecture. The gray boxes represent cells, which take an input and produce an output, a hidden state, and a cell state.\\nThe mathematical expression is as follows:\"}),\"\\n\",e(c.p,{children:\"(h_t, c_t) = LSTM(e(x_t), h_t-1, c_t-1)\"}),\"\\n\",e(c.p,{children:\"However, the architecture above has a limitation: the dimensions of the inputs and outputs are fixed and identical. This poses a significant challenge for translation tasks, as most languages vary in length when expressing the same meaning.\"}),\"\\n\",n(c.p,{children:[e(c.img,{src:\"/development/tutorial-seq2seq/lstm1.png\",alt:\"\"}),\"\\n\",e(c.img,{src:\"/development/tutorial-seq2seq/lstm2.png\",alt:\"\"})]}),\"\\n\",e(c.p,{children:\"But this paper separates LSTM to two parts: encoder and decoder. Encoder LSTM takes the input sequence and produces a context vector, which has a information about the input sequence. Decoder LSTM takes the context vector and produces output one token at a time.\"}),\"\\n\",e(c.p,{children:e(c.img,{src:\"/development/tutorial-seq2seq/seq2seq1.png\",alt:\"\"})}),\"\\n\",e(c.p,{children:\"the code implementing the paper is as follows (be cautious about the dimensions):\"}),\"\\n\",e(c.p,{children:\"Encoder\"}),\"\\n\",e(l,{children:e(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:[n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(c.span,{style:{color:\"#8FBCBB\"},children:\" Encoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" input_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" embedding_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" hidden_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" n_layers\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"Embedding\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"input_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" embedding_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"rnn \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"LSTM\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" src\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # src = [src length, batch size]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        embedded \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"embedding\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"src\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # embedded = [src length, batch size, embedding dim]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"rnn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"embedded\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # outputs = [src length, batch size, hidden dim * n directions]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # outputs are always from the top hidden layer\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"})]})]})})}),\"\\n\",n(c.p,{children:[e(c.code,{children:\"outputs, (hidden, cell) = self.rnn(embedded)\"}),\" represents an input and an output of LSTM structure.\"]}),\"\\n\",e(c.p,{children:\"Decoder\"}),\"\\n\",e(l,{children:e(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:[n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(c.span,{style:{color:\"#8FBCBB\"},children:\" Decoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" output_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" embedding_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" hidden_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" n_layers\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" output_dim\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"Embedding\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" embedding_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"rnn \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"LSTM\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"fc_out \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" output_dim\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" input\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" cell\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # input = [batch size]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # n directions in the decoder will both always be 1, therefore:\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # context = [n layers, batch size, hidden dim]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#88C0D0\"},children:\"        input\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" input\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"unsqueeze\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # input = [1, batch size]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        embedded \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"embedding\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"input\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # embedded = [1, batch size, embedding dim]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        output\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"rnn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"embedded\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # output = [seq length, batch size, hidden dim * n directions]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # seq length and n directions will always be 1 in this decoder, therefore:\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # output = [1, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers, batch size, hidden dim]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        prediction \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"fc_out\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"output\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"squeeze\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # prediction = [batch size, output dim]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" prediction\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"})]})]})})}),\"\\n\",n(c.p,{children:[e(c.code,{children:\"output, (hidden, cell) = self.rnn(embedded, (hidden, cell))\"}),\" is similar to the one of encoder.\"]}),\"\\n\",e(c.p,{children:\"Model\"}),\"\\n\",e(l,{children:e(c.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(c.code,{children:[n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(c.span,{style:{color:\"#8FBCBB\"},children:\" Seq2Seq\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" encoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" decoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" device\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"encoder \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" encoder\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"decoder \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"device \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" device\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        assert\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\" (\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"            encoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#ECEFF4\"},children:\"        ),\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(c.span,{style:{color:\"#A3BE8C\"},children:\"Hidden dimensions of encoder and decoder must be equal!\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        assert\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\" (\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"            encoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#ECEFF4\"},children:\"        ),\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(c.span,{style:{color:\"#A3BE8C\"},children:\"Encoder and decoder must have equal number of layers!\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(c.span,{className:\"line\"}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" src\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" trg\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9\"},children:\" teacher_forcing_ratio\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # src = [src length, batch size]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # trg = [trg length, batch size]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # teacher_forcing_ratio is probability to use teacher forcing\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # e.g. if teacher_forcing_ratio is 0.75 we use ground-truth inputs 75% of the time\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        batch_size \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(c.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        trg_length \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(c.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        trg_vocab_size \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"decoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # tensor to store decoder outputs\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"zeros\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"trg_length\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" batch_size\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" trg_vocab_size\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"to\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"device\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # last hidden state of the encoder is used as the initial hidden state of the decoder\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"        hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"encoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"src\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # first input to the decoder is the <sos> tokens\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#88C0D0\"},children:\"        input\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(c.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\" :]\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"        # input = [batch size]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        for\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" t \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\" range\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" trg_length\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # insert input token embedding, previous hidden and previous cell states\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # receive output tensor (predictions) and new hidden and cell states\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"            output\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"decoder\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"input\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # output = [batch size, output dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # cell = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # place predictions in a tensor holding predictions for each token\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"            outputs\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"t\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # decide if we are going to use teacher forcing or not\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"            teacher_force \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" random\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"random\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"()\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" <\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" teacher_forcing_ratio\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # get the highest predicted token from our predictions\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"            top1 \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(c.span,{style:{color:\"#88C0D0\"},children:\"argmax\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(c.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # if teacher forcing, use actual next token as next input\"})}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # if not, use predicted token\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#88C0D0\"},children:\"            input\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\"t\"}),e(c.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(c.span,{style:{color:\"#81A1C1\"},children:\" if\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" teacher_force \"}),e(c.span,{style:{color:\"#81A1C1\"},children:\"else\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" top1\"})]}),\"\\n\",e(c.span,{className:\"line\",children:e(c.span,{style:{color:\"#616E88\"},children:\"            # input = [batch size]\"})}),\"\\n\",n(c.span,{className:\"line\",children:[e(c.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(c.span,{style:{color:\"#D8DEE9FF\"},children:\" outputs\"})]})]})})}),\"\\n\",e(c.p,{children:\"I would recommend you to read minutely about the flow of the code, if you are begginer of Neural Network and Language model.\"}),\"\\n\",e(c.hr,{})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/development/tutorial-seq2seq"
  }
]