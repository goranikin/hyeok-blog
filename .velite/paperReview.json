[
  {
    "title": "Attention is all you need",
    "description": "Deep dive into the Transformer architecture, especially the implementation in each layers.",
    "slug": "attention-is-all-you-need",
    "publishDate": "2025-04-13",
    "thumbnailUrl": "/study/paper-review/attention-is-all-you-need/thum.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",code:\"code\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",...s.components};return n(l,{children:[n(r.p,{children:[\"In this post, I will explain the \",e(r.a,{href:\"https://arxiv.org/abs/1706.03762\",children:\"transformer\"}),\" architecture and its implementation at the code level. I referred to a \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"scratch\"}),\" implementation for the PyTorch code!\"]}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"The authors of the paper all left Google and founded their own companies, except for Lukasz Kaiser, who joined OpenAI. Five out of the 7 companies have become unicorns, with a combined valuation exceeding $17 billion. It's quite impressive.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/2.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"This is Figure 1 from the paper. It illustrates the overall architecture of the Transformer.\"}),\"\\n\",e(r.p,{children:\"They designed the operation, called Scaled Dot-Product Attention, which calculates the attention scores between query and key vectors to reflect the context information between the tokens.\"}),\"\\n\",e(r.p,{children:\"They represented the formula like this.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/3.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"How can we implement Scaled Dot-Product Attention in PyTorch? Let's start from scratch.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" ScaledDotProductAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" temperature\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" attn_dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"temperature \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" temperature\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn_dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # q = [batch_size, n_head, len_q, d_k]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # k = [batch_size, n_head, len_k, d_k]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # v = [batch_size, n_head, len_k, d_v]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"matmul\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"/\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"temperature\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"is\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" not\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"masked_fill\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" -\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e9\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"F\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"softmax\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=-\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"matmul\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"The original method uses the square root of \",e(r.code,{children:\"d_model\"}),\" for normalization, but this approach uses a learnable temperature parameter during training. A higher temperature value results in a more uniform attention distribution.\"]}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"attn\"}),\" has a shape \",e(r.code,{children:\"[batch_size, n_head, len_q, len_k]\"}),\", which represents the attention scores between query and key vectors. For example, \",e(r.code,{children:\"a[:,:,1,2]\"}),\" is the attention score between the first query vector and the second key vector.\"]}),\"\\n\",e(r.p,{children:\"A mask is applied to ignore padding tokens in the sequence for efficiency and to ensure that self-attention in the decoder does not reference future tokens.\"}),\"\\n\",n(r.p,{children:[\"The output has a shape of \",e(r.code,{children:\"[batch_size, n_head, len_q, d_v]\"})]}),\"\\n\",e(r.p,{children:\"This is just one module used in the Multi-Head attention mechanism.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/4.png\",alt:\"\"})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_qs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_ks \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_vs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"fc \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attention \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" ScaledDotProductAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"temperature\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0.5\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"layer_norm \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LayerNorm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" eps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e-6\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # q = [batch_size, len_q, d_model]\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        residual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q \"}),e(r.span,{style:{color:\"#616E88\"},children:\"# enc_input\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Separate different heads: [batch, len, n_head, d] (d_model / n_head = d_k)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_qs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_ks\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_vs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Transpose for attention dot product: [batch, len, n_head, d]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"is\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" not\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"unsqueeze\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"attention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Transpose to move the head dimension back: b x lq x n x dv\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Combine the last two dimensions to concatenate all the heads together: b x lq x (n*dv)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"contiguous\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" -\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"fc\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # LayerNorm(x + Sublayer(x))\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" residual\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"layer_norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"Wait, what is the layer function? And what does \",e(r.code,{children:\"fc\"}),\" mean? I recommend reading \",e(r.a,{href:\"https://thecho7.tistory.com/entry/PyTorch-nnLinear%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A7%88%EB%AC%B8\",children:\"pytorch layer\"}),\" (this is a Korean blog), which provides a concise explanation.\"]}),\"\\n\",n(r.p,{children:[\"The Multi-Head Attention mechanism takes parameters \",e(r.code,{children:\"q\"}),\", \",e(r.code,{children:\"k\"}),\", and \",e(r.code,{children:\"v\"}),\". In practice, all of them are derived from the same input \",e(r.code,{children:\"x\"}),\". This is why the residual connection is applied to \",e(r.code,{children:\"q\"}),\".\"]}),\"\\n\",n(r.p,{children:[\"After performing Scaled Dot-Product attention and applying \",e(r.code,{children:\"transpose(1, 2).contiguous().view(sz_b, len_q, -1)\"}),\", \",e(r.code,{children:\"q\"}),\" has a shape of \",e(r.code,{children:\"[sz_batch, len_q, n_head * d_v]\"}),\". In the original architecture, \",e(r.code,{children:\"d_v = d_k\"}),\", but when \",e(r.code,{children:\"d_v != d_k\"}),\", it ensures that the output and input dimensions of the \",e(r.code,{children:\"fc\"}),\" layer remain consistent.\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_1 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_2 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"layer_norm \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LayerNorm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" eps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e-6\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        residual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"F\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"relu\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")))\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" residual\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"layer_norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]})]})})}),\"\\n\",e(r.p,{children:\"This is Feed Forward Network. It is a simple linear transformation followed by a ReLU activation function and a dropout layer.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" EncoderLayer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"pos_ffn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" slf_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        enc_output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"pos_ffn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_slf_attn\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" DecoderLayer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"enc_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"pos_ffn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" self_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dec_enc_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"self_attn_mask\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        )\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_enc_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"enc_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dec_enc_attn_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"pos_ffn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_enc_attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"In fact, the Encoder and Decoder are straightforward implementations of their respective layers. It's more an algorithmic problem - determining where to provide the input and how to obtain the output. Therefore, I'll skip the following code snippets. If you want to a deeper dive into the Transformer code, please refer to the \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"scratch\"}),\".\"]}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"reference\"}),\"\\n\",n(r.ol,{children:[\"\\n\",n(r.li,{children:[\"Attention is all you need: \",e(r.a,{href:\"https://arxiv.org/abs/1706.03762\",children:\"https://arxiv.org/abs/1706.03762\"})]}),\"\\n\",n(r.li,{children:[\"transformer code: \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\"})]}),\"\\n\"]}),\"\\n\",e(r.hr,{})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/study/paper-review/attention-is-all-you-need"
  },
  {
    "title": "CLIP",
    "description": "DSBA 연구실 사전학습 논문 리뷰 - Learning Transferable Visual Models From Natural Language Supervision",
    "slug": "clip",
    "publishDate": "2025-07-14",
    "thumbnailUrl": "/study/paper-review/clip/thm1.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...s.components};return n(l,{children:[e(r.p,{children:\"7월부터 DSBA 연구실에서 인턴을 하는 중입니다. AI 무지랭이를 위해 감사하게도 사전학습이란 제도가 있는데요. 각 분야 별로 논문을 읽고 Notion에 정리한 뒤, 기존 연구원분들 앞에서 읽은 내용에 대해 자신만의 생각을 이야기하는 구조입니다. 어떤 식으로 논문을 읽으면 좋을지, 또 앞으로 어떤 식으로 나아가면 좋을지 피드백을 듣는 자리입니다. 이와 관련해서 Notion에 내용을 옮기고, 이후 마지막 단락에서 발표할 때 말했던 것들과 피드백 등 다양한 이야깃거리를 남기려고 합니다.\"}),\"\\n\",e(r.p,{children:\"이전과 달리 해당 문서들은 한글로 작성될 예정입니다.\"}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"다음 구분 선까지 Notion 내용입니다.\"}),\"\\n\",e(r.p,{children:e(r.a,{href:\"https://arxiv.org/abs/2103.00020\",children:\"Paper Link\"})}),\"\\n\",e(r.h2,{children:\"1. Introduction\"}),\"\\n\",n(r.ol,{children:[\"\\n\",e(r.li,{children:\"논문이 다루는 분야\"}),\"\\n\"]}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"Vision model training with natural language\"}),\"\\n\",e(r.li,{children:\"Multi-modal model\"}),\"\\n\",e(r.li,{children:\"Natural Language Supervision & Weak-Supervision Training\"}),\"\\n\",e(r.li,{children:\"Transfer learning\"}),\"\\n\",e(r.li,{children:\"Zero-show or few-shot transfer task capability\"}),\"\\n\"]}),\"\\n\",n(r.ol,{start:\"2\",children:[\"\\n\",e(r.li,{children:\"해당 task에서 기존 연구 한계점 (정상적인 논문이라면 introduction에서 간략히 언급함)\"}),\"\\n\"]}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"기존 Vision model을 학습시키기 위한 Dataset들은 대부분 labeled data → 양이 적음\"}),\"\\n\",e(r.li,{children:\"다양한 downstream task에 대한 기존 model의 zero-shot transfer 능력 부족\"}),\"\\n\"]}),\"\\n\",n(r.ol,{start:\"3\",children:[\"\\n\",e(r.li,{children:\"논문의 contributions\"}),\"\\n\"]}),\"\\n\",n(r.ul,{children:[\"\\n\",n(r.li,{children:[\"대규모 데이터셋을 통한 Weak-supervised training concept 제시\",\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"(본문 내용) Could scalable pre-training methods which learn directly from web text result in a similar breakthrough in computer vision?\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"zero-shot transfer를 통한 task 수행 능력에 초점 → 기존에는 representation에 초점\",\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"ex) 고양이 이미지를 얼마나 잘 표현하는가? → 고양이임을 얼마나 잘 분류하는가?\"}),\"\\n\",e(r.li,{children:\"(본문 내용) While much research in the field of unsupervised learning focuses on the representation learning capabilities of machine learning systems, we motivate studying zero-shot transfer as a way of measuring the task-learning capabilities of machine learning systems.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",e(r.h2,{children:\"2. Related Work\"}),\"\\n\",n(r.ul,{children:[\"\\n\",n(r.li,{children:[\"Improved deep metric learning with multi-class n-pair loss objective, Advances in neural information processing systems 2016\",\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"N-pair loss로 한 번에 여러 클래스 샘플을 동시에 고려하여 더 효율적으로 “거리”를 학습\"}),\"\\n\",e(r.li,{children:\"CLIP의 training에도 해당 N-pair contrastive loss 사용\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"Learning Visual Features from Large Weakly Supervised Data, ECCV 2016\",\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"대규모 Weakly supervised 데이터셋을 활용해 CNN 기반 모델을 학습\"}),\"\\n\",e(r.li,{children:\"라벨이 약하더라도 충분한 데이터가 존재하면 일반화된 능력을 얻을 수 있음\"}),\"\\n\",e(r.li,{children:\"CLIP의 Weak-supervised dataset의 motivation.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"Learning Visual N-grams from Web Data, IEEE 2017\",\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"이미지와 텍스트 N-gram을 연결하도록 모델을 학습\"}),\"\\n\",e(r.li,{children:\"단일 단어가 아닌, 구나 문장 단위 개념을 모델링\"}),\"\\n\",e(r.li,{children:\"CLIP 학습 방법의 Motivation\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"VirTex, ICMLM, ConVIRT\",\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"CLIP과 비슷하게 텍스트-이미지 구조를 통해 학습시킨 모델들\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",e(r.h2,{children:\"3. 제안 방법론\"}),\"\\n\",e(r.h3,{children:\"Main Idea & Contribution\"}),\"\\n\",n(r.ol,{children:[\"\\n\",e(r.li,{children:\"Architecture\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/clip/1.png\",alt:\"image.png\"})}),\"\\n\",e(r.p,{children:\"Text encoder: Transformer - 63M parameter, 12 layer, 512 wide model with 8 heads\"}),\"\\n\",e(r.p,{children:\"Image encoder\"}),\"\\n\",n(r.table,{children:[e(r.thead,{children:n(r.tr,{children:[e(r.th,{}),e(r.th,{children:\"Base style\"}),e(r.th,{children:\"EfficientNet style\"}),e(r.th,{})]})}),e(r.tbody,{children:n(r.tr,{children:[e(r.td,{children:\"ResNe\"}),e(r.td,{children:\"ResNet-50, ResNet-101\"}),e(r.td,{children:\"RN50x4, RN50x16, RN50x64\"}),e(r.td,{})]})})]}),\"\\n\",n(r.table,{children:[e(r.thead,{children:n(r.tr,{children:[e(r.th,{}),e(r.th,{children:\"Base\"}),e(r.th,{children:\"Large\"})]})}),e(r.tbody,{children:n(r.tr,{children:[e(r.td,{children:\"ViT\"}),e(r.td,{children:\"16, 32\"}),e(r.td,{children:\"14, 14@336px\"})]})})]}),\"\\n\",e(r.p,{children:\"CLIP model은 ViT-L/14@336px 사용 (Best performance)\"}),\"\\n\",e(r.p,{children:\"가장 큰 모델 기준으로 RN50x64는 592대의 V100으로 18일간 학습, ViT-L/14는 256대의 V100으로 12일간 학습 🤔\"}),\"\\n\",n(r.p,{children:[\"코드 구현 (\",e(r.a,{href:\"https://github.com/openai/CLIP\",children:\"https://github.com/openai/CLIP\"}),\")\"]}),\"\\n\",e(r.p,{children:\"불필요한 코드 생략\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" CLIP\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 embed_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"                 # vision\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 image_resolution\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vision_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" Union\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"Tuple\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vision_width\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vision_patch_size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"                 # text\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 context_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vocab_size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 transformer_width\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 transformer_heads\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                 transformer_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" int\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"                 ):\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" isinstance\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"tuple\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" list\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            vision_heads \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" vision_width \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 32\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" //\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 64\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"            self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"visual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" ModifiedResNet\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                layers\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                output_dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embed_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                heads\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_heads\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                input_resolution\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image_resolution\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                width\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_width\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"            )\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        else\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            vision_heads \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" vision_width \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"//\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 64\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"            self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"visual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" VisionTransformer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                input_resolution\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image_resolution\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                patch_size\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_patch_size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                width\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_width\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                layers\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                heads\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_heads\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"                output_dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embed_dim\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"            )\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" Transformer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"            width\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer_width\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"            layers\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"            heads\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer_heads\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"            attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"build_attention_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            \"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" encode_image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"visual\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" encode_text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"token_embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#616E88\"},children:\"  # [batch_size, n_ctx, d_model]\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"positional_embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"permute\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#616E88\"},children:\"  # NLD -> LND\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transformer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"permute\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#616E88\"},children:\"  # LND -> NLD\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"ln_final\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # x.shape = [batch_size, n_ctx, transformer.width]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # take features from the eot embedding (eot_token is the highest number in each sequence)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"arange\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"argmax\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=-\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" @\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"text_projection\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            \"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        image_features\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"encode_image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        text_features\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"encode_text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"text\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # normalized features\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        image_features\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image_features \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"/\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image_features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" keepdim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        text_features\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text_features \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"/\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text_features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" keepdim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cosine similarity as logits\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        logit_scale\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"logit_scale\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"exp\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        logits_per_image\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logit_scale \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image_features \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"@\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text_features\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"t\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"        logits_per_text\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logits_per_image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"t\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # shape = [global_batch_size, global_batch_size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logits_per_image\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logits_per_text\"})]})]})})}),\"\\n\",e(r.p,{children:\"세부적인 ResNet, ViT, Transformer 의 스크래치 구현은 깃헙 CLIP/clip/model.py 참고 (굉장히 깔끔하게 잘 정리되어있고, scratch부터 구현된 코드를 보기에 좋은 듯!)\"}),\"\\n\",n(r.ol,{children:[\"\\n\",e(r.li,{children:\"Natural Language Supervision\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"(본문 내용) It’s much easier to scale natural language supervision compared to standard crowd-sourced labeling for image classification. (…중략) methods which work on natural language can learn passively from the supervision contained in the vast amount of text on the internet.\"}),\"\\n\",e(r.p,{children:\"GPT 학습에 필요한 대규모 데이터셋을 긁어모은 OpenAI 답게 엄청난 크롤링 능력을 보여줌.\"}),\"\\n\",n(r.ol,{children:[\"\\n\",n(r.li,{children:[\"\\n\",e(r.p,{children:\"50만개의 Query 설정 후 (image, text) pair 크롤링\"}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"\\n\",e(r.p,{children:\"각 Query마다 최대 2만개의 pair (클래스 분포 밸런스)\"}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"\\n\",e(r.p,{children:\"총 400M → GPT-2 학습에 쓰인 WebText dataset과 비슷한 총 단어 수\"}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"\\n\",e(r.p,{children:\"Training Method\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"(본문 내용) Given a batch of N (image, text) pairs, CLIP is trained to predict which of the N ×N possible (image, text) pairings across a batch actually occurred.\"}),\"\\n\",e(r.p,{children:\"Architecture에 소개된 것처럼 NxN matrix of image & text pair를 얻음. 여기서 Diagonal에 대해서만 positive, 나머지는 negative로 학습\"}),\"\\n\",e(r.p,{children:\"Q) False negative에 대해서는 어떻게 대응하는가?\"}),\"\\n\",e(r.p,{children:\"A) 충분한 데이터셋이 확보되면 저품질이더라도 학습에 지장 X (Weak-supervision의 진가)\"}),\"\\n\",e(r.p,{children:\"실험에서 확인해야 할 문제 → pre-training 과정에서 정말 zero-shot transfer 성능이 증가할 것인가? (GPT처럼)\"}),\"\\n\",e(r.h2,{children:\"4. 실험 및 결과\"}),\"\\n\",e(r.p,{children:\"본 논문은 매우 긴 분량으로 이루어져 있고, 대부분 실험 설계와 결과, 그리고 의의로 이루어짐. 따라서 각각의 실험들을 하나씩 살펴볼 것.\"}),\"\\n\",e(r.h3,{children:\"1) vs Visual N-Grams\"}),\"\\n\",n(r.p,{children:[e(r.img,{src:\"/study/paper-review/clip/2.png\",alt:\"\"}),\"\\nVisual N-Grams와 CLIP은 성능을 동등하게 비교할 수 없는 모델 (본문에서 언급). 다만 Zero-shot 성능에 있어서 얼마나 큰 발전을 이루었는지 보여주는 성능표.\"]}),\"\\n\",e(r.h3,{children:\"2) Image encoding을 위한 Prompt Engineering\"}),\"\\n\",e(r.p,{children:\"CLIP은 pre-training 과정에서 dataset의 text가 image에 대한 설명인 ‘구’ 혹은 ‘문장’으로 이루어짐(caption). 그러나 Evaluation dataset에서는 단순히 class에 대한 label로만 주어지는 경우가 있음. 이에 대해 굉장히 간단한 Prompt Engineering으로 성능 향상.\"}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"기본 템플릿: “A photo of a label” → ImageNet에서 1.3% 향상\"}),\"\\n\",e(r.li,{children:\"Oxford-IIIT Pets: “A photo of a label}, a type of pet.”\"}),\"\\n\",e(r.li,{children:\"ORC: 문자나 숫자에 quotes 추가 - ex) 1, a → “1”, “a”\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"이 외에도 다양한 context prompt를 통해 ImageNet에서 3.5% 향상을 보임 (해당 promt는 깃헙 CLIP/data/prompts.md에 정리되어 있음)\"}),\"\\n\",e(r.p,{children:\"Prompt 예시\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9\"},children:\"templates\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" [\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of a {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a blurry photo of a {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a black and white photo of a {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a low contrast photo of a {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a high contrast photo of a {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a bad photo of a {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a good photo of a {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of a small {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of a big {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of the {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a blurry photo of the {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a black and white photo of the {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a low contrast photo of the {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a high contrast photo of the {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a bad photo of the {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a good photo of the {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of the small {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of the big {}.\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"]\"})})]})})}),\"\\n\",e(r.p,{children:\"해당 프롬프트들을 앙상블 → 각각의 프롬프트 입력으로 얻은 embedding의 pooling 값\"}),\"\\n\",e(r.p,{children:\"Q) Inference time이 증가하지는 않는지?\"}),\"\\n\",e(r.p,{children:\"A) text encoder는 정답 레이블에 대해 미리 계산한 뒤, inferenced image embedding과의 similarity만 계산. 따라서 캐싱된 값을 사용하면 되므로 prompt template이 늘어난다고 inference 비용이 비례해서 늘지 않음!\"}),\"\\n\",e(r.h3,{children:\"3) Zero-Shot CLIP Performance\"}),\"\\n\",n(r.p,{children:[e(r.strong,{children:\"vs fully Supervised models\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/clip/3.png\",alt:\"\"})]}),\"\\n\",e(r.p,{children:\"꽤 많은 Dataset에서 fully supervised baseline을 웃돔.\"}),\"\\n\",e(r.p,{children:\"나쁜 성능을 보인 데이터셋들은 뭘까?\"}),\"\\n\",e(r.p,{children:\"→ (본문 내용) we see that zero-shot CLIP is quite weak on several specialized, complex, or abstract tasks such as satellite image classification (EuroSAT and RESISC45), lymph node tumor detection (PatchCamelyon), counting objects in synthetic scenes (CLEVRCounts), self-driving related tasks such as German traffic sign recognition (GTSRB), recognizing distance to the nearest car (KITTI Distance).\"}),\"\\n\",e(r.p,{children:\"매우 특수하거나 복잡한 이미지 인식에는 Transfer performance가 나쁘게 나타남\"}),\"\\n\",e(r.p,{children:\"다만 이런 예시는 사전학습에서 거의 마주치지 못한 class일 확률이 높으며, non-expert human 또한 zero-shot으로 해당 task를 수행할 때 보일 성과를 생각하면…\"}),\"\\n\",n(r.p,{children:[e(r.strong,{children:\"vs Few-shot models\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/clip/4.png\",alt:\"\"}),\"\\nLinear Probe CLIP은 LogisticRegression으로 학습 후 평가\"]}),\"\\n\",e(r.p,{children:\"놀라운 점은 CLIP의 4-shot까지는 Zero-shot이 높은 성능을 보임\"}),\"\\n\",e(r.p,{children:\"→ (본문 내용) Context-less example-based learning has the drawback that many different hypotheses can be consistent with the data, especially in the one-shot case.\"}),\"\\n\",e(r.p,{children:\"Q) 왜 그럴까?\"}),\"\\n\",e(r.p,{children:\"A)\"}),\"\\n\",n(r.ol,{children:[\"\\n\",e(r.li,{children:\"image는 text에 비해 매우 높은 variance을 보임. 같은 class여도 조명, 각도, 배경, 해상도, 스타일, 노이즈 등에 따라 완전히 다르게 보일 수 있음.\"}),\"\\n\",e(r.li,{children:\"text는 구조적이고 의미가 명확하게 표현됨.\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"→ 고양이에 대해 사진으로 제시하는 것과 단어로 제시하는 것의 명확성 차이.\"}),\"\\n\",e(r.p,{children:\"이미지의 시각적 특징을 충분히 학습할 수 있도록 많은 few-shot samples를 제공해야 함.\"}),\"\\n\",e(r.p,{children:\"Q) 그렇다면 image의 pixel이 늘어날수록 few-shot에 더 많은 샘플이 필요해질까?\"}),\"\\n\",e(r.p,{children:\"A) (by GPT)\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"네,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 맞습니다!\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"이미지의 픽셀(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"해상도\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\")이 늘어날수록, few-shot 학습에서 더 많은 샘플이 필요해지는 경향이 커집니다.\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"## 이유를 자세히 설명하면\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"### 1. **고차원 공간의 일반화 어려움**\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이미지의\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 해상도가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 높아질수록,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 각\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 샘플이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 가지는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 정보\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"특징\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"도\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 훨씬\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많아집니다.\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 예를\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 들어,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 32×32\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 픽셀\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이미지는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 1,024차원,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 224×224\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 픽셀\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이미지는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 50,176차원입니다.\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 고차원\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 공간에서는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 데이터가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 희박\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"sparse\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"해지고,\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"  클래스\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 경계를\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 잘\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 잡으려면\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많은\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 예시가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 필요합니다.\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"### 2. **시각적 다양성 증가**\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 해상도가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 높아지면,\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"  같은\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 클래스\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 내에서도\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 다양한\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 세부적인\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 특징\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"무늬,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 질감,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 배경\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 등\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 나타날\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 수\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 있습니다.\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 모델이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이런\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 세부적인\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 차이를\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 일반화하려면\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많은\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 샘플이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 필요합니다.\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"### 3. **오버피팅 위험 증가**\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 샘플\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 수가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 적은데\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 픽셀\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"특징\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 수가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많으면,\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"  모델이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 소수\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 샘플의\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 세부적인\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 특징에\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 과도하게\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 적합\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"overfit\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"될\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 위험이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 커집니다.\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이를\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 방지하려면\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많은\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 샘플로\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 클래스의\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 전체적인\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 특징을\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 학습해야\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 합니다.\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"## 실제로 어떻게 나타나는가?\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" **\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"해상도가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 높을수록\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 같은\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 클래스의\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 다양한\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 모습\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"포즈,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 배경,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 조명\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 등\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"을\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 포착할\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 수\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 있음\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 모델이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이런\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 다양성을\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 학습하려면\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많은\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 예시가\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 필요함\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" **\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"few-shot\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 학습에서\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 저해상도\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이미지\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"예:\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" MNIST,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" CIFAR-10\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 1~5장만으로도\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 어느\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 정도\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 일반화\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 가능\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 고해상도\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이미지\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"예:\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" ImageNet,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 의료\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 영상\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 등\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 10장\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이상,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 때로는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 수십~수백\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 장이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 필요할\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 수\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 있음\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"## 결론\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" **\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"이미지의\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 픽셀\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"해상도\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 늘어날수록,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" few-shot\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 학습에서\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 더\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 많은\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 샘플이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 필요해지는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 경향이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 커진다\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 것이\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 맞습니다.\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 이는\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 고차원\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 데이터의\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 일반화\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 어려움,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 시각적\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 다양성,\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 오버피팅\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 위험\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 등\"}),e(r.span,{style:{color:\"#A3BE8C\"},children:\" 때문입니다.\"})]})]})})}),\"\\n\",n(r.p,{children:[e(r.strong,{children:\"the # of samples to deal with zero-shot model\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/clip/5.png\",alt:\"\"})]}),\"\\n\",e(r.p,{children:\"각 데이터셋별 zero-shot 성능을 따라 잡기 위한 few-shot sample의 개수\"}),\"\\n\",e(r.p,{children:\"상위 4개 dataset에 대해 살펴보자\"}),\"\\n\",e(r.p,{children:\"FER2013: 표정 인식 → 사람마다 다른 표현 방식으로 인해 일관된 class representation 학습 불리\"}),\"\\n\",e(r.p,{children:\"CIFAR10: 저해상도 및 클래스 내 다양한 변이\"}),\"\\n\",e(r.p,{children:\"OxfordPets: 품종 비교에서 어려움을 겪었을 거라 유추\"}),\"\\n\",e(r.p,{children:\"Food101: 같은 음식이더라도 다른 조리법이나 각도에 따라 완전히 달라 보일 수 있음\"}),\"\\n\",e(r.p,{children:\"다만 데이터셋을 하나하나 자세히 확인해본 건 아니고… 이정도 특성만 있음을 확인함. 클래스 내에서 포착해야 하는 특징이 매우 많거나(FER2013), class 외 배경 정보가 많을 경우(Food101) few-shot이 불리하다고 판단.\"}),\"\\n\",n(r.p,{children:[e(r.strong,{children:\"A theoretical limit performance and the real performances\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/clip/6.png\",alt:\"\"}),\"\\n이론적 성능과 zero-shot의 비교\\n\",e(r.img,{src:\"/study/paper-review/clip/7.png\",alt:\"\"}),\"\\n모델 사이즈와 성능 비교 → 꾸준히 성능 상승. 더 큰 모델이 더 좋은 성능을 낼 수 있을 거란 기대\"]}),\"\\n\",e(r.h3,{children:\"4) Representation Learning\"}),\"\\n\",e(r.p,{children:\"저자들은 Representation learning capability보다는 task leaning capability가 중요하다고는 했지만, 어쨌거나 기존 평가 방식으로 확인하고자 함.\"}),\"\\n\",e(r.p,{children:\"실험 방법\"}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"각각의 model에서 classification space로 projection 제거\"}),\"\\n\",e(r.li,{children:\"scikit-learn’s L-BFGS implementation 사용\"}),\"\\n\",e(r.li,{children:\"각각의 dataset마다 적합한 metric 평가 (해당 부분은 아래 사진 첨부, 본문 부록 A에 존재)\"}),\"\\n\"]}),\"\\n\",n(r.p,{children:[e(r.strong,{children:\"Dataset and meta-information\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/clip/8.png\",alt:\"\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/clip/9.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:[\"해당 결과의 시각화 figure\\n\",e(r.img,{src:\"/study/paper-review/clip/10.png\",alt:\"\"})]}),\"\\n\",e(r.p,{children:\"Large parameter CLIP model이 우수한 embedding 능력을 보임!\"}),\"\\n\",e(r.p,{children:\"Q) Linear probe가 embedding 우수성을 체크하는 좋은 지표인가?\\nA) 만약 embedding이 매우 간단한 linear layer만으로도 좋은 성능을 낸다고 가정. 이는 임베딩이 여러 이미지 속에서 다양한 시각적/추상적 특징을 잘 담고 있으며, 특정 class만을 잘 인식하기보다 일반적인 embedding을 갖고있다고 볼 수 있음. 이는 다시 말해 해당 모델이 이미지 내에서 다양한 class를 대상으로 feature를 뽑아내는 능력이 뛰어나다고 볼 수 있음 → 높은 embedding representation!\"}),\"\\n\",e(r.h3,{children:\"5) Robustness to Natural Distribution Shift\"}),\"\\n\",e(r.p,{children:\"Introduction에서 줄기차게 설명해온 transfer capability에 대한 실험\"}),\"\\n\",e(r.p,{children:\"본문에서는 Robustness를 두 종류로 설명\"}),\"\\n\",n(r.ol,{children:[\"\\n\",e(r.li,{children:\"Relative Robustness: it captures any improvement in out-of-distribution accuracy.\"}),\"\\n\",e(r.li,{children:\"Effective Robustness: it measures improvements in accuracy under distribution shift above what is predicted by the documented relationship between in-distribution and out-of-distribution accuracy.\"}),\"\\n\"]}),\"\\n\",e(r.p,{children:\"당연히 둘 다 높아야 Robust한 모델이겠죠?\"}),\"\\n\",n(r.p,{children:[e(r.img,{src:\"/study/paper-review/clip/11.png\",alt:\"\"}),\"\\n다른 분포에서 더 높은 성능을 보여버리는 CLIP. ImageNet-R을 보면 ImageNet ResNet101은 약 40% 가량 감소한 성능이 CLIP은 되려 12%가 증가했다. 자연어로 이미지의 구조를 파악하는 능력이 일반화에 얼마나 강력한지 보여주는 예시. 애초에 GPT가 선례를 보여주기도 했고…\"]}),\"\\n\",n(r.p,{children:[e(r.img,{src:\"/study/paper-review/clip/12.png\",alt:\"\"}),\"\\nImageNet에 대해 학습할 경우 다른 dataset에 대한 robustness가 떨어지는 걸 볼 수 있음. 대신 zero-shot CLIP에 class name를 맞춰줄 경우 특정 데이터셋에서 높은 성능 향상.\"]}),\"\\n\",n(r.p,{children:[e(r.img,{src:\"/study/paper-review/clip/13.png\",alt:\"\"}),\"\\nZero-shot이 Few-shot 보다 훨씬 robust함.\"]}),\"\\n\",e(r.h3,{children:\"6) Comparison to Human Performance\"}),\"\\n\",e(r.p,{children:\"CLIP is better\"}),\"\\n\",e(r.h3,{children:\"7) Data overlap\"}),\"\\n\",e(r.p,{children:\"pre-training model 평가가 어려운 이유 중 하나로 eval dataset이 학습에 섞여 들어가는 일이 발생. 본 논문에서는 Overlap detector를 만들어서 Clean subset을 만들었고, 몇 dataset을 제외하면 허용할만한 범위에 존재하는 것으로 판단. 다만 CLIP 이후 만들어진 eval dataset으로 정밀한 평가 필요.\"}),\"\\n\",e(r.p,{children:\"(본문 내용) Creating a new benchmark of tasks designed explicitly to evaluate broad zero-shot transfer capabilities, rather than re-using existing supervised datasets, would help address these issues.\"}),\"\\n\",e(r.h3,{children:\"8) Bias\"}),\"\\n\",n(r.p,{children:[\"대규모 인터넷 데이터로 학습된 만큼 Sexual, Race, Job bias 존재\\n\",e(r.img,{src:\"/study/paper-review/clip/14.png\",alt:\"\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/clip/15.png\",alt:\"\"})]}),\"\\n\",e(r.p,{children:\"InstructionGPT처럼 효과적인 Intruction Tuning이 필요할 것.\"}),\"\\n\",e(r.h2,{children:\"5. 결론 (배운 점)\"}),\"\\n\",e(r.p,{children:\"대규모 자원을 동원해 나온 갖가지 Insight의 범람 덕에, 매우 긴 길이였음에도 상당히 재미있게 읽었다. 특히 실험 하나하나마다 연구 주제급.\"}),\"\\n\",e(r.p,{children:\"이 외에도 개인적으로 Speech-to-Text쪽 논문을 살펴보는데, CLIP과 유사하게 Whisper도 natural supervision dataset을 구축해 pre-training한 모델을 제시하고 다양한 실험 결과를 공유함. GPT-3도 그렇고 사실상 현재 AI 모델들의 토대를 전부 OpenAI가 만든 셈… 특히 본문 안에서도 ‘Representation learning capability’가 아닌 ‘Task learning capability’에 집중하고 ‘현실 세계에 의미 있는 AI model’을 만들고 싶다는 뚜렷한 목적이 보였다. 지금이야 Closed model로 바뀌었지만 지금까지의 결과만 해도 정말 OpenAI의 이름을 그대로 실천한 듯. 특히 25페이지 우측에 적힌 문단에 감동먹음.\"}),\"\\n\",n(r.ul,{children:[\"\\n\",e(r.li,{children:\"We hope that this work motivates future research on the characterization of the capabilities, shortcomings, and biases of such models, and we are excited to engage with the research community on such questions.\"}),\"\\n\"]}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"진짜 소감\"})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/study/paper-review/clip"
  },
  {
    "title": "Reading papers",
    "description": "Read papers about MT-DNN, MASS, UNILM, XLNet, RoBERTa, ALBERT.",
    "slug": "reading-papers",
    "publishDate": "2025-04-27",
    "thumbnailUrl": "/study/paper-review/reading-papers-1/thum.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:t}=arguments[0];function _createMdxContent(r){const i={a:\"a\",blockquote:\"blockquote\",hr:\"hr\",img:\"img\",p:\"p\",...r.components};return t(e,{children:[n(i.p,{children:\"During my previous studies, I examined research papers on various language models, including seq2seq, Transformer, and BERT (though I didn't write about BERT). My objective is gaining knowledge in the LLM field and also have an assignment requiring me to create a video presentation explaining the concepts I've learned in class to my peers. Previous posts are the result of the assignment. Therefore, this post will be too. :D\"}),\"\\n\",n(i.p,{children:\"This post covers MT-DNN, MASS, UNILM, XLNet, RoBERTa and ALBERT. I won't describe the details of each model, but rather focus on the fundamental concepts (due to my schedule :p).\"}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1901.11504\",children:\"MT-DNN\"}),\" (Multi-Task Deep Neural Networks for natural language understanding)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/1.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract, there is a key purpose of MT-DNN.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"MT-DNN not only leverages large amounts of cross-task data, but also benefits from a regularization effect that leads to more general representations to help adapt to new tasks and domains.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"And in the introduction, they explain the motivation behind MT-DNN, which is the basic principle of transfer learning.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Multi-Task Learning (MTL) is inspired by human learning activities where people often apply the knowledge learned from previous tasks to help learn a new task (Caruana, 1997; Zhang and Yang, 2017). For example, it is easier for a person who knows how to ski to learn skating than the one who does not.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They propose a diverse range of tasks to train the model:\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/2.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"However, I think the intricate details of these tasks are not essential for my current understanding. At this point, I'm focused on grasping the fundamental concepts rather than delving too deeply into the specifics.\"}),\"\\n\",t(i.p,{children:[\"The benchmark is following:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/3.png\",alt:\"\"})]}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1905.02450\",children:\"MASS\"}),\" (MAsked Sequence to Sequence learning)\"]}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"its encoder takes a sentence with randomly masked fragment (several consecutive tokens) as input, and its decoder tries to predict this masked fragment. In this way, MASS can jointly train the encoder and decoder to develop the capability of representation extraction and language modeling. In this paper, inspired by BERT, we propose a novel objective for pre-training: MAsked Sequence to Sequence learning (MASS) for language generation.\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"What does that mean? See the figure below:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/4.png\",alt:\"\"})]}),\"\\n\",n(i.p,{children:\"MASS masks continuous sequences of tokens within the source sentence. Subsequently, the decoder predicts these masked tokens, generating the output seqeuntially, one token at a time.\"}),\"\\n\",t(i.p,{children:[\"This provides a detailed mathematical formulation representing the loss function derived from the log-likelihood function:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/5.png\",alt:\"\"})]}),\"\\n\",t(i.p,{children:[\"Researchers assert that, under specific constraint condtions, MASS can effectively function as both BERT and GPT architectures.\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/6.png\",alt:\"\"})]}),\"\\n\",n(i.p,{children:\"However, MASS is the encoder-decoder framework to generate tokens and there is a cross-attention between the encoder and decoder. It is the fundamental difference from BERT (which is a single encoder architecture) and GPT (which is a single decoder architecture).\"}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1905.03197\",children:\"UNILM\"}),\" (UNIfied Language Model pre-training for natural language understanding and generation)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/7.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"The authors describe UNILM's foundational architecture as a 'multi-layer Transformer network'.\"}),\"\\n\",n(i.p,{children:\"However, upon examination of Figure 1, it appears identical to the encoder layer of a standard Transformer. (In fact, its architecture is precisely that of BERT Large.)\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/8.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"They implement a strategy that emulates language modeling techniques through the strategic manipulation of self-attention masks.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Specifically, within one training batch, 1/3 of the time we use the bidirectional LM objective, 1/3 of the time we employ the sequence-to-sequence LM objective, and both left-to-right and right-to-left LM objectives are sampled with rate of 1/6.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1906.08237\",children:\"XLNet\"}),\" (XLNet: Generalized Autoregressive Pretraining for Language Understanding)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/9.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"The name 'XLNet does not appear explicitly in the paper's title. However, the authors clarify the origin of this designation in the abstract.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"XLNet integrates ideas from Transformer-XL, the state-of-the-art autoregressive model, into pretraining.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"The nomenclature derives from their inspiration by Transformer-XL\"}),\"\\n\",n(i.p,{children:\"What are the distinctive characteristics of this approach?\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"we propose XLNet, a generalized autoregressive pretraining method that (1) enables learning bidirectional contexts by maximizing the expected likelihood over all permutations of the factorization order and (2) overcomes the limitations of BERT thanks to its autoregressive formulation.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They propose an enhanced pre-training methodology that leverages permutations of token order. How exactly does this mechanism function?\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/10.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"(a) shows the normal self-attention mechanism, and (b) shows the permutation self-attention what the researchers claim.\"}),\"\\n\",n(i.p,{children:\"For instance, consider the sentence 'New York is a city' which would be masked as '[Mask] [Mask] is a city' in traditional pre-training. BERT's approach involves predicting 'New' and 'York' independently, calculating p(New | is a city) and p(York | is a city) separately. In contrast, XLNet employs a sequential prediction method: first calculating p(New | is a city), then p(York | New, is a city), thereby effectively capturing the relationship between 'New' and 'York'.\\\"\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/12.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"For those familiar with the inherent limitations of transformer architectures, particularly their substantial computational overhead, it comes as no surprise that XLNet inherits these same challenges. The authors were acutely aware of this computational burden.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"While the permutation language modeling objective (3) has several benefits, it is a much more challenging optimization problem due to the permutation and causes slow convergence in preliminary experiments. To reduce the optimization difficulty, we choose to only predict the last tokens in a factorization order.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/11.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"To mitigate this issue, they strategically implemented the permutation method on only a subset of the sequence, rather than applying it exhaustively.\"}),\"\\n\",n(i.hr,{}),\"\\n\",n(i.p,{children:n(i.a,{href:\"https://arxiv.org/abs/1907.11692\",children:\"RoBERTa\"})}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/13.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"hyperparameter choices have significant impact on the final results. We present a replication study of BERT pretraining (Devlin et al., 2019) that carefully measures the impact of many key hyperparameters and training data size.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"So... the RoBERTa paper represents the better hyperparameter optimization. Our professor emphasized that despite its seemingly straightforward tuning methodology, this research emerged during a period saturated with numerous approaches and architectural innovations aimed at enhancing LLM performance. I concur with this assessment, as my review of several related papers reveals a predominant focus on architectural innovations.\"}),\"\\n\",n(i.p,{children:\"From this perspective, the authors assert the following:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We find that BERT was significantly undertrained, and can match or exceed the performance of every model published after it.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They also implement an masking strategy called dynamic masking, which randomly masks tokens throughout the training process rather than consistently masking identical token positions.\"}),\"\\n\",n(i.p,{children:\"Intuitively, as most would likely concur, dynamic masking appears inherently more effective than static masking approaches. However, the empirical results indicate:\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/14.png\",alt:\"\"})}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We find that our reimplementation with static masking performs similar to the original BERT model, and dynamic masking is comparable or slightly better than static masking.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\":D\"}),\"\\n\",n(i.p,{children:\"The followings are all approaches:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Specifically, RoBERTa is trained with\\ndynamic masking (Section 4.1)\\nFULL-SENTENCES without NSP loss (Section 4.2)\\nlarge mini-batches (Section 4.3)\\na larger byte-level BPE (Section 4.4)\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/15.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"And they assert that BPE has advantages although it doesn't show a better performance.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Early experiments revealed only slight differences between these encodings, with the Radford et al. (2019) BPE achieving slightly worse end-task performance on some tasks. Nevertheless, we believe the advantages of a universal encoding scheme outweighs the minor degredation in performance and use this encoding in the remainder of our experiments. A more detailed comparison of these encodings is left to future work.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{}),\"\\n\",n(i.p,{children:n(i.a,{href:\"https://arxiv.org/abs/1909.11942\",children:\"ALBERT\"})}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/16.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"we present two parameter reduction techniques to lower memory consumption and increase the training speed of BERT (Devlin et al., 2019). Comprehensive empirical evidence shows that our proposed methods lead to models that scale much better compared to the original BERT.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"I'll just introduce the methodologies of ALBERT brifely.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"The first one is a factorized embedding parameterization. By decomposing the large vocabulary embedding matrix into two small matrices, we separate the size of the hidden layers from the size of vocabulary embedding.\"}),\"\\n\"]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"The second technique is cross-layer parameter sharing. This technique prevents the parameter from growing with the depth of the network.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"These approaches yield efficiency gains:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"An ALBERT configuration similar to BERT-large has 18x fewer parameters and can be trained about 1.7x faster.\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"The first one:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/18.png\",alt:\"\"})]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Therefore, for ALBERT we use a factorization of the embedding parameters, decomposing them into two smaller matrices. Instead of projecting the one-hot vectors directly into the hidden space of size H, we first project them into a lower dimensional embedding space of size E, and then project it to the hidden space. By using this decomposition, we reduce the embedding parameters from O(V × H) to O(V × E + E × H).\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"The second:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/17.png\",alt:\"\"})]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We observe that the transitions from layer to layer are much smoother for ALBERT than for BERT. These results show that weight-sharing has an effect on stabilizing network parameters. Although there is a drop for both metrics compared to BERT, they nevertheless do not converge to 0 even after 24 layers. This shows that the solution space for ALBERT parameters is very different from the one found by DQE. Although there is a drop for both metrics compared to BERT, they nevertheless do not converge to 0 even after 24 layers. This shows that the solution space for ALBERT parameters is very different from the one found by DQE.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?n(t,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/reading-papers"
  },
  {
    "title": "최근 읽은 논문들 간단 정리",
    "description": "transformer-xl, wav2letter, wav2vec",
    "slug": "simple-summaries-1",
    "publishDate": "2025-06-30",
    "thumbnailUrl": "/study/paper-review/simple-summaries-1/thm.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:t}=arguments[0];function _createMdxContent(i){const r={code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",ul:\"ul\",...i.components};return t(e,{children:[n(r.p,{children:\"이래 저래 여러 논문과 블로그를 보는데... 끝이 없다. 그리고 논문 리뷰를 블로그에 열심히 작성하는 것도 뭔가 애매한 듯하고. 약간 개발 블로그처럼, 모두가 논문 리뷰를 하지만 거기에 본인만의 특색이 있는 글은 많지 않다. 심지어 어떤 글들은 인터넷에 있는 정보를 그대로 가져다 붙인 수준이기도 하고.\"}),\"\\n\",n(r.p,{children:\"차라리 읽은 논문 중 얻은 인사이트를 가볍게 뽑아서 정리하는 게 훨씬 좋을 듯하다고 느꼈다. 어차피 요약이나 의의 등은 나보다 AI가 잘 해주니까. 그래서 그냥 최근에 읽은 것들에 대해 간단한 요약을 적고, 나름대로 영어 공부 겸 AI의 정리를 옮겨 적으며 다시금 되짚는 용도로 글을 써볼 생각!\"}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"Transformer-XL\"}),\"\\n\",n(r.p,{children:\"XL means extra-large. Transformer-XL can handle a long context window. The main idea is similar to an RNN. It separates a long context into segments and uses the hidden state of each segment to retain information from previous segments.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/simple-summaries-1/1.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"Therefore, it adopts a relative positional encoding.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/simple-summaries-1/2.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"I didn't understand why the 3 terms are added to calculate the attention score. Here's an explanation of each term.\"}),\"\\n\",t(r.ol,{children:[\"\\n\",n(r.li,{children:\"Content score: Q * K^T - A simple attention score\"}),\"\\n\",n(r.li,{children:\"Position score: Q * R^T - An inner product of query and relative positional embedding\"}),\"\\n\",n(r.li,{children:\"Content bias = U * K^T\"}),\"\\n\",n(r.li,{children:\"Positional bias = V * R^T\"}),\"\\n\"]}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"Bias terms adjust the important score. But... they're just bias terms to improve better performance.\"}),\"\\n\"]}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"Wav2Letter\"}),\"\\n\",n(r.p,{children:\"Wav2letter is designed as a simple end-to-end system for speech recognition, directly converting a speech signal into a text transcription. A key feature is that its acoustic model is trained directly using letters (graphemes). This breaks away from the classical pipeline.\"}),\"\\n\",n(r.h3,{children:\"Architecture\"}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"The system is built around a standard 1D convolutional neural network (ConvNet) for acoustic modeling.\"}),\"\\n\",n(r.li,{children:\"It uses striding convolutions instead of pooling layers to allow the network to perceive a larger context without increasing the number of parameters.\"}),\"\\n\",n(r.li,{children:\"The architecture for processing raw audio, as illustrated in the paper, involves a series of convolutional layers with specific kernel sizes and strides.\"}),\"\\n\",n(r.li,{children:\"The final layer of the convolutional network outputs a score for each letter in the predefined dictionary. The overall stride of the network is 320, generating a label every 20 milliseconds.\"}),\"\\n\"]}),\"\\n\",n(r.p,{children:\"I don't discuss its architecture in detail, but just highlight the significance of this research.\"}),\"\\n\",t(r.ol,{children:[\"\\n\",n(r.li,{children:\"End-to-End architecture\"}),\"\\n\"]}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"it directly converts a speech signal into a text transcription. This approach eliminates the need for intermediate phonetic transcriptions or forced alignment of phonemes. It generates a grapheme output directly.\"}),\"\\n\"]}),\"\\n\",t(r.ol,{start:\"2\",children:[\"\\n\",n(r.li,{children:\"Introduction of automatic segmentation criterion (ASG)\"}),\"\\n\"]}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"ASG is a simpler sequence criterion that trains models from sequence annotation without requiring alignment. It has few differences from CTC(Connected Temporal Classification). The most key point is a transition probability. It occurs between letters.\"}),\"\\n\"]}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"Wav2Vec\"}),\"\\n\",n(r.p,{children:\"It applies unsupervised pre-training to learn robust representations from unlabeled audio, which are much easier to collect thana labeled data.\"}),\"\\n\",n(r.h3,{children:\"Architecture\"}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"A multi-layer convolutional neural network (ConvNet) that takes raw audio as input.\"}),\"\\n\",t(r.li,{children:[\"It consists of two main stacked networks. Encoder Network \",n(r.code,{children:\"f\"}),\" and Context Network \",n(r.code,{children:\"g\"}),\". f embeds the raw audio signal into a low-frequency feature representation \",n(r.code,{children:\"z\"}),\". g takes multiple time-steps of the encoder's output \",n(r.code,{children:\"z_i...z_i-v\"}),\" and combines them into a single contextualized tensor \",n(r.code,{children:\"c_i\"})]}),\"\\n\"]}),\"\\n\",n(r.h3,{children:\"Objective\"}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"To distinguish a sample z_i+k that is k stpes in the future from distractor samples z tilda drawn from a proposal distribution p_n, by minimizing the contrastive loss for each step k = 1, ..., K\"}),\"\\n\"]}),\"\\n\",n(r.p,{children:\"It is trained by discrimanating the correct sample among distractor samples.\"}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"VQ-Wav2Vec\"}),\"\\n\",n(r.p,{children:\"VQ means vector quantizing. It makes a discrete data to use NLP.\"}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"wav2vec 2.0\"}),\"\\n\",n(r.p,{children:\"It is the successor to wav2vec and VQ-wav2vec. wav2vec 2.0 uses self-supervised contrastive learning and discrete representations.\"}),\"\\n\",n(r.p,{children:\"One thing I would like to discuss is the contrastive loss used in this paper.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/simple-summaries-1/2.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"A latent representation is fed to two layers: a context layer and a quantization layer.\"}),\"\\n\",n(r.p,{children:\"c_t is the masked output of the context layer and q_t is the quantized output of the quantizing layer. The loss calculates the similarity between c_t and q_t so that context representation is close to q_t and far from the negative samples, q_t tilda.\"}),\"\\n\",n(r.hr,{})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?n(t,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/simple-summaries-1"
  },
  {
    "title": "Let's learn seq2seq!",
    "description": "Learn how to use seq2seq models using PyTorch",
    "slug": "tutorial-seq2seq",
    "publishDate": "2025-04-12",
    "thumbnailUrl": "/study/paper-review/tutorial-seq2seq/thum.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",code:\"code\",hr:\"hr\",img:\"img\",p:\"p\",pre:\"pre\",span:\"span\",...s.components};return n(l,{children:[e(r.p,{children:\"Recently, I've been studying large language models(LLMs). I understand the algorithms behind what they are and how they work, but I don't have a precise understanding of their implementation.\"}),\"\\n\",e(r.p,{children:\"I'm still pondering the necessity of understanding the basics of LLMs, such as implementation details, architecture, and so on. Since there is so much to learn in the field of LLMs, It's impossible to study everything in depth. However, as an undergraduate student without any immediate obligation to apply them for quick results, I plan to take my time and study step by step - starting with seq2seq, transformer, and other language models.\"}),\"\\n\",n(r.p,{children:[\"This post focuses on the seq2seq model. For learning purposes, I referred to \",e(r.a,{href:\"https://github.com/bentrevett/pytorch-seq2seq\",children:\"seq2seq tutorial link\"}),\".\"]}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"LSTM is more advanced type of RNN that can retain long-term information better than the original RNN. Unlike RNNs, which only have a hidden state, LSTMs include a cell state - a vector that stores information about the previous state of the LSTM cell.\"}),\"\\n\",e(r.p,{children:\"Leveraging LSTMs, many researchers have developed various techniques for translating one language to another.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/rnn1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"This is the original RNN architecture. The gray boxes represent cells, which take an input and produce an output, a hidden state, and a cell state.\\nThe mathematical expression is as follows:\"}),\"\\n\",e(r.p,{children:\"(h_t, c_t) = LSTM(e(x_t), h_t-1, c_t-1)\"}),\"\\n\",e(r.p,{children:\"However, the architecture above has a limitation: the dimensions of the inputs and outputs are fixed and identical. This poses a significant challenge for translation tasks, as most languages vary in length when expressing the same meaning.\"}),\"\\n\",n(r.p,{children:[e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/lstm1.png\",alt:\"\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/lstm2.png\",alt:\"\"})]}),\"\\n\",e(r.p,{children:\"But this paper separates LSTM to two parts: encoder and decoder. Encoder LSTM takes the input sequence and produces a context vector, which has a information about the input sequence. Decoder LSTM takes the context vector and produces output one token at a time.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/seq2seq1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"the code implementing the paper is as follows (be cautious about the dimensions):\"}),\"\\n\",e(r.p,{children:\"Encoder\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" Encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" input_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"input_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"rnn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LSTM\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # src = [src length, batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        embedded \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # embedded = [src length, batch size, embedding dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"rnn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedded\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # outputs = [src length, batch size, hidden dim * n directions]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # outputs are always from the top hidden layer\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"})]})]})})}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"outputs, (hidden, cell) = self.rnn(embedded)\"}),\" represents an input and an output of LSTM structure.\"]}),\"\\n\",e(r.p,{children:\"Decoder\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" Decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" output_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"rnn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LSTM\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"fc_out \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # input = [batch size]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # n directions in the decoder will both always be 1, therefore:\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # context = [n layers, batch size, hidden dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        input\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"unsqueeze\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # input = [1, batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        embedded \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # embedded = [1, batch size, embedding dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"rnn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedded\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # output = [seq length, batch size, hidden dim * n directions]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # seq length and n directions will always be 1 in this decoder, therefore:\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # output = [1, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers, batch size, hidden dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        prediction \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"fc_out\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"squeeze\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # prediction = [batch size, output dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" prediction\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"})]})]})})}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"output, (hidden, cell) = self.rnn(embedded, (hidden, cell))\"}),\" is similar to the one of encoder.\"]}),\"\\n\",e(r.p,{children:\"Model\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" Seq2Seq\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"encoder \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" encoder\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"decoder \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" device\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        assert\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"        ),\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Hidden dimensions of encoder and decoder must be equal!\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        assert\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"        ),\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Encoder and decoder must have equal number of layers!\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" teacher_forcing_ratio\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # src = [src length, batch size]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # trg = [trg length, batch size]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # teacher_forcing_ratio is probability to use teacher forcing\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # e.g. if teacher_forcing_ratio is 0.75 we use ground-truth inputs 75% of the time\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        batch_size \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        trg_length \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        trg_vocab_size \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # tensor to store decoder outputs\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"zeros\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"trg_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" batch_size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg_vocab_size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"to\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # last hidden state of the encoder is used as the initial hidden state of the decoder\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # first input to the decoder is the <sos> tokens\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        input\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" :]\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # input = [batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" t \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" range\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # insert input token embedding, previous hidden and previous cell states\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # receive output tensor (predictions) and new hidden and cell states\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # output = [batch size, output dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # cell = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # place predictions in a tensor holding predictions for each token\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            outputs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"t\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # decide if we are going to use teacher forcing or not\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            teacher_force \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" random\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"random\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" <\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" teacher_forcing_ratio\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # get the highest predicted token from our predictions\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            top1 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"argmax\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # if teacher forcing, use actual next token as next input\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # if not, use predicted token\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"            input\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"t\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" teacher_force \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"else\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" top1\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # input = [batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" outputs\"})]})]})})}),\"\\n\",e(r.p,{children:\"I would recommend you to read minutely about the flow of the code, if you are begginer of Neural Network and Language model.\"}),\"\\n\",e(r.hr,{})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/study/paper-review/tutorial-seq2seq"
  },
  {
    "title": "ViT and MLP-Mixer",
    "description": "What is inductive bias? Then, what is the key difference between ViT and CNN?",
    "slug": "vit-mlpmixer",
    "publishDate": "2025-05-02",
    "thumbnailUrl": "/study/paper-review/vit-mlpmixer/2.png",
    "content": "const{Fragment:e,jsx:i,jsxs:t}=arguments[0];function _createMdxContent(n){const r={a:\"a\",blockquote:\"blockquote\",code:\"code\",hr:\"hr\",img:\"img\",p:\"p\",...n.components};return t(e,{children:[i(r.p,{children:\"NLP를 공부하던 중, Vision에 대해 알아보게 된 배경을 짧막하게 한글로 작성하겠습니다!\"}),\"\\n\",i(r.p,{children:\"NLP를 다루던 중 갑자기 ViT인가 싶을텐데요. 실은 이번 주에 가졌던 커피챗에서 ViT와 CNN의 차이가 뭔지에 대한 질문을 받았습니다. 눈 앞에 놓인 목적만을 최대한 잘 완수하기 위해 Vision field를 완전히 배제하다보니 image processing을 모른 채 답변을 했습니다.\"}),\"\\n\",t(r.p,{children:[\"처음에는 \",i(r.code,{children:\"CNN은 filter size로 제한된 convolution 연산을 하고, ViT는 transformer 구조로 입력값의 관계를 전부 계산한다. 그러므로 context window 크기가 근본적인 차이다.\"}),\" 라고 말했습니다. (물론 이렇게 깔끔하게 이야기하기보다 벙벙 돌려가며 이야기했습니다.)\"]}),\"\\n\",t(r.p,{children:[\"그러자 2차 질문으로 \",i(r.code,{children:\"그렇다면 transformer input context size를 인위적으로 제한해 CNN과 동일하게 만든다면 어떻게 될까요? 다시 말해 context size가 동일한 상황이라면 ViT와 CNN은 무슨 차이일까요?\"}),\" 가 돌아왔습니다. 질문을 주신 분이 느긋하게 화장실까지 다녀오시는 동안 머리가 깨져라 생각했는데요. Convolution 연산 방식이 어떻게 이루어지는지만 알고 있을 뿐, 실제로 응용 이론이나 CNN만의 특징은 모르는 상태였습니다. 그러나 질문자분은 제가 ViT를 모른다는 걸 알고 계시기에 오히려 의도 파악을 하고 transformer의 근본적인 구조를 고민했습니다.\"]}),\"\\n\",i(r.p,{children:\"처음에는 당연히 Query, Key, Value라는 attention operation을 떠올렸습니다. convolution operation은 filter의 입력으로 들어온 값들의 relationship을 계산하도록 설계된 게 아니므로 이 차이인가 싶었는데, 실은 동일한 context size에서 deep neural network를 통해 학습하다보면 Transformer만큼은 아니더라도 당연히 filter size 안의 관계성이 parameter들에 담길 것이라 생각했습니다. 그렇다면 어느정도는 Q, K, V를 흉내내는 거나 다름 없으므로 근본적 차이는 아니라 생각했습니다. (실제로 아래 내용에서 후술될 inductive bias 관점에서 locality가 그러한 관계성을 보입니다.) 그러나 Cross-attention이라고 하기엔... 애초에 Encoder, Decoder 구조라는 다른 차원의 이야기를 꺼내오는 거라 이 또한 설득력이 낮다고 생각했습니다.\"}),\"\\n\",t(r.p,{children:[\"위와 같은 생각의 흐름을 쭉 전달드리고서 결국 \",i(r.code,{children:\"잘 모르겠다.\"}),\"라고 말씀드렸습니다. 그러자 여기에는 정답이 없지만, 그럼에도 근본적인 차이는 \",i(r.code,{children:\"Multi-head attention\"}),\"이라 생각한다는 말에 '아차' 싶었습니다. Transformer 구조에서 head의 개수가 늘어날수록 다양한 특징을 학습해 표현력이 높아지고, 또 해석 가능한 AI를 연구하시는 분들도 각각의 Head가 가진 latent representation이 뭔지 탐색한다는 어딘가 박혀있던 기억들이 새록새록 떠올랐습니다. Convolution 연산은 대상이 image든 natural language든 대상이 가진 잠재적 특성을 '다양하게' 고려하지 않습니다. 그저 하나의 값으로 표현할 뿐이죠.\"]}),\"\\n\",i(r.p,{children:\"이 물음에 대해서 ViT와 MLP-Mixer를 공부했더라도 답변하지 못했던 건 매 한가지였을 겁니다. 왜냐하면 두 논문에서도 주요하게 다뤄지는 건 Context size와 이로 인해 생기는 inductive bias의 차이니까요. 오히려 context size 관점에서 벗어나지 못해 더 엉뚱한 이야기를 했을지도 모릅니다. 그러나 MLP-Mixer가 가져다주는 통찰도 있습니다. 바로 inductive bias든 multi-head attention이든 두 대상이 잠재적인 특성을 다룬다는 겁니다.\"}),\"\\n\",i(r.p,{children:\"이와 같은 implicit한 의미들을 신경망 구조에서 어떻게 이끌어낼 수 있을까요? 수학적 논리력도 중요하겠지만, 무엇보다도 언어와 인간의 지각 처리 과정에 대한 깊은 이해, 그리고 탁월한 직관력이지 않을까 생각해봅니다. 알면 알수록 참 재미있는 세계인 듯해요!\"}),\"\\n\",i(r.hr,{}),\"\\n\",t(r.p,{children:[\"Before diving into this topic, I'd like to highlight an exceptional \",i(r.a,{href:\"https://www.youtube.com/watch?v=Y-isY31Thkw\",children:\"YouTube Video\"}),\" that brilliantly illustrates the concepts of image processing and what is 'inductive bias'.\"]}),\"\\n\",t(r.p,{children:[\"Initially, I'll examine the groundbreaking \",i(r.a,{href:\"https://arxiv.org/pdf/2010.11929.pdf\",children:\"Vit Paper\"}),\".\"]}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/1.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"In abstract,\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"When pre-trained on large amounts of data and transferred to multiple mid-sized or small image recognition benchmarks (ImageNet, CIFAR-100, VTAB, etc.), Vision Transformer (ViT) attains excellent results compared to state-of-the-art convolutional networks while requiring substantially fewer computational resources to train.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"A critical factor in this approach is the necessity for training on extensive datasets. Due to the nature of inductive bias, transformer architectures require substantial amounts of data to achieve optimal performance.\"}),\"\\n\",i(r.p,{children:\"Following the transformer's remarkable success in NLP, numerous attempts have been made to adapt this architecture to the image processing domain.\"}),\"\\n\",i(r.p,{children:\"However, these initial efforts yielded disappointing results that fell short of expectations. The researchers of ViT attributed this underperformance to a fundamental architectural difference:\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"Transformers lack some of the inductive biases inherent to CNNs, such as translation equivariance and locality, and therefore do not generalize well when trained on insufficient amounts of data.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"This analysis led to a pivotal breakthrough in their research:\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"We find that large scale training trumps inductive bias.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"So, what does this actually imply? what precisely is 'inductive bias', and why is a substantial volume of data necessary?\"}),\"\\n\",i(r.p,{children:\"Before exploring these questions, let's first understand the ViT architecture.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/2.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"ViT requires the input to be divided into fixed-size segments, known as PxP patches.\"}),\"\\n\",i(r.p,{children:\"The original image dimensions are represented as (H, W, C), corresponding to Height, Width, and Channel respectively. The N patches each have dimensions of (P, P, C), where N = H*W/P^2\"}),\"\\n\",i(r.p,{children:\"After splitting the image into the patches:\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"The Transformer uses constant latent vector size D through all of its layers, so we flatten the patches and map to Ddimensions with a trainable linear projection (Eq. 1). We refer to the output of this projection as the patch embeddings.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/3.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"In equation (1), xE represents the embedding vector that serves as input for the self-attention operation. Furthermore, the subsequent equations elucidate the operation performed by the architecture, as illustrated in Figure 1.\"}),\"\\n\",i(r.p,{children:\"For those already familiar with 'self-attention' mechanisms, the fundamental distinction between CNN and ViT becomes evident: context scope. While ViT computes relationships across all patches simultaneously during self-attention, CNNs only process interactions between adjacent patches during convolution. This distinction represents the essence of inductive bias.\"}),\"\\n\",i(r.p,{children:\"Inductive bias refers to the inherent predispositions or assumptions within a model that facilitate generalization, thereby enhancing performance. How does this mechanism function? In machine learning contexts, the objective is to identify a predictor that minimizes loss. Throughout this optimization process, inductive bias serves a vital function in mitigating overfitting. Calibrating an appropriate degree of inductive bias is crucial, as suboptimal values can either lead to overfitting or compromise overall performance.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/4.png\",alt:\"\"})}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"In CNNs, locality, two-dimensional neighborhood structure, and translation equivariance are baked into each layer throughout the whole model. In ViT, only MLP layers are local and translationally equivariant, while the self-attention layers are global.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"The authors explain that CNNs inherently possess locality and translation inductive biases, while ViT lacks these specific predispositions. At this point, this distinction prompts a crucial question: Is transformer completely devoid of inductive bias?\"}),\"\\n\",i(r.p,{children:\"Well, I explained inductive bias as 'predispositions or assumptions within a model'. It means that inductive bias enhance a model's predictive capabilities when confronted with novel scenarios-situations the model hasn't encountered during its training phase. Following this rationale, both CNNs and transformers inherently possess inductive biases, although the former has structural inductive bias, while the latter has global inductive bias.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/5.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"Structural inductive bias can be effectively learned from comparatively smaller datasets than those required for global inductive bias. This distinction is intuitively comprehensible: establishing meaningful correlations across all input elements and identifying appropriate patterns for model generalization presents a substantially more complex challenge.\"}),\"\\n\",i(r.p,{children:\"MLP-Mixer effectively exemplifies this intuition through its linear computational complexity processes: Token-mixing MLP and Channel-mixing MLP.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/6.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"This architecture represents not merely a novel approach that is considerably more streamlined than either ViT or CNNs, but also an evolutionary synthesis derived from both CNNs and transformers. The authors characterize MLP-Mixer as an expanded conceptualization of CNNs.\"}),\"\\n\",i(r.p,{children:\"Through this architectural attempt, the presence of inductive bias becomes evident, enabling us to understand its attributes.\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"we would like to understand the inductive biases hidden in these various features and eventually their role in generalization\"}),\"\\n\"]}),\"\\n\",i(r.hr,{}),\"\\n\",i(r.p,{children:\"Reference\"}),\"\\n\",t(r.p,{children:[\"Paper Review MLP-Mixer: An all-MLP Architecture for Vision - \",i(r.a,{href:\"https://www.youtube.com/watch?v=Y-isY31Thkw\",children:\"https://www.youtube.com/watch?v=Y-isY31Thkw\"}),\"\\nViT Paper: \",i(r.a,{href:\"https://arxiv.org/pdf/2010.11929.pdf\",children:\"https://arxiv.org/pdf/2010.11929.pdf\"}),\"\\nMLP-Mixer Paper: \",i(r.a,{href:\"https://arxiv.org/abs/2105.01601\",children:\"https://arxiv.org/abs/2105.01601\"})]}),\"\\n\",i(r.hr,{})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?i(t,{...e,children:i(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/vit-mlpmixer"
  }
]