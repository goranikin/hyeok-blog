[
  {
    "title": "Attention is all you need",
    "description": "Deep dive into the Transformer architecture, especially the implementation in each layers.",
    "slug": "attention-is-all-you-need",
    "publishDate": "2025-04-13",
    "thumbnailUrl": "/study/paper-review/attention-is-all-you-need/thum.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",code:\"code\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",...s.components};return n(l,{children:[n(r.p,{children:[\"In this post, I will explain the \",e(r.a,{href:\"https://arxiv.org/abs/1706.03762\",children:\"transformer\"}),\" architecture and its implementation at the code level. I referred to a \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"scratch\"}),\" implementation for the PyTorch code!\"]}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"The authors of the paper all left Google and founded their own companies, except for Lukasz Kaiser, who joined OpenAI. Five out of the 7 companies have become unicorns, with a combined valuation exceeding $17 billion. It's quite impressive.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/2.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"This is Figure 1 from the paper. It illustrates the overall architecture of the Transformer.\"}),\"\\n\",e(r.p,{children:\"They designed the operation, called Scaled Dot-Product Attention, which calculates the attention scores between query and key vectors to reflect the context information between the tokens.\"}),\"\\n\",e(r.p,{children:\"They represented the formula like this.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/3.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"How can we implement Scaled Dot-Product Attention in PyTorch? Let's start from scratch.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" ScaledDotProductAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" temperature\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" attn_dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"temperature \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" temperature\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn_dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # q = [batch_size, n_head, len_q, d_k]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # k = [batch_size, n_head, len_k, d_k]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # v = [batch_size, n_head, len_k, d_v]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"matmul\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"/\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"temperature\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 3\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"is\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" not\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"masked_fill\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" -\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e9\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"F\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"softmax\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dim\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=-\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"matmul\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"The original method uses the square root of \",e(r.code,{children:\"d_model\"}),\" for normalization, but this approach uses a learnable temperature parameter during training. A higher temperature value results in a more uniform attention distribution.\"]}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"attn\"}),\" has a shape \",e(r.code,{children:\"[batch_size, n_head, len_q, len_k]\"}),\", which represents the attention scores between query and key vectors. For example, \",e(r.code,{children:\"a[:,:,1,2]\"}),\" is the attention score between the first query vector and the second key vector.\"]}),\"\\n\",e(r.p,{children:\"A mask is applied to ignore padding tokens in the sequence for efficiency and to ensure that self-attention in the decoder does not reference future tokens.\"}),\"\\n\",n(r.p,{children:[\"The output has a shape of \",e(r.code,{children:\"[batch_size, n_head, len_q, d_v]\"})]}),\"\\n\",e(r.p,{children:\"This is just one module used in the Multi-Head attention mechanism.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/attention-is-all-you-need/4.png\",alt:\"\"})}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_qs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_ks \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_vs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"fc \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" bias\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=False\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"attention \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" ScaledDotProductAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\"temperature\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 0.5\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"layer_norm \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LayerNorm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" eps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e-6\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # q = [batch_size, len_q, d_model]\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        residual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q \"}),e(r.span,{style:{color:\"#616E88\"},children:\"# enc_input\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Separate different heads: [batch, len, n_head, d] (d_model / n_head = d_k)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_qs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        k \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_ks\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_vs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Transpose for attention dot product: [batch, len, n_head, d]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"),\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"is\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" not\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            mask \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"unsqueeze\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"attention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Transpose to move the head dimension back: b x lq x n x dv\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # Combine the last two dimensions to concatenate all the heads together: b x lq x (n*dv)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"transpose\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"contiguous\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"view\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"sz_b\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" len_q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" -\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"fc\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # LayerNorm(x + Sublayer(x))\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" residual\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        q \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"layer_norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" q\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"Wait, what is the layer function? And what does \",e(r.code,{children:\"fc\"}),\" mean? I recommend reading \",e(r.a,{href:\"https://thecho7.tistory.com/entry/PyTorch-nnLinear%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A7%88%EB%AC%B8\",children:\"pytorch layer\"}),\" (this is a Korean blog), which provides a concise explanation.\"]}),\"\\n\",n(r.p,{children:[\"The Multi-Head Attention mechanism takes parameters \",e(r.code,{children:\"q\"}),\", \",e(r.code,{children:\"k\"}),\", and \",e(r.code,{children:\"v\"}),\". In practice, all of them are derived from the same input \",e(r.code,{children:\"x\"}),\". This is why the residual connection is applied to \",e(r.code,{children:\"q\"}),\".\"]}),\"\\n\",n(r.p,{children:[\"After performing Scaled Dot-Product attention and applying \",e(r.code,{children:\"transpose(1, 2).contiguous().view(sz_b, len_q, -1)\"}),\", \",e(r.code,{children:\"q\"}),\" has a shape of \",e(r.code,{children:\"[sz_batch, len_q, n_head * d_v]\"}),\". In the original architecture, \",e(r.code,{children:\"d_v = d_k\"}),\", but when \",e(r.code,{children:\"d_v != d_k\"}),\", it ensures that the output and input dimensions of the \",e(r.code,{children:\"fc\"}),\" layer remain consistent.\"]}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_1 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"w_2 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_hid\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"layer_norm \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LayerNorm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_in\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" eps\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1e-6\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        residual \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_2\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"F\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"relu\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"w_1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")))\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"+=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" residual\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        x \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"layer_norm\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]})]})})}),\"\\n\",e(r.p,{children:\"This is Feed Forward Network. It is a simple linear transformation followed by a ReLU activation function and a dropout layer.\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" EncoderLayer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"pos_ffn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" slf_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        enc_output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"pos_ffn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_slf_attn\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" DecoderLayer\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0.1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"enc_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" MultiHeadAttention\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_head\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_k\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_v\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"pos_ffn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" PositionwiseFeedForward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"d_model\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" d_inner\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" self_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dec_enc_attn_mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=None\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_slf_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"self_attn_mask\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#ECEFF4\"},children:\"        )\"})}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_enc_attn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"enc_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" enc_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" mask\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dec_enc_attn_mask\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        dec_output \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"pos_ffn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_slf_attn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" dec_enc_attn\"})]})]})})}),\"\\n\",n(r.p,{children:[\"In fact, the Encoder and Decoder are straightforward implementations of their respective layers. It's more an algorithmic problem - determining where to provide the input and how to obtain the output. Therefore, I'll skip the following code snippets. If you want to a deeper dive into the Transformer code, please refer to the \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"scratch\"}),\".\"]}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"reference\"}),\"\\n\",n(r.ol,{children:[\"\\n\",n(r.li,{children:[\"Attention is all you need: \",e(r.a,{href:\"https://arxiv.org/abs/1706.03762\",children:\"https://arxiv.org/abs/1706.03762\"})]}),\"\\n\",n(r.li,{children:[\"transformer code: \",e(r.a,{href:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\",children:\"https://github.com/jadore801120/attention-is-all-you-need-pytorch\"})]}),\"\\n\"]}),\"\\n\",e(r.hr,{})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/study/paper-review/attention-is-all-you-need"
  },
  {
    "title": "CLIP",
    "description": "DSBA     - Learning Transferable Visual Models From Natural Language Supervision",
    "slug": "clip",
    "publishDate": "2025-07-14",
    "thumbnailUrl": "/study/paper-review/clip/thm1.jpeg",
    "content": "const{Fragment:e,jsx:l,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",br:\"br\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...s.components};return n(e,{children:[l(r.p,{children:\"7 DSBA    .   AI      .    CV(Computer Vision), NLP(Natural Language Process), TS(Time Series)      , Notion  ,        1)  , 2)   , 3)        .\"}),\"\\n\",l(r.p,{children:\"    Notion     .       .\"}),\"\\n\",l(r.hr,{}),\"\\n\",l(r.p,{children:\"*This is a same content with the above paragraph.\"}),\"\\n\",l(r.p,{children:\"I've been interning at the DSBA lab at SNU since July. Thankfully, there is a preparatory program for freshman and intern who have little to no background in AI research. The program focuses on DSBA's main research interests: Computer Vision (CV), Natural Language Process (NLP), and Time Series (TS). As part of the program, I read papers in each field, summarize them in Notion, and then present to the current researchers about 1) how I approached the paper, 2) what I thought or felt about it, and 3) any questions that came up during my reading.\"}),\"\\n\",l(r.p,{children:\"I'm planning to transfer the contents I wrote in Notion to my blog. At the end of each post, I'll also share some brief personal thoughts.\"}),\"\\n\",l(r.hr,{}),\"\\n\",l(r.p,{children:\"   Notion .\"}),\"\\n\",l(r.p,{children:l(r.a,{href:\"https://arxiv.org/abs/2103.00020\",children:\"Paper Link\"})}),\"\\n\",l(r.h2,{children:\"1. Introduction\"}),\"\\n\",n(r.ol,{children:[\"\\n\",l(r.li,{children:\"The research area covered by the paper\"}),\"\\n\"]}),\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"Vision model training with natural language\"}),\"\\n\",l(r.li,{children:\"Multi-modal models\"}),\"\\n\",l(r.li,{children:\"Natural language supervision and weakly-supervised training\"}),\"\\n\",l(r.li,{children:\"Transfer learning\"}),\"\\n\",l(r.li,{children:\"Zero-shot and few-shot transfer task capabilities\"}),\"\\n\"]}),\"\\n\",n(r.ol,{start:\"2\",children:[\"\\n\",l(r.li,{children:\"Limitations of previous studies in this task\"}),\"\\n\"]}),\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"Existing datasets for training vision models are limited in size, as they are labeled data.\"}),\"\\n\",l(r.li,{children:\"Existing models lack the ability to perform zero-shot transfer on various downstream tasks.\"}),\"\\n\"]}),\"\\n\",n(r.ol,{start:\"3\",children:[\"\\n\",l(r.li,{children:\"Contributions\"}),\"\\n\"]}),\"\\n\",n(r.ul,{children:[\"\\n\",n(r.li,{children:[\"Presenting a large-scale dataset and a pre-training methodology based on weakly-supervised training)\",\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"(The paper states that) Could scalable pre-training methods which learn directly from web text result in a similar breakthrough in computer vision?\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"Focusing on the capability to solve task using zero-shot transfer\",\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"While existing models focus on learning better representations, CLIP is designed to directly solve tasks (e.g., shifting from 'how to represent a cat image well' to 'how to classify a cat image well')\"}),\"\\n\",l(r.li,{children:\"(The paper states that) While much research in the field of unsupervised learning focuses on the representation learning capabilities of machine learning systems, we motivate studying zero-shot transfer as a way of measuring the task-learning capabilities of machine learning systems.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",l(r.h2,{children:\"2. Related Work\"}),\"\\n\",n(r.ul,{children:[\"\\n\",n(r.li,{children:[\"Improved deep metric learning with multi-class n-pair loss objective, Advances in neural information processing systems 2016\",\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"The N-pair loss was intoduced to efficiently learn representations by considering samples from multiple classes at once.\"}),\"\\n\",l(r.li,{children:\"CLIP employed the N-pair contrastive loss\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"Learning Visual Features from Large Weakly Supervised Data, ECCV 2016\",\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"A CNN-based model was trained using a large-scale weakly-supervised dataset.\"}),\"\\n\",l(r.li,{children:\"The model could achieve generalization even when the labels were weak (contaminated or incomplete), as long as there was enough data.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"Learning Visual N-grams from Web Data, IEEE 2017\",\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"The model is trained to associate N-grams from images and text\"}),\"\\n\",l(r.li,{children:\"It models concepts not as single word, but as phrases or even entire sentences.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",l(r.li,{children:\"VirTex, ICMLM, ConVIRT\\n_ These models also use a text-image architeccture, which served as an inspiration for CLIP.\"}),\"\\n\"]}),\"\\n\",l(r.h2,{children:\"3. Proposed Methodology\"}),\"\\n\",l(r.h3,{children:\"Main Idea & Contribution\"}),\"\\n\",n(r.ol,{children:[\"\\n\",l(r.li,{children:\"Architecture\"}),\"\\n\"]}),\"\\n\",l(r.p,{children:l(r.img,{src:\"/study/paper-review/clip/1.png\",alt:\"image.png\"})}),\"\\n\",l(r.p,{children:\"Text encoder: Transformer - 63M parameter, 12 layer, 512 wide model with 8 heads\"}),\"\\n\",l(r.p,{children:\"Image encoder\"}),\"\\n\",n(r.table,{children:[l(r.thead,{children:n(r.tr,{children:[l(r.th,{}),l(r.th,{children:\"Base style\"}),l(r.th,{children:\"EfficientNet style\"}),l(r.th,{})]})}),l(r.tbody,{children:n(r.tr,{children:[l(r.td,{children:\"ResNe\"}),l(r.td,{children:\"ResNet-50, ResNet-101\"}),l(r.td,{children:\"RN50x4, RN50x16, RN50x64\"}),l(r.td,{})]})})]}),\"\\n\",n(r.table,{children:[l(r.thead,{children:n(r.tr,{children:[l(r.th,{}),l(r.th,{children:\"Base\"}),l(r.th,{children:\"Large\"})]})}),l(r.tbody,{children:n(r.tr,{children:[l(r.td,{children:\"ViT\"}),l(r.td,{children:\"16, 32\"}),l(r.td,{children:\"14, 14@336px\"})]})})]}),\"\\n\",l(r.p,{children:\"CLIP model used ViT-L/14@336px, which showed the best performance)\"}),\"\\n\",l(r.p,{children:\"For the largest model, RN50x64 was trained on 592 V100 GPUs for 18 days, while ViT-L/14 was trained on 256 V100 GPUs for 12 days.\"}),\"\\n\",n(r.p,{children:[\"An implementaion of the code. (\",l(r.a,{href:\"https://github.com/openai/CLIP\",children:\"https://github.com/openai/CLIP\"}),\")\"]}),\"\\n\",l(r.p,{children:\"Skip an unnecassary code.\"}),\"\\n\",l(e,{children:l(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),l(r.span,{style:{color:\"#8FBCBB\"},children:\" CLIP\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 embed_dim\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"                 # vision\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 image_resolution\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vision_layers\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" Union\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"Tuple\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"],\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vision_width\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vision_patch_size\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"                 # text\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 context_length\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 vocab_size\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 transformer_width\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 transformer_heads\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                 transformer_layers\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" int\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#ECEFF4\"},children:\"                 ):\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"        if\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" isinstance\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_layers\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"tuple\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" list\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            vision_heads \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" vision_width \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\" 32\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" //\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\" 64\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"            self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"visual \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" ModifiedResNet\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                layers\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_layers\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                output_dim\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embed_dim\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                heads\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_heads\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                input_resolution\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image_resolution\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                width\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_width\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#ECEFF4\"},children:\"            )\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"        else\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\":\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            vision_heads \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" vision_width \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"//\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\" 64\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"            self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"visual \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" VisionTransformer\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                input_resolution\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image_resolution\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                patch_size\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_patch_size\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                width\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_width\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                layers\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_layers\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                heads\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"vision_heads\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"                output_dim\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embed_dim\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#ECEFF4\"},children:\"            )\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" Transformer\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"            width\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer_width\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"            layers\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer_layers\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"            heads\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"transformer_heads\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"            attn_mask\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"build_attention_mask\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            \"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" encode_image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"visual\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" encode_text\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"token_embedding\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"text\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#616E88\"},children:\"  # [batch_size, n_ctx, d_model]\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"+\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"positional_embedding\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"permute\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#616E88\"},children:\"  # NLD -> LND\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"transformer\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"permute\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\" 0\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#616E88\"},children:\"  # LND -> NLD\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"ln_final\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"type\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dtype\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"        # x.shape = [batch_size, n_ctx, transformer.width]\"})}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"        # take features from the eot embedding (eot_token is the highest number in each sequence)\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        x\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"torch\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"arange\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"x\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"]),\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"argmax\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9\"},children:\"dim\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=-\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")]\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" @\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"text_projection\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            \"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        image_features\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"encode_image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        text_features\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"encode_text\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"text\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"        # normalized features\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        image_features\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image_features \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"/\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image_features\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"norm\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9\"},children:\"dim\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9\"},children:\" keepdim\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        text_features\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text_features \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"/\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text_features\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"norm\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#D8DEE9\"},children:\"dim\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9\"},children:\" keepdim\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"=True\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"        # cosine similarity as logits\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        logit_scale\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"logit_scale\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"exp\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        logits_per_image\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logit_scale \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"*\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" image_features \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"@\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" text_features\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"t\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"        logits_per_text\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logits_per_image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"t\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"        # shape = [global_batch_size, global_batch_size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logits_per_image\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" logits_per_text\"})]})]})})}),\"\\n\",l(r.p,{children:\"You can find clean and well-organized from-scratch implementations of ResNet, ViT, and Transformer in the CLIP/clip/model.py file of the repository. It's a great reference if you want to see how these models are implemented from the ground up.\"}),\"\\n\",n(r.ol,{children:[\"\\n\",l(r.li,{children:\"Natural Language Supervision\"}),\"\\n\"]}),\"\\n\",l(r.p,{children:\"(The paper states that) Its much easier to scale natural language supervision compared to standard crowd-sourced labeling for image classification. (ellipsis) methods which work on natural language can learn passively from the supervision contained in the vast amount of text on the internet.\"}),\"\\n\",l(r.p,{children:\"OpenAI, known for gathering massive datasets for GPT training, demonstrates impressive web crawling capabilities.\"}),\"\\n\",n(r.ol,{children:[\"\\n\",n(r.li,{children:[\"\\n\",l(r.p,{children:\"They set up 500K queries and crawled (image, text) pairs for each.\"}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"\\n\",l(r.p,{children:\"For each query, they collected up to 20,000 pairs, ensuring balanced class distribution.\"}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"\\n\",l(r.p,{children:\"In total, they gathered 400 million paris--comparable in total word count to the WebText dataset used for GPT-2 training.\"}),\"\\n\"]}),\"\\n\",n(r.li,{children:[\"\\n\",l(r.p,{children:\"Training Method\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",l(r.p,{children:\"(The paper states that) Given a batch of N (image, text) pairs, CLIP is trained to predict which of the N N possible (image, text) pairings across a batch actually occurred.\"}),\"\\n\",l(r.p,{children:\"This results in an N x N matrix of image and text pairs, where only the diagonal elements are considered positive examples, and all others are treated as negatives during training.\"}),\"\\n\",n(r.p,{children:[\"Q) How does the model handle false negatives?\",l(r.br,{}),\"\\n\",\"A) As long as the dataset is sufficiently large, even if some data is low-quality, it does not significantly hinder training. (This demonstrates the strength of weak supervision.)\"]}),\"\\n\",l(r.p,{children:\"A key question to verify through experiments:\\nWill zero-shot transfer performance truly improve during pre-training, as it did with GPT?\"}),\"\\n\",l(r.h2,{children:\"4. Expreiments and Results\"}),\"\\n\",l(r.p,{children:\"This paper is quite lengthy, with most of its content dedicated to experimental design, results, and their significance. Therefore, I will go through each experiment one by one.\"}),\"\\n\",l(r.h3,{children:\"1) vs Visual N-Grams\"}),\"\\n\",n(r.p,{children:[l(r.img,{src:\"/study/paper-review/clip/2.png\",alt:\"\"}),\"\\nAs mentioned in the paper, Visual N-Grams and CLIP are not directly comparable models due to their architecture, dataset what they train, and so on. However, this table demonstrates just how much zero-shot performance has improved.\"]}),\"\\n\",l(r.h3,{children:\"2) Prompt Engineering for Image Encoding\"}),\"\\n\",l(r.p,{children:\"During pre-training, the text in CLIP's dataset consist of phrases or sentences (captions) that describe the image. However, in some evaluation datasets, only the class label is provided. In such cases, even simple prompt engineering can lead to significant performance improvements.\"}),\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:'Basic template: \"A photo of a label\" -> 1.3% improvement on ImageNet dataset'}),\"\\n\",l(r.li,{children:'Oxford-IIIT Pets: \"A photo of a lable, a type of pet\"'}),\"\\n\",l(r.li,{children:'OCR: Add quotes around characters or numbers, e.g., 1, a -> \"1\", \"a\"'}),\"\\n\"]}),\"\\n\",l(r.p,{children:\"Beyond these, various context prompts led to a total improvement of 3.5% on ImageNet. (The promptes used are summarized in CLIP/data/prompts.md on GitHub.)\"}),\"\\n\",l(r.p,{children:\"Examples of prompt.\"}),\"\\n\",l(e,{children:l(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#D8DEE9\"},children:\"templates\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" [\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of a {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a blurry photo of a {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a black and white photo of a {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a low contrast photo of a {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a high contrast photo of a {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a bad photo of a {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a good photo of a {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of a small {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of a big {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of the {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a blurry photo of the {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a black and white photo of the {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a low contrast photo of the {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a high contrast photo of the {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a bad photo of the {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a good photo of the {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of the small {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#ECEFF4\"},children:\"    '\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"a photo of the big {}.\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\",\"})]}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"]\"})})]})})}),\"\\n\",l(r.p,{children:\"The prompts are ensembeld by pooling the embeddings obtained from each individual prompt input.\"}),\"\\n\",n(r.p,{children:[\"Q) Does this increase inference time?\",l(r.br,{}),\"\\n\",\"A) The text encoder computes embeddings for the ground-truth labels in advance, and during inference, only the similarity with the image embedding needs to be calculated. Therefore, as long as the cached values are used, increasing the number of prompt templates does not proportionally increase inference cost!\"]}),\"\\n\",l(r.h3,{children:\"3) Zero-Shot CLIP Performance\"}),\"\\n\",n(r.p,{children:[l(r.strong,{children:\"vs fully Supervised models\"}),\"\\n\",l(r.img,{src:\"/study/paper-review/clip/3.png\",alt:\"\"})]}),\"\\n\",l(r.p,{children:\"On quite a few datasets, CLUP outperforms the fully supervised baselines.\"}),\"\\n\",l(r.p,{children:\"Which datasets showed poor performance?\"}),\"\\n\",l(r.p,{children:\" (The paper states that) we see that zero-shot CLIP is quite weak on several specialized, complex, or abstract tasks such as satellite image classification (EuroSAT and RESISC45), lymph node tumor detection (PatchCamelyon), counting objects in synthetic scenes (CLEVRCounts), self-driving related tasks such as German traffic sign recognition (GTSRB), recognizing distance to the nearest car (KITTI Distance).\"}),\"\\n\",l(r.p,{children:\"For highly specialized or complex image recognition tasks, transfer performance tends to be poor.\"}),\"\\n\",l(r.p,{children:\"However, these cases likely involve classes that were ralely, if ever, encountered during pre-training. Considering the performance of non-expert humans on such zero-shot tasks, this result is understandable.\"}),\"\\n\",n(r.p,{children:[l(r.strong,{children:\"vs Few-shot models\"}),\"\\n\",l(r.img,{src:\"/study/paper-review/clip/4.png\",alt:\"\"}),\"\\nLinear Probe CLIP is evaluated after being trained with Logistic Regression.\"]}),\"\\n\",l(r.p,{children:\"What's remarkable is that, up to 4-shot, CLIP's zero-shot performance remains higher.\"}),\"\\n\",l(r.p,{children:\" (The paper states that) Context-less example-based learning has the drawback that many different hypotheses can be consistent with the data, especially in the one-shot case.\"}),\"\\n\",l(r.p,{children:\"Q) why it does?\"}),\"\\n\",l(r.p,{children:\"A)\"}),\"\\n\",n(r.ol,{children:[\"\\n\",l(r.li,{children:\"Images exhibit much higher variance compared to text. Even within the same class, factors like lighting, angle, background, resolution, style, and noise can make images look completely different.\"}),\"\\n\",n(r.li,{children:[\"In contrast, text is structured and conveys meaning clearly.\",l(r.br,{}),\"\\n\",\"-> The difference in clarity between presenting a cat as a photo versus as a word 'cat'.\"]}),\"\\n\"]}),\"\\n\",l(r.p,{children:\"To sufficiently learn the visual features of images, a large number of few-shot samples is required.\"}),\"\\n\",l(r.p,{children:\"Q) Does this mean that as image resolution increases, even more few-shot samples are needed?\"}),\"\\n\",l(r.p,{children:\"A) (by GPT in Korean)\"}),\"\\n\",l(e,{children:l(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\",\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" !\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\" (\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\") , few-shot       .\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"**\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"##   \"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"### 1. **   **\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" 3232\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" 1,024,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" 224224\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" 50,176.\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"sparse\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\",\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"  \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"### 2. **  **\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"  \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\",\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"### 3. **  **\"})}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"  \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"overfit\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"##   ?\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\",\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"few-shot\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(r.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\":\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" MNIST,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" CIFAR-10\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" 1~5\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\":\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ImageNet,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" 10\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ~\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",l(r.span,{className:\"line\",children:l(r.span,{style:{color:\"#616E88\"},children:\"## \"})}),\"\\n\",l(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(r.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" few-shot\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[l(r.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(r.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]})]})})}),\"\\n\",n(r.p,{children:[l(r.strong,{children:\"the # of samples to deal with zero-shot model\"}),\"\\n\",l(r.img,{src:\"/study/paper-review/clip/5.png\",alt:\"\"})]}),\"\\n\",l(r.p,{children:\"The number of few-shot samples required to match zero-shot performance for each dataset.\"}),\"\\n\",l(r.p,{children:\"Let's take a closer look at the top four datasets:\"}),\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"FER2013: Facial expression recognition -> It is difficult to learn consistent class representations due to the different ways people express emotions.\"}),\"\\n\",l(r.li,{children:\"CIFAR10: Low resolution and high intra-class variation.\"}),\"\\n\",l(r.li,{children:\"OxfordPets: Likely struggled with distinguishing between similar breeds.\"}),\"\\n\",l(r.li,{children:\"Food101: Even the same dish can look completely different depending on the recipe or the angle of the photo.\"}),\"\\n\"]}),\"\\n\",n(r.p,{children:[\"That said, I haven't examined each dataset in detail--these are just general observations based on their characteristics.\",l(r.br,{}),\"\\n\",\"If a dataset has a large number of features that need to be captured within a class (as in FER2013), or contains a lot of background information unrelated to the class (as in Food101), few-shot learning becomes more challenging.\"]}),\"\\n\",n(r.p,{children:[l(r.strong,{children:\"A theoretical limit performance and the real performances\"}),\"\\n\",l(r.img,{src:\"/study/paper-review/clip/6.png\",alt:\"\"}),\"\\nA comparison between theoretical performance and zero-shot results\\n\",l(r.img,{src:\"/study/paper-review/clip/7.png\",alt:\"\"}),\"\\nComparison of model size and performance -- performance steadily increases, suggesting that larger models can achieve even better results.\"]}),\"\\n\",l(r.h3,{children:\"4) Representation Learning\"}),\"\\n\",l(r.p,{children:\"Although the authors emphasize task learning capability over representation learning capability, they still evaluate the modles using conventional methods.\"}),\"\\n\",l(r.p,{children:\"Experimental setup:\"}),\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"The projection to the classification space is removed from each model\"}),\"\\n\",l(r.li,{children:\"scikit-learn's L-BFGS implementation is used\"}),\"\\n\",l(r.li,{children:\"The most appropriate metric for each dataset is chosen for evalution (see the images below and Appendix A in the papar for details)\"}),\"\\n\"]}),\"\\n\",n(r.p,{children:[l(r.strong,{children:\"Dataset and meta-information\"}),\"\\n\",l(r.img,{src:\"/study/paper-review/clip/8.png\",alt:\"\"}),\"\\n\",l(r.img,{src:\"/study/paper-review/clip/9.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:[\"Visualization of the results:\\n\",l(r.img,{src:\"/study/paper-review/clip/10.png\",alt:\"\"})]}),\"\\n\",l(r.p,{children:\"The large-parameter CLIP model demonstrates excellent embedding capabilities!\"}),\"\\n\",l(r.p,{children:\"Q) Is linear probing a good indicaotr of embedding quality?\\nA) If an embedding achieves strong performance with just a simple linear layer, it suggests that the embedding captures a wide range of visual and abstract features across images. Rather than being tailored to specific classes, it provieds a general-purpose representation. In other words, the model excels at extracting features for a variety of classes within images--indicating high-quality embedding representations!\"}),\"\\n\",l(r.h3,{children:\"5) Robustness to Natural Distribution Shift\"}),\"\\n\",l(r.p,{children:\"This section presents experiments on transfer capability, which has been a recurring theme since the introduction.\"}),\"\\n\",l(r.p,{children:\"The paper describes two types of robustness.\"}),\"\\n\",n(r.ol,{children:[\"\\n\",l(r.li,{children:\"Relative Robustness: it captures any improvement in out-of-distribution accuracy.\"}),\"\\n\",l(r.li,{children:\"Effective Robustness: it measures improvements in accuracy under distribution shift above what is predicted by the documented relationship between in-distribution and out-of-distribution accuracy.\"}),\"\\n\"]}),\"\\n\",l(r.p,{children:\"Of course, for a model to be considered robust, both types of robustness should be high.\"}),\"\\n\",n(r.p,{children:[l(r.img,{src:\"/study/paper-review/clip/11.png\",alt:\"\"}),\"\\nCLIP demonstrates even higher performance on different distributions. For example, on ImageNet-R, while performance of ImageNet-trained ResNet101 drops by about 40%, CLIP's performance actually inreases by 12%. This highlights how powerful it is to understand image structure through natural language--a precedent already set by GPT.\"]}),\"\\n\",n(r.p,{children:[l(r.img,{src:\"/study/paper-review/clip/12.png\",alt:\"\"}),\"\\nWhen trained specifically on ImageNet, robustness to other datsets decreases. However, if you align the class names for zero-shot CLIP, you can see significant performance improvements on certain datasets.\"]}),\"\\n\",n(r.p,{children:[l(r.img,{src:\"/study/paper-review/clip/13.png\",alt:\"\"}),\"\\nZero-shot is much more robust than few-shot.\"]}),\"\\n\",l(r.h3,{children:\"6) Comparison to Human Performance\"}),\"\\n\",l(r.p,{children:\"CLIP is better\"}),\"\\n\",l(r.h3,{children:\"7) Data overlap\"}),\"\\n\",l(r.p,{children:\"One of the challenges in evaluating pre-trained models is that evaluation datasets can sometimes overlap with training data. In this paper, the authors created an overlap detector to construct a clean subset, and fount that, except for a few datasets, the overlap was within acceptable limits. However, for more precise evaluation, it will be necessay to use evaluation datasets created after CLIP.\"}),\"\\n\",l(r.p,{children:\"(The paper states that) Creating a new benchmark of tasks designed explicitly to evaluate broad zero-shot transfer capabilities, rather than re-using existing supervised datasets, would help address these issues.\"}),\"\\n\",l(r.h3,{children:\"8) Bias\"}),\"\\n\",l(r.p,{children:\"Since the model is trained on large-scale internet data, it inevitably contains biases related to sexuality, race, and occupation.\"}),\"\\n\",n(r.p,{children:[l(r.img,{src:\"/study/paper-review/clip/14.png\",alt:\"\"}),\"\\n\",l(r.img,{src:\"/study/paper-review/clip/15.png\",alt:\"\"})]}),\"\\n\",l(r.p,{children:\"Just like with InstructionGPT, effective instruction tuning will be necessary.\"}),\"\\n\",l(r.h2,{children:\"5. Conclusion (Lessons learned)\"}),\"\\n\",l(r.p,{children:\"Thanks to the abundance of insights gained from leveraging massive resources, I found this paper highly engaging despite its considerable length. Each experiment could practically be a research topic on its own.\"}),\"\\n\",n(r.p,{children:[\"On a personal note, I've also been reading papers in the speech-to-text domain. Similar to CLIP, Whisper, which is audio model made by OpenAI, presents a pre-trained model built on a natural supervision dataset and shares a variety of experimental results. Along with GPT-3, it's clear that OpenAI has laid the foundation for most of today's AI models.\",l(r.br,{}),\"\\n\",\"What stood out in this paper was the clear focus on 'task learning capability' rather than just 'representation learning capability,' and the strong intention to build AI models that are meaningful in the real world.\",l(r.br,{}),\"\\n\",'Although OpenAI has since shifted to closed models, their ahcievements so far truly embody the spirit of \"Open\" AI. I was especially moved by the paragraph on the right side of page 25.']}),\"\\n\",n(r.ul,{children:[\"\\n\",l(r.li,{children:\"We hope that this work motivates future research on the characterization of the capabilities, shortcomings, and biases of such models, and we are excited to engage with the research community on such questions.\"}),\"\\n\"]}),\"\\n\",l(r.hr,{}),\"\\n\",n(r.p,{children:[\"  .       ...       .       .\",l(r.br,{}),\"\\n\",\" OpenAI  ChatGPT   ,            LLM    .\"]})]})}return{default:function(e={}){const{wrapper:n}=e.components||{};return n?l(n,{...e,children:l(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/clip"
  },
  {
    "title": "DDPM",
    "description": "DSBA     - Denoising Diffusion Probabilistic Models",
    "slug": "ddpm",
    "publishDate": "2025-07-17",
    "thumbnailUrl": "/study/paper-review/ddpm/thm1.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:i}=arguments[0];function _createMdxContent(r){const t={br:\"br\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",ul:\"ul\",...r.components};return i(e,{children:[n(t.h2,{children:\"1. Introduction\"}),\"\\n\",i(t.ol,{children:[\"\\n\",n(t.li,{children:\"The research area covered by the paper\"}),\"\\n\"]}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"Image Generation\"}),\"\\n\"]}),\"\\n\",i(t.ol,{start:\"2\",children:[\"\\n\",n(t.li,{children:\"Limitations of previous studies in this task\"}),\"\\n\"]}),\"\\n\",i(t.ul,{children:[\"\\n\",i(t.li,{children:[\"\\n\",n(t.p,{children:\"GAN (Generative Adversarial Networks)\"}),\"\\n\",i(t.ul,{children:[\"\\n\",i(t.li,{children:[\"Structural flaws in adversarial architectures:\",\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"The learning process is incomplete and can be easliy disrupted by experimental factors.\"}),\"\\n\",n(t.li,{children:\"GANs are unable to generate a diverse range of images.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"\\n\",n(t.p,{children:\"VAE (Variational Autoencoder)\"}),\"\\n\",i(t.ul,{children:[\"\\n\",i(t.li,{children:[\"Limited feature representation:\",\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"Images generated by VAEs lack detail and often appear blurry.\"}),\"\\n\",n(t.li,{children:\"VAEs struggle to model complex data distribution.\"}),\"\\n\",n(t.li,{children:\"There is a trade-off: higher image quality often leads to lower diversity.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"\\n\",n(t.p,{children:\"Autoregressive model (ex. PixelCNN, PixelRNN)\"}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"Extreamely high computational cost.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.ol,{start:\"3\",children:[\"\\n\",n(t.li,{children:\"Contributions\"}),\"\\n\"]}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"Learning stability\"}),\"\\n\",n(t.li,{children:\"Quality of the samples\"}),\"\\n\",n(t.li,{children:\"Diversity\"}),\"\\n\"]}),\"\\n\",n(t.h2,{children:\"2. Related Work\"}),\"\\n\",n(t.p,{children:\"Skip\"}),\"\\n\",n(t.h2,{children:\"3. Methodology\"}),\"\\n\",n(t.h3,{children:\"Main Idea\"}),\"\\n\",n(t.p,{children:\"The authors propose an architecture of Diffusion Models.\"}),\"\\n\",i(t.ol,{children:[\"\\n\",i(t.li,{children:[\"Forward Process\\n\",n(t.img,{src:\"/study/paper-review/ddpm/1.png\",alt:\"\"}),\"\\n\",n(t.img,{src:\"/study/paper-review/ddpm/2.png\",alt:\"\"})]}),\"\\n\"]}),\"\\n\",n(t.p,{children:\"Why?\"}),\"\\n\",n(t.p,{children:n(t.img,{src:\"/study/paper-review/ddpm/3.png\",alt:\"\"})}),\"\\n\",n(t.p,{children:\"Q) Why did they use these alpha and beta?\\nA) There are sevaral methods to make Markov Chain converge to a normal distribution. The authors simply chose this approach, likely because it showed the best performance.\"}),\"\\n\",n(t.p,{children:\"Q) Why do they use a standard normal distribution?\\nA) For convenience. A standard normal distribution is the easiest to work with.\"}),\"\\n\",i(t.ol,{start:\"2\",children:[\"\\n\",i(t.li,{children:[\"\\n\",i(t.p,{children:[\"Reverse Process\\n\",n(t.img,{src:\"/study/paper-review/ddpm/4.png\",alt:\"\"})]}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"\\n\",i(t.p,{children:[\"Loss\\nThe ELBO\\n\",n(t.img,{src:\"/study/paper-review/ddpm/5.png\",alt:\"\"})]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.p,{children:[\"Derivation of Loss\\n\",n(t.img,{src:\"/study/paper-review/ddpm/6.png\",alt:\"\"}),\"\\n\",n(t.img,{src:\"/study/paper-review/ddpm/7.png\",alt:\"\"})]}),\"\\n\",i(t.p,{children:[\"As a result, the loss only depends on the noise(epsilon)! This makes it quite simple and convenient.\",n(t.br,{}),\"\\n\",\"(The paper states that) To summarize, we can train the reverse process mean function approximator mu_theta to predict mu tilda_t, or by modifying its parameterization, we can train it to predict epsilon.\"]}),\"\\n\",i(t.ol,{start:\"4\",children:[\"\\n\",i(t.li,{children:[\"\\n\",i(t.p,{children:[\"Data scaling, Reverse process decoder, and L0\\n\",n(t.img,{src:\"/study/paper-review/ddpm/8.png\",alt:\"\"})]}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"\\n\",i(t.p,{children:[\"Real-Training Objective (the Loss)\\n\",n(t.img,{src:\"/study/paper-review/ddpm/9.png\",alt:\"\"}),\"\\nThe authors remove parameters that depend on t, which improves performance.\\n(The paper states that) These terms train the network to denoise data with very small amounts of noise, so it is beneficial to down-weight them so that the network can focus on more difficult denoising tasks at larger terms. We will see in our experiments that this reweighting leads to better sample quality.\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.p,{children:[\"With this objective, DMs are trained using the following algorithm:\\n\",n(t.img,{src:\"/study/paper-review/ddpm/10.png\",alt:\"\"}),\"\\nDuring training, it is sufficient to select only a few values of (t) from 1 to (T). Then, the gradient of L_simple can be calculated based on (x_0), and the model is updated using this gradient for backpropagation.\"]}),\"\\n\",n(t.h2,{children:\"4. Experiments and Results\"}),\"\\n\",n(t.h3,{children:\"Datasets\"}),\"\\n\",n(t.p,{children:\"CIFAR10 (Candian Institute For Advanced Research)\"}),\"\\n\",n(t.h3,{children:\"Results\"}),\"\\n\",n(t.p,{children:n(t.img,{src:\"/study/paper-review/ddpm/11.png\",alt:\"\"})}),\"\\n\",n(t.p,{children:\"The simple objective used in DMs works well!\"}),\"\\n\",i(t.p,{children:[n(t.img,{src:\"/study/paper-review/ddpm/12.png\",alt:\"\"}),\"\\nFurthermore, reparameterizing from from mu to eplsion leads to even better performance.\"]}),\"\\n\",n(t.p,{children:\"After this, the authors discuss progressive coding and generation based on information theory. Since I don't have much background in these topics, I asked AI for clarification.\"}),\"\\n\",n(t.p,{children:\"(In Korean)\"}),\"\\n\",n(t.pre,{children:n(t.code,{className:\"language-Bash\",children:'Progressive Coding   \\n\\n- **Diffusion      **\\n    \\n       (timestep)      .\\n    \\n- **   (KL divergence) **\\n    \\n       (rate) (distortion)   .\\n    \\n- **,   (encoding),\\n  (decoding) **\\n      /    .\\n- **:**\\n    \\n    Diffusion  \"  (progressive lossy compressor)\"   ,\\n    \\n      rate-distortion trade-off   .\\n    \\n---\\n\\nProgressive Generation\\n\\n- **:**  \\n  Diffusion  (reverse process)    .\\n- **:**  \\n     ,        .\\n- **:**  \\n      ,       .\\n\\n---\\n\\nConnection to Autoregressive Decoding\\n\\n- **:**  \\n  Diffusion     Autoregressive (: PixelCNN, GPT )    .\\n- **:**  \\n       /  .\\n- **:**  \\n  Diffusion  Autoregressive  , ,  /     .\\n'})}),\"\\n\",n(t.p,{children:\"Additional details can be found in the appendix.\"}),\"\\n\",n(t.p,{children:\"Increasing the number of diffusion steps destroys more structure in the source images, which the model completes during the reverse process. This allows us to interpolate at both fine granularities and coarse granularities. In the limiting case of 0 diffusion steps, the interpolation mixes source images in pixel space. On the other hand, after 1000 diffusion steps, source information is lost and interpolations are novel samples.\"}),\"\\n\",n(t.p,{children:n(t.img,{src:\"/study/paper-review/ddpm/13.png\",alt:\"\"})}),\"\\n\",n(t.h2,{children:\"5. Conclusions\"}),\"\\n\",i(t.ul,{children:[\"\\n\",i(t.li,{children:[\"\\n\",n(t.p,{children:\"What a creative and marvelous process of induction. How do the authors come up with ideas like this?\"}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"\\n\",n(t.p,{children:\"There is a fundamental difference between the NLP and image domains.\"}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"In most cases, NLP uses cross-entropy loss\"}),\"\\n\",n(t.li,{children:\"In image generation, models use KL divergence, which effectively removes the original data distribution from corss-entropy.\"}),\"\\n\",n(t.li,{children:\"Natural language is highly structured, so we can assume that the real data distribution can be approximated from samples.\"}),\"\\n\",n(t.li,{children:\"However, in image gerenation, we have no information about the distribution of the original images.\"}),\"\\n\",n(t.li,{children:\"Therefore, KL divergence in used to eliminate the unknown original distribution.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"\\n\",n(t.p,{children:\"A fundamental difference between NLP and Image field.\"}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"Most cases, NLP uses cross-entropy.\"}),\"\\n\",n(t.li,{children:\"In image generation field, models adopt KL divergence, which remove the original data distribution from cross-entropy\"}),\"\\n\",n(t.li,{children:\"Natural language is quite structural. So, there is a premise that we can approximate the real data distribution from the samples.\"}),\"\\n\",n(t.li,{children:\"But in image generation, we don't have any information about origin images.\"}),\"\\n\",n(t.li,{children:\"Therefore, we have to use KL divergence with removing the origin distribution.\"}),\"\\n\",i(t.li,{children:[\"It tells us some zero-shot CLIP's capability.\",\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"Only one image is inadequate to learn the image distribution, not like NLP.\"}),\"\\n\",n(t.li,{children:\"e.t.c., a 'cat' word and a 'cat image'. Person who have been seeing cat, can't distinguish the cat from the image, containing the background and other obejcts.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(t.hr,{})]})}return{default:function(e={}){const{wrapper:i}=e.components||{};return i?n(i,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/ddpm"
  },
  {
    "title": "GAN",
    "description": "DSBA     - Generative Adversarial Networks",
    "slug": "gan",
    "publishDate": "2025-07-24",
    "thumbnailUrl": "/study/paper-review/gan/thm1.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:i}=arguments[0];function _createMdxContent(t){const r={a:\"a\",br:\"br\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",ul:\"ul\",...t.components};return i(e,{children:[n(r.h2,{children:\"1. Introduction\"}),\"\\n\",i(r.ol,{children:[\"\\n\",n(r.li,{children:\"The research area covered by the paper\"}),\"\\n\"]}),\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"Training Archtecture\"}),\"\\n\",n(r.li,{children:\"Image generation\"}),\"\\n\"]}),\"\\n\",i(r.ol,{start:\"2\",children:[\"\\n\",n(r.li,{children:\"Contributions\"}),\"\\n\"]}),\"\\n\",i(r.ul,{children:[\"\\n\",i(r.li,{children:[\"The authors design an architecture of adversarial nets that G and D; a generative model Q and a discriminative model D.\",\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"G captures the data distribution\"}),\"\\n\",n(r.li,{children:\"D estimates the probability that a sample came from the training data rather than G\"}),\"\\n\",n(r.li,{children:\"G maximizes the probability of D making a mistake\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.h2,{children:\"2. Methodology\"}),\"\\n\",n(r.h3,{children:\"Main Idea\"}),\"\\n\",n(r.p,{children:\"( )  The generative model can be thought of as analogous to a team of counterfeiters, trying to produce fake currency and use it without detection, while the discriminative model is analogous to the police, trying to detect the counterfeit currency. Competition in this game drives both teams to improve their methods until the counterfeits are indistiguishable from the genuine articles.\"}),\"\\n\",n(r.p,{children:\"notations:\"}),\"\\n\",n(r.p,{children:\"G(z;theta_g): Generator with parameter theta_g\\nD(x;theta_d): Discriminator with parameter theta_d\"}),\"\\n\",n(r.p,{children:\"The goal is to learn the generators distribution over data samples.\"}),\"\\n\",i(r.p,{children:[\"This is a quite good figure to understand the training concept of adversarial nets.\\n\",n(r.img,{src:\"/study/paper-review/gan/1.png\",alt:\"\"})]}),\"\\n\",i(r.p,{children:[\"Value Function V(G,D)\\n\",n(r.img,{src:\"/study/paper-review/gan/2.png\",alt:\"\"})]}),\"\\n\",i(r.p,{children:[\"D(x) is the estimate of the probability that x is a real data sample from the true data distribution.\",n(r.br,{}),\"\\n\",\"1 - D(G(z)) is the probability that the discriminator thinks the sample is fake.\"]}),\"\\n\",i(r.p,{children:[\"Training Algorithm\\n\",n(r.img,{src:\"/study/paper-review/gan/3.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:\"It updates the D for k steps first, then does the G, where the way is explained above the Figure 1.\"}),\"\\n\",i(r.ol,{children:[\"\\n\",i(r.li,{children:[\"Early stage of learning, G is so poor that D can reject samples with high confidence.\",\"\\n\",i(r.ol,{children:[\"\\n\",n(r.li,{children:\"log(1 - D(G(z))) is saturates\"}),\"\\n\",n(r.li,{children:\"we can train G to maximize log(D(G(z)),  rather than training G to minimize log(1-D(G(z))).\"}),\"\\n\",n(r.li,{children:\"b. gives the generator stronger gradients when it is still producing poor samples.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.p,{children:\"They show that the value function and the algorithm make G and D optimal states.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/gan/4.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"It shows that D can reach to D^*, which is optimal value. Therefore, C(G) could be minimum when p_data equals p_g.\"}),\"\\n\",n(r.p,{children:\"We need to one more proposition to verify that C(G) can converge to global minimum to make p_g equal to p_data, mentioned on the above.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/gan/5.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"Done!\"}),\"\\n\",n(r.h3,{children:\"Contribution\"}),\"\\n\",n(r.p,{children:\"They suggest the architecture of adversarial nets, which have been used in the ML field widely and frequently due to its simplicity.\"}),\"\\n\",n(r.h2,{children:\"3. Experiments and Results\"}),\"\\n\",n(r.h3,{children:\"Dataset\"}),\"\\n\",n(r.p,{children:\"MNIST(Modified National Institute of Standards and Technology): handwritten digits\"}),\"\\n\",n(r.p,{children:\"TFD(Toronto Face Database): a facial expression recognition\"}),\"\\n\",n(r.h3,{children:\"Baseline\"}),\"\\n\",n(r.p,{children:\"DBN(Deep Belief Network): composed of multiple layers of Restricted Boltzmann Machines(RBMs)\"}),\"\\n\",n(r.p,{children:\"Stracked CAE(Convolutions Autoencoder): multiple convolutional autoencoders\"}),\"\\n\",n(r.p,{children:\"Deep GSN(Deep Generative Stochastic Network): ?\"}),\"\\n\",n(r.h3,{children:\"\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/gan/6.png\",alt:\"\"})}),\"\\n\",n(r.h2,{children:\"4. Conclusions\"}),\"\\n\",n(r.p,{children:n(r.a,{href:\"https://github.com/goranikin/DSBA-intern-study/tree/main/GAN\",children:\"https://github.com/goranikin/DSBA-intern-study/tree/main/GAN\"})}),\"\\n\",i(r.p,{children:[\"Scratch GAN  , VAE  print  loss   . wandb \\n\",n(r.img,{src:\"/study/paper-review/gan/7.png\",alt:\"\"}),\"\\n\",n(r.img,{src:\"/study/paper-review/gan/8.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:\"epoch 30 50 .    .  50     .\"}),\"\\n\",n(r.p,{children:\" G gradient  , D k   .    k=1     k=4  .\"}),\"\\n\",i(r.p,{children:[n(r.img,{src:\"/study/paper-review/gan/9.png\",alt:\"\"}),\"\\n\",n(r.img,{src:\"/study/paper-review/gan/10.png\",alt:\"\"}),\"\\n y-scale \"]}),\"\\n\",n(r.p,{children:\"    , 15000 steps G_loss   step      . FID score   ImageNet       MNIST     metric .\"}),\"\\n\",i(r.ol,{children:[\"\\n\",i(r.li,{children:[\"Adversarial Learning architecture  Generator Discriminator       .\",\"\\n\",i(r.ol,{children:[\"\\n\",n(r.li,{children:\"   Loss \"}),\"\\n\",n(r.li,{children:\" loss  \"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.li,{children:\"       ,     Generator Discriminator             .      .\"}),\"\\n\"]}),\"\\n\",n(r.hr,{})]})}return{default:function(e={}){const{wrapper:i}=e.components||{};return i?n(i,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/gan"
  },
  {
    "title": "Latent Diffusion",
    "description": "DSBA     - High-Resolution Image Synthesis with Latent Diffusion Models",
    "slug": "latent-diffusion",
    "publishDate": "2025-07-21",
    "thumbnailUrl": "/study/paper-review/latent-diffusion/thm1.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:i}=arguments[0];function _createMdxContent(t){const r={h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...t.components};return i(e,{children:[n(r.p,{children:\"    ...        Latent Diffusion   .\"}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"1. Introduction\"}),\"\\n\",i(r.ol,{children:[\"\\n\",n(r.li,{children:\"The research area covered by the paper\"}),\"\\n\"]}),\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"Image generation\"}),\"\\n\",n(r.li,{children:\"Auto encoder + Diffusion\"}),\"\\n\",n(r.li,{children:\"Conditional model (sampling + other info. about an image)\"}),\"\\n\"]}),\"\\n\",i(r.ol,{start:\"2\",children:[\"\\n\",n(r.li,{children:\"Limitations of previous studies in this task\"}),\"\\n\"]}),\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"Diffusion Model(DM) pixel  noise       !\"}),\"\\n\",n(r.li,{children:\"  DM     ?\"}),\"\\n\",n(r.li,{children:\"     x latent space  , DM process !\"}),\"\\n\"]}),\"\\n\",i(r.ol,{start:\"3\",children:[\"\\n\",n(r.li,{children:\"Contributions\"}),\"\\n\"]}),\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"Auto Encoder  Latent Representation + Diffusion process  \"}),\"\\n\",n(r.li,{children:\"Latent Representation noising/denoising  Efficiency of the Computational Cost\"}),\"\\n\",n(r.li,{children:\"  Latent DM Condition(Guidance)  U-Net Cross-Attention  \"}),\"\\n\"]}),\"\\n\",n(r.h2,{children:\"2. Related Work\"}),\"\\n\",n(r.p,{children:\"DDPM\"}),\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"Latent DM denoising U-net    \"}),\"\\n\"]}),\"\\n\",n(r.p,{children:\"Auto Encoder\"}),\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"original represenation    latent   feature \"}),\"\\n\",i(r.li,{children:[\"  VAE(Variational Auto Encoder)    \",\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"Encoding  a standard normal distribution variational value  latent space standard normal distribution \"}),\"\\n\",n(r.li,{children:\"  Bayesian background  ELBO(Evidence Loss Bound)        denoising sampling distribution   KL-Divergence  \"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.p,{children:\"GAN\"}),\"\\n\",i(r.ul,{children:[\"\\n\",i(r.li,{children:[\"Adversarial architecture   \",\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"Generator Discriminator   \"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.h2,{children:\"3. Methodology\"}),\"\\n\",n(r.h3,{children:\"Main Idea\"}),\"\\n\",i(r.ul,{children:[\"\\n\",i(r.li,{children:[\"DDPM + latent space architecture\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/1.png\",alt:\"\"})]}),\"\\n\",n(r.li,{children:\" AutoEncoder  , Latent representation noise /!\"}),\"\\n\",n(r.li,{children:\"Auto Encoder    latent representation ,  space noise /     sampling  latent space \"}),\"\\n\",n(r.li,{children:\"Condition(Guidance) Cross-Attention      \"}),\"\\n\"]}),\"\\n\",n(r.p,{children:n(r.strong,{children:\" Computational Cost         !\"})}),\"\\n\",i(r.ul,{children:[\"\\n\",i(r.li,{children:[\"\\n\",i(r.p,{children:[\"Training loss\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/2.png\",alt:\"\"}),\"\\n loss\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/3.png\",alt:\"\"}),\"\\n noise distribution latent space   \"]}),\"\\n\"]}),\"\\n\",i(r.li,{children:[\"\\n\",i(r.p,{children:[\"Conditional loss\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/4.png\",alt:\"\"})]}),\"\\n\"]}),\"\\n\",i(r.li,{children:[\"\\n\",n(r.p,{children:\"(y): Domain specific embedding by   condition y latent\"}),\"\\n\"]}),\"\\n\",i(r.li,{children:[\"\\n\",n(r.p,{children:\"i(zt): intermediate representation of the UNet implementing   noise  embedding\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.h3,{children:\"Contributions\"}),\"\\n\",i(r.ul,{children:[\"\\n\",i(r.li,{children:[\"Latent DM Computational cost   ! (noise ,      )\",\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"( ) training the most powerful DMs often takes hundreds of GPU days (e.g. 150 - 1000 V100 days in)\"}),\"\\n\",n(r.li,{children:\"( ) producing 50k samples takes approximately 5 days on a single A100 GPU\"}),\"\\n\",n(r.li,{children:n(r.img,{src:\"/study/paper-review/latent-diffusion/5.png\",alt:\"\"})}),\"\\n\",n(r.li,{children:\"LDM-4-G  inference Throughput (Samples/sec) 0.4 LDM   .      DDPM    0.116  3.7 !\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(r.li,{children:[\"latent space  Text, Image, Class  Condition  Cross-attention     \",\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"(   LDM-O-G  G Guidance(condition) \"}),\"\\n\",n(r.li,{children:\"FID   IS     \"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(r.h2,{children:\"4. Experiments and Results\"}),\"\\n\",n(r.h3,{children:\"Model architecture\"}),\"\\n\",n(r.p,{children:\"Factor: the compression ratio of the latent representation\"}),\"\\n\",n(r.p,{children:\"KL: Indicates that the model does not use the VQ method to compress a latent representation.\"}),\"\\n\",n(r.p,{children:\"G: Guidance, which is equivalent to a condition. They use a BERT tokenizer and a transformer to infer a latent code.\"}),\"\\n\",n(r.h3,{children:\"Datasets\"}),\"\\n\",n(r.p,{children:\"CelebA-HQ: A celebrity face image dataset\"}),\"\\n\",n(r.p,{children:\"FFHQ(Flickr-Faces-HQ): A normal face image dataset\"}),\"\\n\",n(r.p,{children:\"LSUN-Churches: church images\"}),\"\\n\",n(r.p,{children:\"LSUN-Bedrooms: bedroom images\"}),\"\\n\",n(r.p,{children:\"ImageNet\"}),\"\\n\",n(r.h3,{children:\"Baseline\"}),\"\\n\",i(r.p,{children:[\"w/o condition\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/6.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:\"Summary table\"}),\"\\n\",i(r.table,{children:[n(r.thead,{children:i(r.tr,{children:[n(r.th,{children:\"Model\"}),n(r.th,{children:\"Type\"}),n(r.th,{children:\"Key Idea/Role\"})]})}),i(r.tbody,{children:[i(r.tr,{children:[n(r.td,{children:\"DC-VAE\"}),n(r.td,{children:\"VAE\"}),n(r.td,{children:\"Deep conv. VAE for image synthesis\"})]}),i(r.tr,{children:[n(r.td,{children:\"VQGAN+T\"}),n(r.td,{children:\"Hybrid\"}),n(r.td,{children:\"VQGAN + Transformer for text/image generation\"})]}),i(r.tr,{children:[n(r.td,{children:\"PGGAN\"}),n(r.td,{children:\"GAN\"}),n(r.td,{children:\"Progressive training for high-res images\"})]}),i(r.tr,{children:[n(r.td,{children:\"LSGM\"}),n(r.td,{children:\"Diffusion\"}),n(r.td,{children:\"Latent space score-based diffusion\"})]}),i(r.tr,{children:[n(r.td,{children:\"UDM\"}),n(r.td,{children:\"Diffusion\"}),n(r.td,{children:\"Unified framework for diffusion models\"})]}),i(r.tr,{children:[n(r.td,{children:\"ImageBART\"}),n(r.td,{children:\"Transformer\"}),n(r.td,{children:\"BART for image token sequence generation\"})]}),i(r.tr,{children:[n(r.td,{children:\"U-Net GAN\"}),n(r.td,{children:\"GAN\"}),n(r.td,{children:\"U-Net generator for detail preservation\"})]}),i(r.tr,{children:[n(r.td,{children:\"StyleGAN\"}),n(r.td,{children:\"GAN\"}),n(r.td,{children:\"Style-based control over image features\"})]}),i(r.tr,{children:[n(r.td,{children:\"ProjectedGAN\"}),n(r.td,{children:\"GAN\"}),n(r.td,{children:\"Discriminator on projected features\"})]})]})]}),\"\\n\",i(r.p,{children:[\"w text-condition\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/7.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:\"Summary table\"}),\"\\n\",i(r.table,{children:[n(r.thead,{children:i(r.tr,{children:[n(r.th,{children:\"Model\"}),n(r.th,{children:\"Type\"}),n(r.th,{children:\"Key Idea/Role\"}),n(r.th,{children:\"Application\"})]})}),i(r.tbody,{children:[i(r.tr,{children:[n(r.td,{children:\"CogView\"}),n(r.td,{children:\"Transformer\"}),n(r.td,{children:\"Text-to-image via image token transformer\"}),n(r.td,{children:\"Text-to-image (Chinese)\"})]}),i(r.tr,{children:[n(r.td,{children:\"LAFITE\"}),n(r.td,{children:\"GAN\"}),n(r.td,{children:\"Text-to-image without explicit text supervision\"}),n(r.td,{children:\"Zero-shot text-to-image\"})]}),i(r.tr,{children:[n(r.td,{children:\"GLIDE\"}),n(r.td,{children:\"Diffusion\"}),n(r.td,{children:\"Text-guided diffusion, classifier-free guidance\"}),n(r.td,{children:\"High-quality text-to-image\"})]}),i(r.tr,{children:[n(r.td,{children:\"Make-A-Scene\"}),n(r.td,{children:\"Diffusion\"}),n(r.td,{children:\"Text + layout for compositional generation\"}),n(r.td,{children:\"Scene-aware image synthesis\"})]})]})]}),\"\\n\",i(r.p,{children:[\"w class-condition\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/8.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:\"Summary Table\"}),\"\\n\",i(r.table,{children:[n(r.thead,{children:i(r.tr,{children:[n(r.th,{children:\"Model\"}),n(r.th,{children:\"Type\"}),n(r.th,{children:\"Key Feature\"})]})}),i(r.tbody,{children:[i(r.tr,{children:[n(r.td,{children:\"BigGAN-deep\"}),n(r.td,{children:\"GAN\"}),n(r.td,{children:\"Deep, class-conditional\"})]}),i(r.tr,{children:[n(r.td,{children:\"ADM\"}),n(r.td,{children:\"Diffusion\"}),n(r.td,{children:\"Class-conditional denoising\"})]}),i(r.tr,{children:[n(r.td,{children:\"ADM-G\"}),n(r.td,{children:\"Diffusion\"}),n(r.td,{children:\"Classifier-guided denoising\"})]})]})]}),\"\\n\",i(r.p,{children:[\"Inpainting\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/9.png\",alt:\"\"})]}),\"\\n\",n(r.p,{children:\"Summary Table\"}),\"\\n\",i(r.table,{children:[n(r.thead,{children:i(r.tr,{children:[n(r.th,{children:\"Model\"}),n(r.th,{children:\"Type\"}),n(r.th,{children:\"Key Feature/Idea\"})]})}),i(r.tbody,{children:[i(r.tr,{children:[n(r.td,{children:\"LaMa\"}),n(r.td,{children:\"CNN (FFC-based)\"}),n(r.td,{children:\"Fourier Convolutions, large masks\"})]}),i(r.tr,{children:[n(r.td,{children:\"CoModGAN\"}),n(r.td,{children:\"GAN\"}),n(r.td,{children:\"Contextual modulation\"})]}),i(r.tr,{children:[n(r.td,{children:\"RegionWise\"}),n(r.td,{children:\"CNN\"}),n(r.td,{children:\"Region-wise normalization/attention\"})]}),i(r.tr,{children:[n(r.td,{children:\"DeepFillv2\"}),n(r.td,{children:\"GAN (Gated Conv)\"}),n(r.td,{children:\"Gated conv, contextual attention\"})]}),i(r.tr,{children:[n(r.td,{children:\"EdgeConnect\"}),n(r.td,{children:\"Two-stage (Edge + GAN)\"}),n(r.td,{children:\"Edge prediction + inpainting\"})]})]})]}),\"\\n\",n(r.h3,{children:\"\"}),\"\\n\",n(r.p,{children:\"Already, LDMs show the performances mentioned above, achieving SOTA results on the CelebA-HQ 256x256 dataset. Therefore, the text-conditional image synthesis model achieved better FID and IS scores than the original DMs. LDMs also prove the quality on class-conditional generating and inpainting tasks.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/latent-diffusion/10.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"These results show that factor values of 4, 8, and 16 are suitible. 32 is too high to adequately represent the original information in the latent representation.\"}),\"\\n\",n(r.p,{children:\"I assume that Pixel-based models do not focus on important feature.\"}),\"\\n\",i(r.p,{children:[n(r.img,{src:\"/study/paper-review/latent-diffusion/11.png\",alt:\"\"}),\"\\nFor CelebA-Hq, LDM-32 performs better than other models, but it performs poorly on ImageNet.\"]}),\"\\n\",n(r.p,{children:\"Q) Why does a higher factor lead to better performance for CelebA-HQ?\"}),\"\\n\",n(r.p,{children:\"A) CelebA-HQ is a simple face image dataset. Therefore, it can be generated well with lower-dimensional latent representation.\"}),\"\\n\",n(r.p,{children:\"LDM-1 consistently receives poor scores. I suppose that pixel-based model have to deal with too many features to generate high-quality images.\"}),\"\\n\",i(r.p,{children:[n(r.strong,{children:\"Generating images on each dataset.\"}),\"\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/12.png\",alt:\"\"})]}),\"\\n\",i(r.p,{children:[n(r.strong,{children:\"Super-Resolution\"}),\"\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/13.png\",alt:\"\"}),\"\\nThe SR3 model is a type of diffusion model for super-resolution. The figure shows that SR3 is able to capture fine structures.\"]}),\"\\n\",i(r.p,{children:[n(r.strong,{children:\"Inpainting\"}),\"\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/14.png\",alt:\"\"}),\"\\nAs mentioned above, LDMs achieved SOTA FID scores on the inpainting task.\"]}),\"\\n\",i(r.p,{children:[n(r.strong,{children:\"human evaluation on SR and Inpainting\"}),\"\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/15.png\",alt:\"\"}),\"\\nLDM showed dominant results. \"]}),\"\\n\",i(r.p,{children:[n(r.strong,{children:\"Total organization of the architectures.\"}),\"\\n\",n(r.img,{src:\"/study/paper-review/latent-diffusion/16.png\",alt:\"\"}),\"\\nThey trained on OpenImages, evaluated on ImageNet-Val.\\nWe can see that there is a huge gap between f-32 and f-16 models.\"]}),\"\\n\",n(r.h2,{children:\"5. Conclusions\"}),\"\\n\",n(r.p,{children:\"  \"}),\"\\n\",i(r.ul,{children:[\"\\n\",n(r.li,{children:\"VAE, DDPM      task performance  Baseline \"}),\"\\n\",n(r.li,{children:\"DDPM     ,     ablation study\"}),\"\\n\"]}),\"\\n\",n(r.hr,{})]})}return{default:function(e={}){const{wrapper:i}=e.components||{};return i?n(i,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/latent-diffusion"
  },
  {
    "title": "Reading papers",
    "description": "Read papers about MT-DNN, MASS, UNILM, XLNet, RoBERTa, ALBERT.",
    "slug": "reading-papers",
    "publishDate": "2025-04-27",
    "thumbnailUrl": "/study/paper-review/reading-papers-1/thum.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:t}=arguments[0];function _createMdxContent(r){const i={a:\"a\",blockquote:\"blockquote\",hr:\"hr\",img:\"img\",p:\"p\",...r.components};return t(e,{children:[n(i.p,{children:\"During my previous studies, I examined research papers on various language models, including seq2seq, Transformer, and BERT (though I didn't write about BERT). My objective is gaining knowledge in the LLM field and also have an assignment requiring me to create a video presentation explaining the concepts I've learned in class to my peers. Previous posts are the result of the assignment. Therefore, this post will be too. :D\"}),\"\\n\",n(i.p,{children:\"This post covers MT-DNN, MASS, UNILM, XLNet, RoBERTa and ALBERT. I won't describe the details of each model, but rather focus on the fundamental concepts (due to my schedule :p).\"}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1901.11504\",children:\"MT-DNN\"}),\" (Multi-Task Deep Neural Networks for natural language understanding)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/1.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract, there is a key purpose of MT-DNN.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"MT-DNN not only leverages large amounts of cross-task data, but also benefits from a regularization effect that leads to more general representations to help adapt to new tasks and domains.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"And in the introduction, they explain the motivation behind MT-DNN, which is the basic principle of transfer learning.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Multi-Task Learning (MTL) is inspired by human learning activities where people often apply the knowledge learned from previous tasks to help learn a new task (Caruana, 1997; Zhang and Yang, 2017). For example, it is easier for a person who knows how to ski to learn skating than the one who does not.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They propose a diverse range of tasks to train the model:\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/2.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"However, I think the intricate details of these tasks are not essential for my current understanding. At this point, I'm focused on grasping the fundamental concepts rather than delving too deeply into the specifics.\"}),\"\\n\",t(i.p,{children:[\"The benchmark is following:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/3.png\",alt:\"\"})]}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1905.02450\",children:\"MASS\"}),\" (MAsked Sequence to Sequence learning)\"]}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"its encoder takes a sentence with randomly masked fragment (several consecutive tokens) as input, and its decoder tries to predict this masked fragment. In this way, MASS can jointly train the encoder and decoder to develop the capability of representation extraction and language modeling. In this paper, inspired by BERT, we propose a novel objective for pre-training: MAsked Sequence to Sequence learning (MASS) for language generation.\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"What does that mean? See the figure below:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/4.png\",alt:\"\"})]}),\"\\n\",n(i.p,{children:\"MASS masks continuous sequences of tokens within the source sentence. Subsequently, the decoder predicts these masked tokens, generating the output seqeuntially, one token at a time.\"}),\"\\n\",t(i.p,{children:[\"This provides a detailed mathematical formulation representing the loss function derived from the log-likelihood function:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/5.png\",alt:\"\"})]}),\"\\n\",t(i.p,{children:[\"Researchers assert that, under specific constraint condtions, MASS can effectively function as both BERT and GPT architectures.\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/6.png\",alt:\"\"})]}),\"\\n\",n(i.p,{children:\"However, MASS is the encoder-decoder framework to generate tokens and there is a cross-attention between the encoder and decoder. It is the fundamental difference from BERT (which is a single encoder architecture) and GPT (which is a single decoder architecture).\"}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1905.03197\",children:\"UNILM\"}),\" (UNIfied Language Model pre-training for natural language understanding and generation)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/7.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"The authors describe UNILM's foundational architecture as a 'multi-layer Transformer network'.\"}),\"\\n\",n(i.p,{children:\"However, upon examination of Figure 1, it appears identical to the encoder layer of a standard Transformer. (In fact, its architecture is precisely that of BERT Large.)\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/8.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"They implement a strategy that emulates language modeling techniques through the strategic manipulation of self-attention masks.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Specifically, within one training batch, 1/3 of the time we use the bidirectional LM objective, 1/3 of the time we employ the sequence-to-sequence LM objective, and both left-to-right and right-to-left LM objectives are sampled with rate of 1/6.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{}),\"\\n\",t(i.p,{children:[n(i.a,{href:\"https://arxiv.org/abs/1906.08237\",children:\"XLNet\"}),\" (XLNet: Generalized Autoregressive Pretraining for Language Understanding)\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/9.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"The name 'XLNet does not appear explicitly in the paper's title. However, the authors clarify the origin of this designation in the abstract.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"XLNet integrates ideas from Transformer-XL, the state-of-the-art autoregressive model, into pretraining.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"The nomenclature derives from their inspiration by Transformer-XL\"}),\"\\n\",n(i.p,{children:\"What are the distinctive characteristics of this approach?\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"we propose XLNet, a generalized autoregressive pretraining method that (1) enables learning bidirectional contexts by maximizing the expected likelihood over all permutations of the factorization order and (2) overcomes the limitations of BERT thanks to its autoregressive formulation.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They propose an enhanced pre-training methodology that leverages permutations of token order. How exactly does this mechanism function?\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/10.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"(a) shows the normal self-attention mechanism, and (b) shows the permutation self-attention what the researchers claim.\"}),\"\\n\",n(i.p,{children:\"For instance, consider the sentence 'New York is a city' which would be masked as '[Mask] [Mask] is a city' in traditional pre-training. BERT's approach involves predicting 'New' and 'York' independently, calculating p(New | is a city) and p(York | is a city) separately. In contrast, XLNet employs a sequential prediction method: first calculating p(New | is a city), then p(York | New, is a city), thereby effectively capturing the relationship between 'New' and 'York'.\\\"\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/12.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"For those familiar with the inherent limitations of transformer architectures, particularly their substantial computational overhead, it comes as no surprise that XLNet inherits these same challenges. The authors were acutely aware of this computational burden.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"While the permutation language modeling objective (3) has several benefits, it is a much more challenging optimization problem due to the permutation and causes slow convergence in preliminary experiments. To reduce the optimization difficulty, we choose to only predict the last tokens in a factorization order.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/11.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"To mitigate this issue, they strategically implemented the permutation method on only a subset of the sequence, rather than applying it exhaustively.\"}),\"\\n\",n(i.hr,{}),\"\\n\",n(i.p,{children:n(i.a,{href:\"https://arxiv.org/abs/1907.11692\",children:\"RoBERTa\"})}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/13.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"hyperparameter choices have significant impact on the final results. We present a replication study of BERT pretraining (Devlin et al., 2019) that carefully measures the impact of many key hyperparameters and training data size.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"So... the RoBERTa paper represents the better hyperparameter optimization. Our professor emphasized that despite its seemingly straightforward tuning methodology, this research emerged during a period saturated with numerous approaches and architectural innovations aimed at enhancing LLM performance. I concur with this assessment, as my review of several related papers reveals a predominant focus on architectural innovations.\"}),\"\\n\",n(i.p,{children:\"From this perspective, the authors assert the following:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We find that BERT was significantly undertrained, and can match or exceed the performance of every model published after it.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"They also implement an masking strategy called dynamic masking, which randomly masks tokens throughout the training process rather than consistently masking identical token positions.\"}),\"\\n\",n(i.p,{children:\"Intuitively, as most would likely concur, dynamic masking appears inherently more effective than static masking approaches. However, the empirical results indicate:\"}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/14.png\",alt:\"\"})}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We find that our reimplementation with static masking performs similar to the original BERT model, and dynamic masking is comparable or slightly better than static masking.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\":D\"}),\"\\n\",n(i.p,{children:\"The followings are all approaches:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Specifically, RoBERTa is trained with\\ndynamic masking (Section 4.1)\\nFULL-SENTENCES without NSP loss (Section 4.2)\\nlarge mini-batches (Section 4.3)\\na larger byte-level BPE (Section 4.4)\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/15.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"And they assert that BPE has advantages although it doesn't show a better performance.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Early experiments revealed only slight differences between these encodings, with the Radford et al. (2019) BPE achieving slightly worse end-task performance on some tasks. Nevertheless, we believe the advantages of a universal encoding scheme outweighs the minor degredation in performance and use this encoding in the remainder of our experiments. A more detailed comparison of these encodings is left to future work.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{}),\"\\n\",n(i.p,{children:n(i.a,{href:\"https://arxiv.org/abs/1909.11942\",children:\"ALBERT\"})}),\"\\n\",n(i.p,{children:n(i.img,{src:\"/study/paper-review/reading-papers-1/16.png\",alt:\"\"})}),\"\\n\",n(i.p,{children:\"In abstract:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"we present two parameter reduction techniques to lower memory consumption and increase the training speed of BERT (Devlin et al., 2019). Comprehensive empirical evidence shows that our proposed methods lead to models that scale much better compared to the original BERT.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"I'll just introduce the methodologies of ALBERT brifely.\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"The first one is a factorized embedding parameterization. By decomposing the large vocabulary embedding matrix into two small matrices, we separate the size of the hidden layers from the size of vocabulary embedding.\"}),\"\\n\"]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"The second technique is cross-layer parameter sharing. This technique prevents the parameter from growing with the depth of the network.\"}),\"\\n\"]}),\"\\n\",n(i.p,{children:\"These approaches yield efficiency gains:\"}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"An ALBERT configuration similar to BERT-large has 18x fewer parameters and can be trained about 1.7x faster.\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"The first one:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/18.png\",alt:\"\"})]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"Therefore, for ALBERT we use a factorization of the embedding parameters, decomposing them into two smaller matrices. Instead of projecting the one-hot vectors directly into the hidden space of size H, we first project them into a lower dimensional embedding space of size E, and then project it to the hidden space. By using this decomposition, we reduce the embedding parameters from O(V  H) to O(V  E + E  H).\"}),\"\\n\"]}),\"\\n\",t(i.p,{children:[\"The second:\\n\",n(i.img,{src:\"/study/paper-review/reading-papers-1/17.png\",alt:\"\"})]}),\"\\n\",t(i.blockquote,{children:[\"\\n\",n(i.p,{children:\"We observe that the transitions from layer to layer are much smoother for ALBERT than for BERT. These results show that weight-sharing has an effect on stabilizing network parameters. Although there is a drop for both metrics compared to BERT, they nevertheless do not converge to 0 even after 24 layers. This shows that the solution space for ALBERT parameters is very different from the one found by DQE. Although there is a drop for both metrics compared to BERT, they nevertheless do not converge to 0 even after 24 layers. This shows that the solution space for ALBERT parameters is very different from the one found by DQE.\"}),\"\\n\"]}),\"\\n\",n(i.hr,{})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?n(t,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/reading-papers"
  },
  {
    "title": "    ",
    "description": "transformer-xl, wav2letter, wav2vec",
    "slug": "simple-summaries-1",
    "publishDate": "2025-06-30",
    "thumbnailUrl": "/study/paper-review/simple-summaries-1/thm.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:t}=arguments[0];function _createMdxContent(i){const r={code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",ul:\"ul\",...i.components};return t(e,{children:[n(r.p,{children:\"     ...  .          .   ,           .           .\"}),\"\\n\",n(r.p,{children:\"             .      AI  .         ,     AI         !\"}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"Transformer-XL\"}),\"\\n\",n(r.p,{children:\"XL means extra-large. Transformer-XL can handle a long context window. The main idea is similar to an RNN. It separates a long context into segments and uses the hidden state of each segment to retain information from previous segments.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/simple-summaries-1/1.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"Therefore, it adopts a relative positional encoding.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/simple-summaries-1/2.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"I didn't understand why the 3 terms are added to calculate the attention score. Here's an explanation of each term.\"}),\"\\n\",t(r.ol,{children:[\"\\n\",n(r.li,{children:\"Content score: Q * K^T - A simple attention score\"}),\"\\n\",n(r.li,{children:\"Position score: Q * R^T - An inner product of query and relative positional embedding\"}),\"\\n\",n(r.li,{children:\"Content bias = U * K^T\"}),\"\\n\",n(r.li,{children:\"Positional bias = V * R^T\"}),\"\\n\"]}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"Bias terms adjust the important score. But... they're just bias terms to improve better performance.\"}),\"\\n\"]}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"Wav2Letter\"}),\"\\n\",n(r.p,{children:\"Wav2letter is designed as a simple end-to-end system for speech recognition, directly converting a speech signal into a text transcription. A key feature is that its acoustic model is trained directly using letters (graphemes). This breaks away from the classical pipeline.\"}),\"\\n\",n(r.h3,{children:\"Architecture\"}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"The system is built around a standard 1D convolutional neural network (ConvNet) for acoustic modeling.\"}),\"\\n\",n(r.li,{children:\"It uses striding convolutions instead of pooling layers to allow the network to perceive a larger context without increasing the number of parameters.\"}),\"\\n\",n(r.li,{children:\"The architecture for processing raw audio, as illustrated in the paper, involves a series of convolutional layers with specific kernel sizes and strides.\"}),\"\\n\",n(r.li,{children:\"The final layer of the convolutional network outputs a score for each letter in the predefined dictionary. The overall stride of the network is 320, generating a label every 20 milliseconds.\"}),\"\\n\"]}),\"\\n\",n(r.p,{children:\"I don't discuss its architecture in detail, but just highlight the significance of this research.\"}),\"\\n\",t(r.ol,{children:[\"\\n\",n(r.li,{children:\"End-to-End architecture\"}),\"\\n\"]}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"it directly converts a speech signal into a text transcription. This approach eliminates the need for intermediate phonetic transcriptions or forced alignment of phonemes. It generates a grapheme output directly.\"}),\"\\n\"]}),\"\\n\",t(r.ol,{start:\"2\",children:[\"\\n\",n(r.li,{children:\"Introduction of automatic segmentation criterion (ASG)\"}),\"\\n\"]}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"ASG is a simpler sequence criterion that trains models from sequence annotation without requiring alignment. It has few differences from CTC(Connected Temporal Classification). The most key point is a transition probability. It occurs between letters.\"}),\"\\n\"]}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"Wav2Vec\"}),\"\\n\",n(r.p,{children:\"It applies unsupervised pre-training to learn robust representations from unlabeled audio, which are much easier to collect thana labeled data.\"}),\"\\n\",n(r.h3,{children:\"Architecture\"}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"A multi-layer convolutional neural network (ConvNet) that takes raw audio as input.\"}),\"\\n\",t(r.li,{children:[\"It consists of two main stacked networks. Encoder Network \",n(r.code,{children:\"f\"}),\" and Context Network \",n(r.code,{children:\"g\"}),\". f embeds the raw audio signal into a low-frequency feature representation \",n(r.code,{children:\"z\"}),\". g takes multiple time-steps of the encoder's output \",n(r.code,{children:\"z_i...z_i-v\"}),\" and combines them into a single contextualized tensor \",n(r.code,{children:\"c_i\"})]}),\"\\n\"]}),\"\\n\",n(r.h3,{children:\"Objective\"}),\"\\n\",t(r.ul,{children:[\"\\n\",n(r.li,{children:\"To distinguish a sample z_i+k that is k stpes in the future from distractor samples z tilda drawn from a proposal distribution p_n, by minimizing the contrastive loss for each step k = 1, ..., K\"}),\"\\n\"]}),\"\\n\",n(r.p,{children:\"It is trained by discrimanating the correct sample among distractor samples.\"}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"VQ-Wav2Vec\"}),\"\\n\",n(r.p,{children:\"VQ means vector quantizing. It makes a discrete data to use NLP.\"}),\"\\n\",n(r.hr,{}),\"\\n\",n(r.h2,{children:\"wav2vec 2.0\"}),\"\\n\",n(r.p,{children:\"It is the successor to wav2vec and VQ-wav2vec. wav2vec 2.0 uses self-supervised contrastive learning and discrete representations.\"}),\"\\n\",n(r.p,{children:\"One thing I would like to discuss is the contrastive loss used in this paper.\"}),\"\\n\",n(r.p,{children:n(r.img,{src:\"/study/paper-review/simple-summaries-1/2.png\",alt:\"\"})}),\"\\n\",n(r.p,{children:\"A latent representation is fed to two layers: a context layer and a quantization layer.\"}),\"\\n\",n(r.p,{children:\"c_t is the masked output of the context layer and q_t is the quantized output of the quantizing layer. The loss calculates the similarity between c_t and q_t so that context representation is close to q_t and far from the negative samples, q_t tilda.\"}),\"\\n\",n(r.hr,{})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?n(t,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/simple-summaries-1"
  },
  {
    "title": "Let's learn seq2seq!",
    "description": "Learn how to use seq2seq models using PyTorch",
    "slug": "tutorial-seq2seq",
    "publishDate": "2025-04-12",
    "thumbnailUrl": "/study/paper-review/tutorial-seq2seq/thum.jpeg",
    "content": "const{Fragment:l,jsx:e,jsxs:n}=arguments[0];function _createMdxContent(s){const r={a:\"a\",code:\"code\",hr:\"hr\",img:\"img\",p:\"p\",pre:\"pre\",span:\"span\",...s.components};return n(l,{children:[e(r.p,{children:\"Recently, I've been studying large language models(LLMs). I understand the algorithms behind what they are and how they work, but I don't have a precise understanding of their implementation.\"}),\"\\n\",e(r.p,{children:\"I'm still pondering the necessity of understanding the basics of LLMs, such as implementation details, architecture, and so on. Since there is so much to learn in the field of LLMs, It's impossible to study everything in depth. However, as an undergraduate student without any immediate obligation to apply them for quick results, I plan to take my time and study step by step - starting with seq2seq, transformer, and other language models.\"}),\"\\n\",n(r.p,{children:[\"This post focuses on the seq2seq model. For learning purposes, I referred to \",e(r.a,{href:\"https://github.com/bentrevett/pytorch-seq2seq\",children:\"seq2seq tutorial link\"}),\".\"]}),\"\\n\",e(r.hr,{}),\"\\n\",e(r.p,{children:\"LSTM is more advanced type of RNN that can retain long-term information better than the original RNN. Unlike RNNs, which only have a hidden state, LSTMs include a cell state - a vector that stores information about the previous state of the LSTM cell.\"}),\"\\n\",e(r.p,{children:\"Leveraging LSTMs, many researchers have developed various techniques for translating one language to another.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/rnn1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"This is the original RNN architecture. The gray boxes represent cells, which take an input and produce an output, a hidden state, and a cell state.\\nThe mathematical expression is as follows:\"}),\"\\n\",e(r.p,{children:\"(h_t, c_t) = LSTM(e(x_t), h_t-1, c_t-1)\"}),\"\\n\",e(r.p,{children:\"However, the architecture above has a limitation: the dimensions of the inputs and outputs are fixed and identical. This poses a significant challenge for translation tasks, as most languages vary in length when expressing the same meaning.\"}),\"\\n\",n(r.p,{children:[e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/lstm1.png\",alt:\"\"}),\"\\n\",e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/lstm2.png\",alt:\"\"})]}),\"\\n\",e(r.p,{children:\"But this paper separates LSTM to two parts: encoder and decoder. Encoder LSTM takes the input sequence and produces a context vector, which has a information about the input sequence. Decoder LSTM takes the context vector and produces output one token at a time.\"}),\"\\n\",e(r.p,{children:e(r.img,{src:\"/study/paper-review/tutorial-seq2seq/seq2seq1.png\",alt:\"\"})}),\"\\n\",e(r.p,{children:\"the code implementing the paper is as follows (be cautious about the dimensions):\"}),\"\\n\",e(r.p,{children:\"Encoder\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" Encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" input_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"input_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"rnn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LSTM\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # src = [src length, batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        embedded \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # embedded = [src length, batch size, embedding dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"rnn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedded\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # outputs = [src length, batch size, hidden dim * n directions]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # outputs are always from the top hidden layer\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"})]})]})})}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"outputs, (hidden, cell) = self.rnn(embedded)\"}),\" represents an input and an output of LSTM structure.\"]}),\"\\n\",e(r.p,{children:\"Decoder\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" Decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" output_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"rnn \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"LSTM\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedding_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" n_layers\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" dropout\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"fc_out \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Linear\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output_dim\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"Dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # input = [batch size]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # n directions in the decoder will both always be 1, therefore:\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # context = [n layers, batch size, hidden dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        input\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"unsqueeze\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # input = [1, batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        embedded \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"dropout\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"embedding\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # embedded = [1, batch size, embedding dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"rnn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"embedded\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # output = [seq length, batch size, hidden dim * n directions]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # seq length and n directions will always be 1 in this decoder, therefore:\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # output = [1, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers, batch size, hidden dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        prediction \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"fc_out\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"squeeze\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"))\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # prediction = [batch size, output dim]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" prediction\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"})]})]})})}),\"\\n\",n(r.p,{children:[e(r.code,{children:\"output, (hidden, cell) = self.rnn(embedded, (hidden, cell))\"}),\" is similar to the one of encoder.\"]}),\"\\n\",e(r.p,{children:\"Model\"}),\"\\n\",e(l,{children:e(r.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(r.code,{children:[n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"class\"}),e(r.span,{style:{color:\"#8FBCBB\"},children:\" Seq2Seq\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"nn\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#8FBCBB\",fontWeight:\"bold\"},children:\"Module\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" __init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        super\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"().\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"__init__\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"encoder \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" encoder\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"decoder \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" device\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        assert\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"hidden_dim\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"        ),\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Hidden dimensions of encoder and decoder must be equal!\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        assert\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" (\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"==\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"n_layers\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#ECEFF4\"},children:\"        ),\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:' \"'}),e(r.span,{style:{color:\"#A3BE8C\"},children:\"Encoder and decoder must have equal number of layers!\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:'\"'})]}),\"\\n\",e(r.span,{className:\"line\"}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"    def\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" forward\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9\"},children:\" teacher_forcing_ratio\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # src = [src length, batch size]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # trg = [trg length, batch size]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # teacher_forcing_ratio is probability to use teacher forcing\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # e.g. if teacher_forcing_ratio is 0.75 we use ground-truth inputs 75% of the time\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        batch_size \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        trg_length \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"shape\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        trg_vocab_size \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"output_dim\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # tensor to store decoder outputs\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        outputs \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"zeros\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"trg_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" batch_size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg_vocab_size\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\").\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"to\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"device\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # last hidden state of the encoder is used as the initial hidden state of the decoder\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"        hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"encoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"src\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # hidden = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # cell = [n layers * n directions, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # first input to the decoder is the <sos> tokens\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"        input\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"0\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\" :]\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"        # input = [batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        for\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" t \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"in\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\" range\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg_length\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # insert input token embedding, previous hidden and previous cell states\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # receive output tensor (predictions) and new hidden and cell states\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" self\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"decoder\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"input\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" hidden\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\",\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" cell\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # output = [batch size, output dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # hidden = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # cell = [n layers, batch size, hidden dim]\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # place predictions in a tensor holding predictions for each token\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            outputs\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"t\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # decide if we are going to use teacher forcing or not\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            teacher_force \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" random\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"random\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"()\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" <\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" teacher_forcing_ratio\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # get the highest predicted token from our predictions\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"            top1 \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"=\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" output\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\".\"}),e(r.span,{style:{color:\"#88C0D0\"},children:\"argmax\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),e(r.span,{style:{color:\"#B48EAD\"},children:\"1\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # if teacher forcing, use actual next token as next input\"})}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # if not, use predicted token\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#88C0D0\"},children:\"            input\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" =\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" trg\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\"t\"}),e(r.span,{style:{color:\"#ECEFF4\"},children:\"]\"}),e(r.span,{style:{color:\"#81A1C1\"},children:\" if\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" teacher_force \"}),e(r.span,{style:{color:\"#81A1C1\"},children:\"else\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" top1\"})]}),\"\\n\",e(r.span,{className:\"line\",children:e(r.span,{style:{color:\"#616E88\"},children:\"            # input = [batch size]\"})}),\"\\n\",n(r.span,{className:\"line\",children:[e(r.span,{style:{color:\"#81A1C1\"},children:\"        return\"}),e(r.span,{style:{color:\"#D8DEE9FF\"},children:\" outputs\"})]})]})})}),\"\\n\",e(r.p,{children:\"I would recommend you to read minutely about the flow of the code, if you are begginer of Neural Network and Language model.\"}),\"\\n\",e(r.hr,{})]})}return{default:function(l={}){const{wrapper:n}=l.components||{};return n?e(n,{...l,children:e(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "permalink": "/study/paper-review/tutorial-seq2seq"
  },
  {
    "title": "VAE",
    "description": "DSBA     - Auto-Encoding Variational Bayes",
    "slug": "vae",
    "publishDate": "2025-07-18",
    "thumbnailUrl": "/study/paper-review/vae/vae_thm1.jpeg",
    "content": "const{Fragment:e,jsx:l,jsxs:n}=arguments[0];function _createMdxContent(r){const s={a:\"a\",br:\"br\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...r.components};return n(e,{children:[n(s.p,{children:[\"Reference:\\n\",l(s.a,{href:\"https://www.youtube.com/watch?v=qJeaCHQ1k2w\",children:\"Youtube\"}),l(s.br,{}),\"\\n\",l(s.a,{href:\"https://kyujinpy.tistory.com/88\",children:\"blog (in Korean)\"})]}),\"\\n\",n(s.p,{children:[\"Implementation from scratch:\\n\",l(s.a,{href:\"https://github.com/goranikin/DSBA-intern-study/tree/main/VAE\",children:\"GitHub\"})]}),\"\\n\",l(s.hr,{}),\"\\n\",l(s.h2,{children:\"1. Introduction\"}),\"\\n\",n(s.ol,{children:[\"\\n\",l(s.li,{children:\"The research area covered by the paper\"}),\"\\n\"]}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"image generation\"}),\"\\n\",l(s.li,{children:\"latent representation\"}),\"\\n\",l(s.li,{children:\"autoencoders\"}),\"\\n\"]}),\"\\n\",n(s.ol,{start:\"2\",children:[\"\\n\",l(s.li,{children:\"Limitations of previous studies in this task\"}),\"\\n\"]}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"Limitations of existing generative models such as RBM (Restricted Boltzmann Machine), DBN (Deep Belief Network), and GMM (Gaussian Mixture Model) By GPT-4.1:\"}),\"\\n\",l(s.li,{children:\"Training these models is difficult.\"}),\"\\n\",l(s.li,{children:\"Inference becomes intractable as model size increases.\"}),\"\\n\",l(s.li,{children:\"Sampling is slow and often produces low-quality results\"}),\"\\n\"]}),\"\\n\",n(s.ol,{start:\"3\",children:[\"\\n\",l(s.li,{children:\"Contributions\"}),\"\\n\"]}),\"\\n\",l(s.p,{children:\"The authors claim two main contributions:\"}),\"\\n\",n(s.ol,{children:[\"\\n\",l(s.li,{children:\"A reparameterization of the variational lower bound (which makes the ELBO)\"}),\"\\n\",l(s.li,{children:\"A posterior inference can be made especially efficient by fitting an approximate inference model\"}),\"\\n\"]}),\"\\n\",l(s.h2,{children:\"2. Related Work\"}),\"\\n\",l(s.p,{children:\"RBM, GMM, DBN... and there are algorithms or mathematical backgrounds for this paper.\"}),\"\\n\",l(s.h2,{children:\"3. Methodology\"}),\"\\n\",l(s.h3,{children:\"Main Idea\"}),\"\\n\",l(s.p,{children:\"Each data point is assumed to be independnet and sampled from the same distribution, and there exists a unique latent variable corresponding to each data point. The data is generated from this latent variable.\"}),\"\\n\",l(s.p,{children:\"( )  We assume that the data are generated by some random process, involving an unobserved continuous random variable z.\"}),\"\\n\",l(s.p,{children:\"Assumption:\"}),\"\\n\",l(s.p,{children:\"i.i.d. dataset consist of N samples:\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/1.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"Unobserved random variable: z\"}),\"\\n\",l(s.p,{children:\"prior distribution: p_theta(z)\"}),\"\\n\",l(s.p,{children:\"conditional distribution(likelihood) to generate x: p_theta^*(x|z)\"}),\"\\n\",l(s.p,{children:\" All they are come from parametric distribution of theta.\"}),\"\\n\",l(s.p,{children:\"Problem\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/2.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"Why?)\"}),\"\\n\",l(s.p,{children:\"We use a neural network to generate the latent representations (z) through training. However, because the model represents a highly complex non-linear function, there is no closed-form solution for the required integrationit is analytically intractable.\"}),\"\\n\",n(s.p,{children:[\"Three solutions proposed by the authors are following:\",l(s.br,{}),\"\\n\",l(s.img,{src:\"/study/paper-review/vae/3.png\",alt:\"\"})]}),\"\\n\",n(s.ol,{children:[\"\\n\",l(s.li,{children:\"We cant maximize p_theta(x) directly during training theta  Maximize the ELBO\"}),\"\\n\",l(s.li,{children:\"We cant estimate true posterior p_theta(z|x)  an Approximate neural network q_phi(z|x)\"}),\"\\n\",l(s.li,{children:\"We cant estimate true p_theta(x)  Approximating with ELBO and sampling\"}),\"\\n\"]}),\"\\n\",l(s.p,{children:\"recab\"}),\"\\n\",n(s.ol,{children:[\"\\n\",l(s.li,{children:\"We want to generate image data x using a model with parameters theta.\"}),\"\\n\",l(s.li,{children:\"We cannot directly calculate the marginal likelihood, which is the distribution from which the model generates data. (Since a neural network model is a non-linear function and does not have a closed-form solution for integration, it is impossible to obtain the loss required for backpropagation.)\"}),\"\\n\",l(s.li,{children:\"Therefore, we do not have any information about the distribution of the latent representation z.\"}),\"\\n\"]}),\"\\n\",l(s.p,{children:\"-> How to solve them?\"}),\"\\n\",n(s.ol,{children:[\"\\n\",l(s.li,{children:\"By maximizing the objective function ELBO, the parameters can be trained indirectly.\"}),\"\\n\",l(s.li,{children:\"The posterior is approximated using an encoder neural network to estimate (z) from (x).\"}),\"\\n\",l(s.li,{children:\"Ultimately, we can approximate the marginal likelihood using the ELBO.\"}),\"\\n\"]}),\"\\n\",l(s.p,{children:\"First, we use q_phi(z|x) to approximate the porsterior, and then we train the model so that its distribution p_theta(z|x) matches this approximation.\"}),\"\\n\",l(s.h3,{children:\"The variational bound\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/4.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"There are many blogs that try to explain this topic. However, what I want to ask is: why dont they start with the KL divergence? Our goal is to minimize the KL divergence between (q) and (p), but starting from the marginal likelihood doesnt sufficiently explain this equation.\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/5.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"Re-represent RHS term\"}),\"\\n\",n(s.p,{children:[l(s.img,{src:\"/study/paper-review/vae/6.png\",alt:\"\"}),\"\\n\",l(s.img,{src:\"/study/paper-review/vae/7.png\",alt:\"\"})]}),\"\\n\",l(s.p,{children:\"The loss what we desired! But if we look a bit more closely...\"}),\"\\n\",l(s.p,{children:\"KL-D term measures how similar the distribution of (z) produced by our encoder from (x) is to the prior. The smaller this term is, the better the latent space is regularized. In VAE, we typically set the prior to a normal distribution, so this term acts as a regularizer. This is why the normal distribution is increasingly reflected in the encoder's information compression, and it helps prevent meaningless sampling when generating new images through sampling later on. This demonstrates the power of setting a prior in Bayesian methods.\"}),\"\\n\",l(s.p,{children:\"The second expectation term evaluates how well the model can reconstruct (x) from the (z) produced by our encoder. Our goal is to maximize this term! (The KL-D term can be adjusted with an appropriate hyperparameter)\"}),\"\\n\",l(s.p,{children:\"At this point, since we set the prior as a Guassian, we also set q_phi(z|x) to be Gaussian.\"}),\"\\n\",l(s.p,{children:\"For each image (x), q_phi(z|x) outputs the values mu_phi and sigma_phi, which define a normal distribution. We then sample (z) from this distribution.\"}),\"\\n\",l(s.p,{children:\"Q) How to backpropagate through the sampling process? (Due to randomness, the gradient is meaningless)\"}),\"\\n\",l(s.p,{children:\"A) Reparameterization trick\"}),\"\\n\",l(s.p,{children:\"The solution is to sampling not directly from q_phi(z|x), but instead from g_phi(epsilon, x)  then we can change integration space from z space to epsilon space\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/9.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"So, for a given value of epsilon, we can deterministically compute the gradient of phi w.r.t. mu and sigma! \"}),\"\\n\",l(s.p,{children:\"Therefore, the original expectation is approximated to Monte Carlo estimating using l samples of  epsilon.\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/10.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"Visualization\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/11.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/12.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"This is pseudo code to train:\"}),\"\\n\",l(e,{children:l(s.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(s.code,{children:[n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"L \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#B48EAD\"},children:\" 5\"}),l(s.span,{style:{color:\"#616E88\"},children:\"  # The number of Monte Carlo samples\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"recon_losses \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\" []\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#81A1C1\"},children:\"for\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" _ \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"in\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\" range\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"L\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"    eps \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"randn_like\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"std\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"    z \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" mu \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"+\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" std \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"*\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" eps\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"    x_recon \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\" decoder\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"z\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"    loss \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" F\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"binary_cross_entropy\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"x_recon\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" x\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\",\"}),l(s.span,{style:{color:\"#D8DEE9\"},children:\" reduction\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"sum\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"'\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"    recon_losses\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"append\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"loss\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"recon_loss \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"stack\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"recon_losses\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\").\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"mean\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"kl_loss \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" -\"}),l(s.span,{style:{color:\"#B48EAD\"},children:\"0.5\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" *\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" torch\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"sum\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#B48EAD\"},children:\"1\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" +\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" logvar \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"-\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" mu\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"pow\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#B48EAD\"},children:\"2\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" -\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" logvar\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"exp\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"())\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"total_loss \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"=\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" recon_loss \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"+\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" kl_loss\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"total_loss\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"backward\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"optimizer\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\".\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"step\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"()\"})]})]})})}),\"\\n\",l(s.p,{children:\"There are a lot of ways to choose q_phi(z|x), g_phi(.), epsilon that the authors written on the paper.\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/13.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\"Honestly, I totally dont have any idea of them. Also, The only method used in application is Gaussian.  Im gonna pass!\"}),\"\\n\",l(s.h3,{children:\"Contribution\"}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"A combination latent variable generation model and Autoencoder architecture\"}),\"\\n\",l(s.li,{children:\"It uses neural network which can do variational inference\"}),\"\\n\",l(s.li,{children:\"It can be applied to variety of datasets and problems\"}),\"\\n\"]}),\"\\n\",l(s.h2,{children:\"4. Experiments and Results\"}),\"\\n\",l(s.h3,{children:\"Datasets\"}),\"\\n\",n(s.ul,{children:[\"\\n\",n(s.li,{children:[\"MNIST\",\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"handwritten digit images from 0 to 9\"}),\"\\n\",l(s.li,{children:\"60000 training, 10000 test\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(s.li,{children:[\"Frey Face\",\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"grayscale images of a single individuals face\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",l(s.h3,{children:\"Results\"}),\"\\n\",l(s.p,{children:l(s.img,{src:\"/study/paper-review/vae/14.png\",alt:\"\"})}),\"\\n\",l(s.p,{children:\" Wake-Sleep algorithm       \"}),\"\\n\",l(e,{children:l(s.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:n(s.code,{children:[n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"1.\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"Wake-Sleep\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" Algorithm?\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" 1995\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" Geoffrey\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" Hinton\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"unsupervised\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" learning\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"Deep\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" generative\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" Helmholtz\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" Machine\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"latent\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" variable\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" .\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#616E88\"},children:\"## 2. **  **\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#616E88\"},children:\"### ** **\"})}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"Recognition\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" ( \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"inference\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"):  \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  \"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\(\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" x\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\)\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\(\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" z\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\)\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" (VAE \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"encoder\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"Generative\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\":\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\(\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" z\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\)\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" (VAE \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"decoder\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\")\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#616E88\"},children:\"### ** **\"})}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"Wake\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" phase\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\":\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\(\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" x\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\)\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" recognition\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\(\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" z\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\)\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" generative\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" ( \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\")\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"Sleep\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" phase\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\":\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" generative\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\(\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" z\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\)\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\(\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" x\"}),l(s.span,{style:{color:\"#EBCB8B\"},children:\" \\\\)\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" recognition\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\" ( \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\")\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#616E88\"},children:\"## 3. ****\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" recognition\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" generative\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" model\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"ELBO\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#616E88\"},children:\"## 4. **VAE **\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"VAE\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" ELBO\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\",\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" /\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" --\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"wake-sleep\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"})]}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#88C0D0\"},children:\"---\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",l(s.span,{className:\"line\",children:l(s.span,{style:{color:\"#616E88\"},children:\"## 5. ****\"})}),\"\\n\",l(s.span,{className:\"line\"}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"-\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\" **\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"wake-sleep\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" algorithm\"}),l(s.span,{style:{color:\"#81A1C1\"},children:\"**\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\":\"}),l(s.span,{style:{color:\"#D8DEE9FF\"},children:\"  \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" wake\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" phase\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" sleep\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" phase\"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),l(s.span,{style:{color:\"#88C0D0\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#ECEFF4\"},children:\")\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\"\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]}),\"\\n\",n(s.span,{className:\"line\",children:[l(s.span,{style:{color:\"#88C0D0\"},children:\"  -\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" VAE\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" ,\"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"}),l(s.span,{style:{color:\"#A3BE8C\"},children:\" \"})]})]})})}),\"\\n\",l(s.h2,{children:\"5. Conclusions\"}),\"\\n\",n(s.ul,{children:[\"\\n\",n(s.li,{children:[\"\\n\",l(s.p,{children:\"Training latent representations with neural networks has been attempted for a long time.\"}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"However, VAE combines the latent variable model itself with neural networks.\"}),\"\\n\",l(s.li,{children:\"Moreover, it allows us to observe continuous changes through interpolation in the latent space--making it interpretable!\"}),\"\\n\",l(s.li,{children:\"Plus, after implementating the code, I found the structure to be very simple. There's nothing special: just an encoder that learns mu and sigma with a neural network, and a decoder that takes the latent representation and outputs an image.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(s.li,{children:[\"\\n\",l(s.p,{children:\"After reading about Diffusion models...\"}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"The notaiton is very different.\"}),\"\\n\",l(s.li,{children:\"There are countless blogs explaining ELBO, but they all use exactly the same notation. It feels like everyone is copying explanations from someone who tried to make it easier to understand. The problem is, these notations are not from the VAE paper, but from Diffusion model papers. \"}),\"\\n\",l(s.li,{children:\"I found the trick of making the probabilistic sampling distribution learnable by slightly sidestepping it very interesting. Also, making the prior a normal distribution so that the latent space generated by the parameters is mapped to the prior--this really felt like the ultimate in Bayesian thinking.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(s.li,{children:[\"\\n\",l(s.p,{children:\"Various ticks for estimating with Monte Carlo methods\"}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"But in practice, they're not really used... -> Even without multiple samples, the performance is good enough.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(s.li,{children:[\"\\n\",n(s.p,{children:[\"I implemented it from scratch my self. (\",l(s.a,{href:\"https://github.com/goranikin/DSBA-intern-study/tree/main/VAE\",children:\"https://github.com/goranikin/DSBA-intern-study/tree/main/VAE\"}),\")\"]}),\"\\n\",n(s.ul,{children:[\"\\n\",l(s.li,{children:\"2 layers vs 5 layers... the results seem a bit clearer?\"}),\"\\n\",l(s.li,{children:l(s.img,{src:\"/study/paper-review/vae/15.png\",alt:\"\"})}),\"\\n\",l(s.li,{children:\"Interpolation like this is also possible!\"}),\"\\n\",l(s.li,{children:l(s.img,{src:\"/study/paper-review/vae/16.png\",alt:\"\"})}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",l(s.hr,{}),\"\\n\",l(s.p,{children:\"      ... VAE   GAN     .        ,         ...       !\"})]})}return{default:function(e={}){const{wrapper:n}=e.components||{};return n?l(n,{...e,children:l(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/vae"
  },
  {
    "title": "ViT and MLP-Mixer",
    "description": "What is inductive bias? Then, what is the key difference between ViT and CNN?",
    "slug": "vit-mlpmixer",
    "publishDate": "2025-05-02",
    "thumbnailUrl": "/study/paper-review/vit-mlpmixer/2.png",
    "content": "const{Fragment:e,jsx:i,jsxs:t}=arguments[0];function _createMdxContent(n){const r={a:\"a\",blockquote:\"blockquote\",code:\"code\",hr:\"hr\",img:\"img\",p:\"p\",...n.components};return t(e,{children:[i(r.p,{children:\"NLP  , Vision       !\"}),\"\\n\",i(r.p,{children:\"NLP    ViT .      ViT CNN     .         Vision field   image processing    .\"}),\"\\n\",t(r.p,{children:[\" \",i(r.code,{children:\"CNN filter size  convolution  , ViT transformer     .  context window   .\"}),\"  . (      .)\"]}),\"\\n\",t(r.p,{children:[\" 2  \",i(r.code,{children:\" transformer input context size   CNN    ?   context size   ViT CNN  ?\"}),\"  .          . Convolution       ,    CNN   .    ViT         transformer   .\"]}),\"\\n\",i(r.p,{children:\"  Query, Key, Value attention operation . convolution operation filter    relationship       ,   context size deep neural network   Transformer   filter size   parameter   .   Q, K, V        . (    inductive bias  locality   .)  Cross-attention ...  Encoder, Decoder           .\"}),\"\\n\",t(r.p,{children:[\"       \",i(r.code,{children:\" .\"}),\" .    ,    \",i(r.code,{children:\"Multi-head attention\"}),\"   '' . Transformer  head       ,    AI    Head  latent representation       . Convolution   image natural language     ''  .     .\"]}),\"\\n\",i(r.p,{children:\"   ViT MLP-Mixer       .       Context size    inductive bias .  context size        .  MLP-Mixer   .  inductive bias multi-head attention      .\"}),\"\\n\",i(r.p,{children:\"  implicit       ?   ,         ,     .      !\"}),\"\\n\",i(r.hr,{}),\"\\n\",t(r.p,{children:[\"Before diving into this topic, I'd like to highlight an exceptional \",i(r.a,{href:\"https://www.youtube.com/watch?v=Y-isY31Thkw\",children:\"YouTube Video\"}),\" that brilliantly illustrates the concepts of image processing and what is 'inductive bias'.\"]}),\"\\n\",t(r.p,{children:[\"Initially, I'll examine the groundbreaking \",i(r.a,{href:\"https://arxiv.org/pdf/2010.11929.pdf\",children:\"Vit Paper\"}),\".\"]}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/1.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"In abstract,\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"When pre-trained on large amounts of data and transferred to multiple mid-sized or small image recognition benchmarks (ImageNet, CIFAR-100, VTAB, etc.), Vision Transformer (ViT) attains excellent results compared to state-of-the-art convolutional networks while requiring substantially fewer computational resources to train.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"A critical factor in this approach is the necessity for training on extensive datasets. Due to the nature of inductive bias, transformer architectures require substantial amounts of data to achieve optimal performance.\"}),\"\\n\",i(r.p,{children:\"Following the transformer's remarkable success in NLP, numerous attempts have been made to adapt this architecture to the image processing domain.\"}),\"\\n\",i(r.p,{children:\"However, these initial efforts yielded disappointing results that fell short of expectations. The researchers of ViT attributed this underperformance to a fundamental architectural difference:\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"Transformers lack some of the inductive biases inherent to CNNs, such as translation equivariance and locality, and therefore do not generalize well when trained on insufficient amounts of data.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"This analysis led to a pivotal breakthrough in their research:\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"We find that large scale training trumps inductive bias.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"So, what does this actually imply? what precisely is 'inductive bias', and why is a substantial volume of data necessary?\"}),\"\\n\",i(r.p,{children:\"Before exploring these questions, let's first understand the ViT architecture.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/2.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"ViT requires the input to be divided into fixed-size segments, known as PxP patches.\"}),\"\\n\",i(r.p,{children:\"The original image dimensions are represented as (H, W, C), corresponding to Height, Width, and Channel respectively. The N patches each have dimensions of (P, P, C), where N = H*W/P^2\"}),\"\\n\",i(r.p,{children:\"After splitting the image into the patches:\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"The Transformer uses constant latent vector size D through all of its layers, so we flatten the patches and map to Ddimensions with a trainable linear projection (Eq. 1). We refer to the output of this projection as the patch embeddings.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/3.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"In equation (1), xE represents the embedding vector that serves as input for the self-attention operation. Furthermore, the subsequent equations elucidate the operation performed by the architecture, as illustrated in Figure 1.\"}),\"\\n\",i(r.p,{children:\"For those already familiar with 'self-attention' mechanisms, the fundamental distinction between CNN and ViT becomes evident: context scope. While ViT computes relationships across all patches simultaneously during self-attention, CNNs only process interactions between adjacent patches during convolution. This distinction represents the essence of inductive bias.\"}),\"\\n\",i(r.p,{children:\"Inductive bias refers to the inherent predispositions or assumptions within a model that facilitate generalization, thereby enhancing performance. How does this mechanism function? In machine learning contexts, the objective is to identify a predictor that minimizes loss. Throughout this optimization process, inductive bias serves a vital function in mitigating overfitting. Calibrating an appropriate degree of inductive bias is crucial, as suboptimal values can either lead to overfitting or compromise overall performance.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/4.png\",alt:\"\"})}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"In CNNs, locality, two-dimensional neighborhood structure, and translation equivariance are baked into each layer throughout the whole model. In ViT, only MLP layers are local and translationally equivariant, while the self-attention layers are global.\"}),\"\\n\"]}),\"\\n\",i(r.p,{children:\"The authors explain that CNNs inherently possess locality and translation inductive biases, while ViT lacks these specific predispositions. At this point, this distinction prompts a crucial question: Is transformer completely devoid of inductive bias?\"}),\"\\n\",i(r.p,{children:\"Well, I explained inductive bias as 'predispositions or assumptions within a model'. It means that inductive bias enhance a model's predictive capabilities when confronted with novel scenarios-situations the model hasn't encountered during its training phase. Following this rationale, both CNNs and transformers inherently possess inductive biases, although the former has structural inductive bias, while the latter has global inductive bias.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/5.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"Structural inductive bias can be effectively learned from comparatively smaller datasets than those required for global inductive bias. This distinction is intuitively comprehensible: establishing meaningful correlations across all input elements and identifying appropriate patterns for model generalization presents a substantially more complex challenge.\"}),\"\\n\",i(r.p,{children:\"MLP-Mixer effectively exemplifies this intuition through its linear computational complexity processes: Token-mixing MLP and Channel-mixing MLP.\"}),\"\\n\",i(r.p,{children:i(r.img,{src:\"/study/paper-review/vit-mlpmixer/6.png\",alt:\"\"})}),\"\\n\",i(r.p,{children:\"This architecture represents not merely a novel approach that is considerably more streamlined than either ViT or CNNs, but also an evolutionary synthesis derived from both CNNs and transformers. The authors characterize MLP-Mixer as an expanded conceptualization of CNNs.\"}),\"\\n\",i(r.p,{children:\"Through this architectural attempt, the presence of inductive bias becomes evident, enabling us to understand its attributes.\"}),\"\\n\",t(r.blockquote,{children:[\"\\n\",i(r.p,{children:\"we would like to understand the inductive biases hidden in these various features and eventually their role in generalization\"}),\"\\n\"]}),\"\\n\",i(r.hr,{}),\"\\n\",i(r.p,{children:\"Reference\"}),\"\\n\",t(r.p,{children:[\"Paper Review MLP-Mixer: An all-MLP Architecture for Vision - \",i(r.a,{href:\"https://www.youtube.com/watch?v=Y-isY31Thkw\",children:\"https://www.youtube.com/watch?v=Y-isY31Thkw\"}),\"\\nViT Paper: \",i(r.a,{href:\"https://arxiv.org/pdf/2010.11929.pdf\",children:\"https://arxiv.org/pdf/2010.11929.pdf\"}),\"\\nMLP-Mixer Paper: \",i(r.a,{href:\"https://arxiv.org/abs/2105.01601\",children:\"https://arxiv.org/abs/2105.01601\"})]}),\"\\n\",i(r.hr,{})]})}return{default:function(e={}){const{wrapper:t}=e.components||{};return t?i(t,{...e,children:i(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/vit-mlpmixer"
  },
  {
    "title": "VQ-VAE",
    "description": "DSBA     - Neural Discrete Representation Learning",
    "slug": "vq-vae",
    "publishDate": "2025-07-19",
    "thumbnailUrl": "/study/paper-review/vq-vae/vq-vae_thm1.jpeg",
    "content": "const{Fragment:e,jsx:n,jsxs:i}=arguments[0];function _createMdxContent(r){const t={a:\"a\",annotation:\"annotation\",br:\"br\",code:\"code\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",math:\"math\",mi:\"mi\",mrow:\"mrow\",msub:\"msub\",ol:\"ol\",p:\"p\",pre:\"pre\",semantics:\"semantics\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components};return i(e,{children:[i(t.p,{children:[\" (Original VAE  ): \",n(t.a,{href:\"https://github.com/goranikin/DSBA-intern-study/tree/main/VAE\",children:\"GitHub\"})]}),\"\\n\",n(t.hr,{}),\"\\n\",n(t.h2,{children:\"1. Introduction\"}),\"\\n\",i(t.ol,{children:[\"\\n\",n(t.li,{children:\"The research area covered by the paper\"}),\"\\n\"]}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"Latent representation\"}),\"\\n\",n(t.li,{children:\"Vector Quantization\"}),\"\\n\"]}),\"\\n\",i(t.ol,{start:\"2\",children:[\"\\n\",n(t.li,{children:\"Limitations of previous studies in this task\"}),\"\\n\"]}),\"\\n\",i(t.ul,{children:[\"\\n\",i(t.li,{children:[\"Language and speech are inherently discrete in nature.\",\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"This raises the question: since images can often be described using language, is it beneficial to represent images with discrete latent variables?\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"Traditional VAEs suffer from posterior collapse problem.\",\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"This occurs when the encoder becomes too closely aligned with the prior distribution, causing the latent variables to carry little or no meaningful information about the input.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.ol,{start:\"3\",children:[\"\\n\",n(t.li,{children:\"Contributions\"}),\"\\n\"]}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"It shows a wide variety of applications such as speech and video generation.\"}),\"\\n\",n(t.li,{children:\"It doesnt suffer from the posterior collapse problem.\"}),\"\\n\"]}),\"\\n\",n(t.h2,{children:\"2. Related Work\"}),\"\\n\",n(t.p,{children:\"VAE\"}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"it shows an architecture of VAE (inferring a variational latent)\"}),\"\\n\"]}),\"\\n\",n(t.h2,{children:\"3. Methodology\"}),\"\\n\",n(t.h3,{children:\"Main Idea\"}),\"\\n\",n(t.h3,{children:\"1. Discrete Latent variables\"}),\"\\n\",n(t.p,{children:n(t.strong,{children:\"notations\"})}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"e: a embedding space\"}),\"\\n\",n(t.li,{children:\"K: the size of the discrete latent space (K-way categorical)\"}),\"\\n\",i(t.li,{children:[\"D: the dimensionality of each latent embedding vector \",i(t.span,{className:\"katex\",children:[n(t.span,{className:\"katex-mathml\",children:n(t.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:i(t.semantics,{children:[n(t.mrow,{children:i(t.msub,{children:[n(t.mi,{children:\"e\"}),n(t.mi,{children:\"i\"})]})}),n(t.annotation,{encoding:\"application/x-tex\",children:\"e_i\"})]})})}),n(t.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:i(t.span,{className:\"base\",children:[n(t.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),i(t.span,{className:\"mord\",children:[n(t.span,{className:\"mord mathnormal\",children:\"e\"}),n(t.span,{className:\"msupsub\",children:i(t.span,{className:\"vlist-t vlist-t2\",children:[i(t.span,{className:\"vlist-r\",children:[n(t.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:i(t.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[n(t.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),n(t.span,{className:\"sizing reset-size6 size3 mtight\",children:n(t.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),n(t.span,{className:\"vlist-s\",children:\"\"})]}),n(t.span,{className:\"vlist-r\",children:n(t.span,{className:\"vlist\",style:{height:\"0.15em\"},children:n(t.span,{})})})]})})]})]})})]}),\" and there are K embedding vectors.\"]}),\"\\n\",n(t.li,{children:\"z_e(x): the output of the encoder\"}),\"\\n\"]}),\"\\n\",n(t.p,{children:\"Q) How to move to discrete latent?\"}),\"\\n\",n(t.p,{children:\"A) a nearest neighbour look-up!\"}),\"\\n\",i(t.p,{children:[n(t.strong,{children:\"posterior categorical distribution\"}),\"\\n\",n(t.img,{src:\"/study/paper-review/vq-vae/1.png\",alt:\"\"})]}),\"\\n\",n(t.p,{children:\"pseudo code:\"}),\"\\n\",n(e,{children:n(t.pre,{className:\"shiki nord\",style:{backgroundColor:\"#2e3440ff\",color:\"#d8dee9ff\"},tabIndex:\"0\",children:i(t.code,{children:[i(t.span,{className:\"line\",children:[n(t.span,{style:{color:\"#81A1C1\"},children:\"def\"}),n(t.span,{style:{color:\"#88C0D0\"},children:\" quantize\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),n(t.span,{style:{color:\"#D8DEE9\"},children:\"z_e\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(t.span,{style:{color:\"#D8DEE9\"},children:\" codebook\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\"):\"})]}),\"\\n\",i(t.span,{className:\"line\",children:[n(t.span,{style:{color:\"#D8DEE9FF\"},children:\"    distances \"}),n(t.span,{style:{color:\"#81A1C1\"},children:\"=\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\" ((\"}),n(t.span,{style:{color:\"#D8DEE9FF\"},children:\"z_e\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\".\"}),n(t.span,{style:{color:\"#81A1C1\"},children:\" -\"}),n(t.span,{style:{color:\"#D8DEE9FF\"},children:\" codebook\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\")\"}),n(t.span,{style:{color:\"#81A1C1\"},children:\" **\"}),n(t.span,{style:{color:\"#B48EAD\"},children:\" 2\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\").\"}),n(t.span,{style:{color:\"#88C0D0\"},children:\"sum\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),n(t.span,{style:{color:\"#81A1C1\"},children:\"-\"}),n(t.span,{style:{color:\"#B48EAD\"},children:\"1\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",i(t.span,{className:\"line\",children:[n(t.span,{style:{color:\"#D8DEE9FF\"},children:\"    indices \"}),n(t.span,{style:{color:\"#81A1C1\"},children:\"=\"}),n(t.span,{style:{color:\"#D8DEE9FF\"},children:\" distances\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\".\"}),n(t.span,{style:{color:\"#88C0D0\"},children:\"argmin\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\"(\"}),n(t.span,{style:{color:\"#B48EAD\"},children:\"1\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\")\"})]}),\"\\n\",i(t.span,{className:\"line\",children:[n(t.span,{style:{color:\"#D8DEE9FF\"},children:\"    z_q \"}),n(t.span,{style:{color:\"#81A1C1\"},children:\"=\"}),n(t.span,{style:{color:\"#D8DEE9FF\"},children:\" codebook\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\"[\"}),n(t.span,{style:{color:\"#D8DEE9FF\"},children:\"indices\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\"]\"})]}),\"\\n\",i(t.span,{className:\"line\",children:[n(t.span,{style:{color:\"#81A1C1\"},children:\"    return\"}),n(t.span,{style:{color:\"#D8DEE9FF\"},children:\" z_q\"}),n(t.span,{style:{color:\"#ECEFF4\"},children:\",\"}),n(t.span,{style:{color:\"#D8DEE9FF\"},children:\" indices\"})]})]})})}),\"\\n\",n(t.p,{children:\"how to update parameter with this discrete codebook?\"}),\"\\n\",n(t.p,{children:n(t.img,{src:\"/study/paper-review/vq-vae/2.png\",alt:\"\"})}),\"\\n\",n(t.p,{children:\"The right image means that a loss relocate the representation to other embedding vectors, then the result changes in the next process.\"}),\"\\n\",i(t.p,{children:[n(t.strong,{children:\"Loss\"}),\"\\n\",n(t.img,{src:\"/study/paper-review/vq-vae/3.png\",alt:\"\"})]}),\"\\n\",n(t.p,{children:\"sg: stop-gradient\"}),\"\\n\",n(t.p,{children:\"A first term is reconstruction loss\"}),\"\\n\",n(t.p,{children:\"2nd: codebook loss\"}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"it updates codebook vector only, moving to the encoders output.\"}),\"\\n\"]}),\"\\n\",n(t.p,{children:\"3th: Commitment loss\"}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"it updates the output of the encoder only, moving to the codebook vector.\"}),\"\\n\"]}),\"\\n\",n(t.p,{children:\"Q) Ive understood why does loss contains only the output of the encoder and embedding vectors (due to an non-differentiable of quantization operation). But why they are divided into two terms as codebook loss and commitment loss?\"}),\"\\n\",n(t.p,{children:\"A) (The paper states that)  To make sure the encoder commits to an embedding and its output does not grow, we add a commitment loss, the third term in equation\"}),\"\\n\",n(t.p,{children:\"Q) Waiiiiiiiiit the reconstruction loss contains quantization loss which is not differentiable.\"}),\"\\n\",i(t.p,{children:[\"A)\\n\",n(t.img,{src:\"/study/paper-review/vq-vae/4.png\",alt:\"\"})]}),\"\\n\",n(t.p,{children:\"it just passes the gradient: STE(Straight-Through Estimator)\"}),\"\\n\",n(t.p,{children:\"So it updates the decoder and the encoder parameters, but not codebook.  codebook parameter only updates by codebook loss term.\"}),\"\\n\",i(t.ol,{start:\"2\",children:[\"\\n\",n(t.li,{children:\"with PixelCNN\"}),\"\\n\"]}),\"\\n\",n(t.p,{children:\"Original VAE practices a Gaussian distribution to sample z. When the VQ-VAE paper had written, many of researches and applications have found a better performance to exploit VAE architecture. One of them is to use PixelCNN, which models the distribution of z autoregressively. Some experiments in the paper adopt the PixelCNN to generate image with VQ-VAE.\"}),\"\\n\",n(t.h3,{children:\"Contribution\"}),\"\\n\",n(t.p,{children:\"VQ-VAE presents a Vector-Quantization method at VAE with a codebook(embedding vector space).\"}),\"\\n\",n(t.h2,{children:\"4. Experiments and Results\"}),\"\\n\",n(t.h3,{children:\"Datasets\"}),\"\\n\",i(t.ul,{children:[\"\\n\",i(t.li,{children:[\"ImageNet\",\"\\n\",i(t.ul,{children:[\"\\n\",i(t.li,{children:[\"Reconstruction\\n\",n(t.img,{src:\"/study/paper-review/vq-vae/5.png\",alt:\"\"})]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",i(t.li,{children:[\"VCTK(The Voice Cloning Toolkit)\",\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"110 peoples audio samples.\"}),\"\\n\",n(t.li,{children:\"Most of them are from news or wikipedia.\"}),\"\\n\",n(t.li,{children:\"A variety of English pronounce.\"}),\"\\n\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(t.h3,{children:\"Results\"}),\"\\n\",i(t.ul,{children:[\"\\n\",n(t.li,{children:\"        (  )\"}),\"\\n\",n(t.li,{children:\"VQ    VAE  posterior collapse  \"}),\"\\n\"]}),\"\\n\",n(t.h2,{children:\"5. Conclusions\"}),\"\\n\",i(t.p,{children:[\"I modified the original VAE code by simply adding the VQ process.\",n(t.br,{}),\"\\n\",n(t.img,{src:\"/study/paper-review/vq-vae/6.png\",alt:\"\"})]}),\"\\n\",n(t.p,{children:\"When I set the number of embeddings to 512, as used for ImageNet generation in the paper, the results weren't very good. In fact, even for the image reconstruction task, the generated images were much blurrier than those from the traditional VAE.\"}),\"\\n\",n(t.p,{children:\"However, samples generated from the same embedding vector showed identical appearances.\"}),\"\\n\",n(t.p,{children:n(t.img,{src:\"/study/paper-review/vq-vae/7.png\",alt:\"\"})}),\"\\n\",n(t.p,{children:\"This is the result when the number of embeddings is limited to 10. It looks a bit cleaner than before.\"}),\"\\n\",n(t.p,{children:\"I'm sure the results would improve if I found the right hyperparameters, but I'll just stop here!\"})]})}return{default:function(e={}){const{wrapper:i}=e.components||{};return i?n(i,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "permalink": "/study/paper-review/vq-vae"
  }
]